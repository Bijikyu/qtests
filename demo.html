<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QTests Framework - Interactive Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #22d3ee;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --dark: #1f2937;
            --light: #f3f4f6;
            --border: #e5e7eb;
            --shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
            --shadow-lg: 0 10px 20px rgba(0,0,0,0.19), 0 6px 6px rgba(0,0,0,0.23);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .logo {
            width: 50px;
            height: 50px;
            background: var(--primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
        }

        .subtitle {
            color: #6b7280;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 24px;
            background: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
        }

        .nav-tab:hover {
            background: var(--light);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow-lg);
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--light);
            border-radius: 8px;
            padding: 20px;
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .card h3 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            width: 24px;
            height: 24px;
            background: var(--primary);
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn.secondary {
            background: var(--secondary);
        }

        .btn.success {
            background: var(--success);
        }

        .btn.warning {
            background: var(--warning);
        }

        .btn.error {
            background: var(--error);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--dark);
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
        }

        .input-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .code-block {
            background: var(--dark);
            color: #f3f4f6;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 15px 0;
        }

        .status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
            margin: 5px;
        }

        .status.success {
            background: #d1fae5;
            color: #065f46;
        }

        .status.error {
            background: #fee2e2;
            color: #991b1b;
        }

        .status.warning {
            background: #fed7aa;
            color: #92400e;
        }

        .status.info {
            background: #dbeafe;
            color: #1e40af;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .checkbox {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .terminal {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            margin: 15px 0;
        }

        .terminal-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .terminal-prompt {
            color: #4fc3f7;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .metric {
            text-align: center;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
        }

        .metric-label {
            font-size: 0.9rem;
            color: #6b7280;
            margin-top: 5px;
        }

        .alert {
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border-left: 4px solid;
        }

        .alert.info {
            background: #dbeafe;
            border-color: var(--primary);
            color: #1e40af;
        }

        .alert.success {
            background: #d1fae5;
            border-color: var(--success);
            color: #065f46;
        }

        .alert.warning {
            background: #fed7aa;
            border-color: var(--warning);
            color: #92400e;
        }

        .alert.error {
            background: #fee2e2;
            border-color: var(--error);
            color: #991b1b;
        }

        .workflow-steps {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 30px 0;
            position: relative;
        }

        .workflow-step {
            flex: 1;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .workflow-step-number {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
        }

        .workflow-step.completed .workflow-step-number {
            background: var(--success);
        }

        .workflow-step.active .workflow-step-number {
            background: var(--warning);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .workflow-line {
            position: absolute;
            top: 20px;
            left: 10%;
            right: 10%;
            height: 2px;
            background: var(--border);
            z-index: 1;
        }

        .workflow-progress {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--success);
            transition: width 0.3s ease;
        }

        .demo-section {
            margin: 30px 0;
            padding: 20px;
            background: var(--light);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .demo-section h4 {
            color: var(--primary);
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            h1 {
                font-size: 2rem;
            }

            .nav-tabs {
                justify-content: center;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .workflow-steps {
                flex-direction: column;
                gap: 20px;
            }

            .workflow-line {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>
                <div class="logo">Q</div>
                QTests Framework - Interactive Demo
            </h1>
            <p class="subtitle">Comprehensive testing utilities for Node.js applications</p>
            <div>
                <span class="status success">v2.0.0</span>
                <span class="status info">MIT License</span>
                <span class="status warning">Node.js 16+</span>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview', this)">üìä Overview</button>
            <button class="nav-tab" onclick="showTab('test-generation', this)">üöÄ Test Generation</button>
            <button class="nav-tab" onclick="showTab('test-runner', this)">‚ö° Test Runner</button>
            <button class="nav-tab" onclick="showTab('mocking', this)">üé≠ Mocking & Stubbing</button>
            <button class="nav-tab" onclick="showTab('utilities', this)">üõ†Ô∏è Utilities</button>
            <button class="nav-tab" onclick="showTab('advanced-features', this)">üî¨ Advanced</button>
            <button class="nav-tab" onclick="showTab('email-http-testing', this)">üìß Email & HTTP</button>
            <button class="nav-tab" onclick="showTab('route-testing', this)">üõ£Ô∏è Route Testing</button>
            <button class="nav-tab" onclick="showTab('performance', this)">üìä Performance</button>
            <button class="nav-tab" onclick="showTab('configuration', this)">‚öôÔ∏è Configuration</button>
            <button class="nav-tab" onclick="showTab('playground', this)">üéÆ Playground</button>
            <button class="nav-tab" onclick="showTab('integration-flows', this)">üîÑ Integration Flows</button>
            <button class="nav-tab" onclick="showTab('real-world-scenarios', this)">üåç Real-World</button>
        </nav>

        <!-- Overview Tab -->
        <div id="overview" class="tab-content active">
            <h2>Framework Overview</h2>
            <div class="alert info">
                <strong>QTests</strong> eliminates common testing blockers by providing intelligent stubbing, test generation, and execution utilities for Node.js applications.
            </div>

            <div class="grid">
                <div class="card">
                    <h3><span class="icon">üöÄ</span> Test Generation</h3>
                    <p>AST-based intelligent test generation for TypeScript/JavaScript projects with React and Express support.</p>
                    <ul class="feature-list">
                        <li>‚úÖ Automatic source code analysis</li>
                        <li>‚úÖ React component test generation</li>
                        <li>‚úÖ Express route detection</li>
                        <li>‚úÖ Smart filtering and exclusions</li>
                    </ul>
                    <button class="btn" onclick="showTab('test-generation')">Explore Test Generation</button>
                </div>

                <div class="card">
                    <h3><span class="icon">‚ö°</span> High-Performance Runner</h3>
                    <p>Optimized test execution with Jest API integration and 69% speed improvement through batching.</p>
                    <ul class="feature-list">
                        <li>‚úÖ Parallel test processing</li>
                        <li>‚úÖ Debug report generation</li>
                        <li>‚úÖ Memory optimization</li>
                        <li>‚úÖ CI/CD integration</li>
                    </ul>
                    <button class="btn" onclick="showTab('test-runner')">Explore Test Runner</button>
                </div>

                <div class="card">
                    <h3><span class="icon">üé≠</span> Intelligent Mocking</h3>
                    <p>Runtime module replacement with built-in stubs for axios, winston, mongoose and custom modules.</p>
                    <ul class="feature-list">
                        <li>‚úÖ Automatic module resolution</li>
                        <li>‚úÖ Built-in service stubs</li>
                        <li>‚úÖ Offline mode support</li>
                        <li>‚úÖ Console output capture</li>
                    </ul>
                    <button class="btn" onclick="showTab('mocking')">Explore Mocking</button>
                </div>

                <div class="card">
                    <h3><span class="icon">üõ†Ô∏è</span> Testing Utilities</h3>
                    <p>Comprehensive utilities for environment management, error handling, validation, and test isolation.</p>
                    <ul class="feature-list">
                        <li>‚úÖ Environment variable management</li>
                        <li>‚úÖ Async error wrapping</li>
                        <li>‚úÖ Memory leak detection</li>
                        <li>‚úÖ Test isolation</li>
                    </ul>
                    <button class="btn" onclick="showTab('utilities')">Explore Utilities</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>üöÄ Quick Start Workflow</h4>
                <div class="workflow-steps">
                    <div class="workflow-line">
                        <div class="workflow-progress" id="workflow-progress" style="width: 0%"></div>
                    </div>
                    <div class="workflow-step active" id="step-1">
                        <div class="workflow-step-number">1</div>
                        <div>Install Package</div>
                    </div>
                    <div class="workflow-step" id="step-2">
                        <div class="workflow-step-number">2</div>
                        <div>Generate Tests</div>
                    </div>
                    <div class="workflow-step" id="step-3">
                        <div class="workflow-step-number">3</div>
                        <div>Run Tests</div>
                    </div>
                    <div class="workflow-step" id="step-4">
                        <div class="workflow-step-number">4</div>
                        <div>Debug & Refine</div>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn success" onclick="runWorkflow()">Start Interactive Workflow</button>
                </div>
            </div>

            <div class="metrics">
                <div class="metric">
                    <div class="metric-value">69%</div>
                    <div class="metric-label">Speed Improvement</div>
                </div>
                <div class="metric">
                    <div class="metric-value">15+</div>
                    <div class="metric-label">Built-in Stubs</div>
                </div>
                <div class="metric">
                    <div class="metric-value">100%</div>
                    <div class="metric-label">TypeScript Support</div>
                </div>
                <div class="metric">
                    <div class="metric-value">0</div>
                    <div class="metric-label">External Dependencies</div>
                </div>
            </div>
        </div>

        <!-- Test Generation Tab -->
        <div id="test-generation" class="tab-content">
            <h2>üöÄ Intelligent Test Generation</h2>
            <div class="alert info">
                QTests provides AST-based test generation for TypeScript and JavaScript projects, with smart detection of React components and Express routes.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>Generation Configuration</h3>
                    <div class="input-group">
                        <label for="source-dir">Source Directory</label>
                        <input type="text" id="source-dir" value="src" placeholder="Enter source directory path">
                    </div>
                    <div class="input-group">
                        <label for="test-dir">Test Output Directory</label>
                        <input type="text" id="test-dir" value="tests" placeholder="Enter test output directory">
                    </div>
                    <div class="input-group">
                        <label for="generation-mode">Generation Mode</label>
                        <select id="generation-mode">
                            <option value="ast">AST Analysis (Recommended)</option>
                            <option value="heuristic">Heuristic Detection</option>
                            <option value="mixed">Mixed Mode</option>
                        </select>
                    </div>
                    <button class="btn" onclick="generateTests()">Generate Tests</button>
                    <button class="btn secondary" onclick="previewGeneration()">Preview Generation</button>
                </div>

                <div class="card">
                    <h3>Generation Options</h3>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="react-tests" checked>
                            Generate React Component Tests
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="express-tests" checked>
                            Generate Express Route Tests
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="integration-tests">
                            Generate Integration Tests
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="unit-tests" checked>
                            Generate Unit Tests
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="mock-imports" checked>
                            Auto-generate Mock Imports
                        </label>
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>Generation Preview</h4>
                <div id="generation-preview" class="terminal">
                    <div style="color: #4fc3f7;">$ qtests-generate --mode ast --src-dir src --test-dir tests</div>
                    <div>üîç Analyzing source files in src/...</div>
                    <div>üìù Found 12 TypeScript files</div>
                    <div>‚öõÔ∏è  Detected 3 React components</div>
                    <div>üåê  Detected 5 Express routes</div>
                    <div>üß™  Generating 8 test files...</div>
                    <div style="color: #10b981;">‚úÖ Test generation completed successfully!</div>
                </div>
            </div>

            <div class="demo-section">
                <h4>Sample Generated Test</h4>
                <div class="code-block">
// Generated test for UserService
import { describe, it, expect, beforeEach } from '@jest/globals';
import { UserService } from '../src/services/UserService';
import { stubMethod } from 'qtests/setup';

describe('UserService', () => {
  let userService: UserService;

  beforeEach(() => {
    userService = new UserService();
    // Auto-generated stubs
    stubMethod(userService, 'fetchUser', jest.fn());
  });

  it('should create user successfully', async () => {
    const userData = { name: 'John Doe', email: 'john@example.com' };
    const result = await userService.createUser(userData);
    
    expect(result).toBeDefined();
    expect(result.name).toBe(userData.name);
  });

  it('should handle validation errors', async () => {
    const invalidData = { name: '', email: 'invalid' };
    
    await expect(userService.createUser(invalidData))
      .rejects.toThrow('Validation failed');
  });
});
                </div>
            </div>
        </div>

        <!-- Test Runner Tab -->
        <div id="test-runner" class="tab-content">
            <h2>‚ö° High-Performance Test Runner</h2>
            <div class="alert success">
                Optimized test execution with Jest API integration, providing 69% speed improvement through intelligent batching and parallel processing.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>Runner Configuration</h3>
                    <div class="input-group">
                        <label for="test-pattern">Test Pattern</label>
                        <input type="text" id="test-pattern" value="**/*.test.ts" placeholder="Test file pattern">
                    </div>
                    <div class="input-group">
                        <label for="concurrency">Concurrency Level</label>
                        <select id="concurrency">
                            <option value="1">Single Thread</option>
                            <option value="4" selected>4 Parallel</option>
                            <option value="8">8 Parallel</option>
                            <option value="max">Maximum</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="batch-mode" checked>
                            Enable Batch Processing
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="debug-mode">
                            Enable Debug Mode
                        </label>
                    </div>
                    <button class="btn success" onclick="runTests()">Run Tests</button>
                    <button class="btn warning" onclick="runTestsWithCoverage()">Run with Coverage</button>
                </div>

                <div class="card">
                    <h3>Execution Status</h3>
                    <div class="metrics">
                        <div class="metric">
                            <div class="metric-value" id="tests-passed">0</div>
                            <div class="metric-label">Passed</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="tests-failed">0</div>
                            <div class="metric-label">Failed</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="tests-skipped">0</div>
                            <div class="metric-label">Skipped</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="test-duration">0ms</div>
                            <div class="metric-label">Duration</div>
                        </div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="test-progress" style="width: 0%"></div>
                    </div>
                    <div id="test-status" class="status info">Ready to run tests</div>
                </div>
            </div>

            <div class="demo-section">
                <h4>Live Test Output</h4>
                <div id="test-output" class="terminal">
                    <div style="color: #4fc3f7;">$ qtests-runner --config config/jest.config.mjs --pattern **/*.test.ts</div>
                    <div>üîç Discovering test files...</div>
                    <div>üì¶ Found 15 test files</div>
                    <div>‚ö° Starting batch execution (4 concurrent)...</div>
                    <div style="color: #f59e0b;">‚è≥ Running tests...</div>
                </div>
            </div>

            <div class="demo-section">
                <h4>Performance Metrics</h4>
                <canvas id="performance-chart" width="400" height="200"></canvas>
                <button class="btn secondary" onclick="drawPerformanceChart()" style="margin-top: 10px;">Update Chart</button>
            </div>
        </div>

        <!-- Mocking & Stubbing Tab -->
        <div id="mocking" class="tab-content">
            <h2>üé≠ Mocking & Stubbing System</h2>
            <div class="alert warning">
                Runtime module replacement with automatic stub resolution. Built-in stubs for common external services and custom module support.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>Built-in Module Stubs</h3>
                    <ul class="feature-list">
                        <li>
                            <input type="checkbox" class="checkbox" id="stub-axios" checked>
                            <strong>axios</strong> - HTTP client stubbing
                        </li>
                        <li>
                            <input type="checkbox" class="checkbox" id="stub-winston" checked>
                            <strong>winston</strong> - Logging framework stub
                        </li>
                        <li>
                            <input type="checkbox" class="checkbox" id="stub-mongoose">
                            <strong>mongoose</strong> - MongoDB ODM stub
                        </li>
                        <li>
                            <input type="checkbox" class="checkbox" id="stub-console" checked>
                            <strong>console</strong> - Console output capture
                        </li>
                    </ul>
                    <button class="btn" onclick="applyStubs()">Apply Stubs</button>
                    <button class="btn secondary" onclick="resetStubs()">Reset Stubs</button>
                </div>

                <div class="card">
                    <h3>Method Stubbing</h3>
                    <div class="input-group">
                        <label for="stub-target">Target Object</label>
                        <input type="text" id="stub-target" placeholder="e.g., userService, httpClient">
                    </div>
                    <div class="input-group">
                        <label for="stub-method">Method Name</label>
                        <input type="text" id="stub-method" placeholder="e.g., fetchUser, post">
                    </div>
                    <div class="input-group">
                        <label for="stub-implementation">Implementation</label>
                        <textarea id="stub-implementation" placeholder="jest.fn().mockReturnValue({ id: 1, name: 'Test' })"></textarea>
                    </div>
                    <button class="btn" onclick="createMethodStub()">Create Method Stub</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>Stubbing Examples</h4>
                <div class="code-block">
// Method stubbing
import { stubMethod, spyOnMethod } from 'qtests/setup';

// Simple method stub
stubMethod(userService, 'fetchUser', jest.fn().mockReturnValue({
  id: 1,
  name: 'John Doe',
  email: 'john@example.com'
}));

// Method spying
const spy = spyOnMethod(console, 'log');
console.log('Test message');
expect(spy).toHaveBeenCalledWith('Test message');

// Custom module stub
registerModuleStub('./externalService', {
  fetchData: jest.fn().mockResolvedValue({ data: 'mock' }),
  processData: jest.fn()
});
                </div>
            </div>

            <div class="demo-section">
                <h4>Offline Mode</h4>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="offline-mode">
                        Enable Offline Mode (stubs all external services)
                    </label>
                </div>
                <button class="btn warning" onclick="toggleOfflineMode()">Toggle Offline Mode</button>
                <div class="status info" id="offline-status">Online mode - External services active</div>
            </div>
        </div>

        <!-- Utilities Tab -->
        <div id="utilities" class="tab-content">
            <h2>üõ†Ô∏è Testing Utilities</h2>
            <div class="alert info">
                Comprehensive utilities for environment management, error handling, validation, memory monitoring, and test isolation.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>üåç Environment Management</h3>
                    <div class="input-group">
                        <label for="env-var-name">Environment Variable</label>
                        <input type="text" id="env-var-name" placeholder="NODE_ENV">
                    </div>
                    <div class="input-group">
                        <label for="env-var-value">Value</label>
                        <input type="text" id="env-var-value" placeholder="test">
                    </div>
                    <button class="btn" onclick="setTestEnv()">Set Test Environment</button>
                    <button class="btn secondary" onclick="saveAndRestoreEnv()">Save & Restore</button>
                </div>

                <div class="card">
                    <h3>üîß Error Handling</h3>
                    <div class="input-group">
                        <label for="error-wrapper-type">Wrapper Type</label>
                        <select id="error-wrapper-type">
                            <option value="async">Async Error Wrapper</option>
                            <option value="sync">Sync Error Wrapper</option>
                            <option value="route">Route Error Wrapper</option>
                            <option value="database">Database Error Wrapper</option>
                        </select>
                    </div>
                    <button class="btn" onclick="createErrorWrapper()">Generate Error Wrapper</button>
                </div>

                <div class="card">
                    <h3>üß† Memory Monitoring</h3>
                    <div class="metrics">
                        <div class="metric">
                            <div class="metric-value" id="memory-usage">0MB</div>
                            <div class="metric-label">Memory Usage</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="heap-size">0MB</div>
                            <div class="metric-label">Heap Size</div>
                        </div>
                    </div>
                    <button class="btn" onclick="startMemoryMonitoring()">Start Monitoring</button>
                    <button class="btn warning" onclick="detectMemoryLeaks()">Detect Leaks</button>
                </div>

                <div class="card">
                    <h3>‚úÖ Validation Utilities</h3>
                    <div class="input-group">
                        <label for="validation-type">Validation Type</label>
                        <select id="validation-type">
                            <option value="string">String Validation</option>
                            <option value="email">Email Validation</option>
                            <option value="html">HTML Sanitization</option>
                            <option value="xss">XSS Protection</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="validation-input">Test Input</label>
                        <input type="text" id="validation-input" placeholder="Enter text to validate">
                    </div>
                    <button class="btn" onclick="runValidation()">Run Validation</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>Test Isolation</h4>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="isolate-env" checked>
                        Isolate Environment Variables
                    </label>
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="isolate-servers">
                        Isolate Server Connections
                    </label>
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="isolate-db">
                        Isolate Database Connections
                    </label>
                </div>
                <button class="btn success" onclick="setupTestIsolation()">Setup Test Isolation</button>
                <button class="btn error" onclick="cleanupTestIsolation()">Cleanup Isolation</button>
            </div>
        </div>

        <!-- Configuration Tab -->
        <div id="configuration" class="tab-content">
            <h2>‚öôÔ∏è Configuration Management</h2>
            <div class="alert success">
                Comprehensive configuration system with Jest integration, TypeScript support, and customizable test environments.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>Jest Configuration</h3>
                    <div class="input-group">
                        <label for="jest-config-file">Config File Path</label>
                        <input type="text" id="jest-config-file" value="config/jest.config.mjs">
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="jest-esm" checked>
                            Enable ESM Support
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="jest-typescript" checked>
                            Enable TypeScript Support
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="jest-coverage">
                            Enable Coverage Collection
                        </label>
                    </div>
                    <button class="btn" onclick="generateJestConfig()">Generate Jest Config</button>
                    <button class="btn secondary" onclick="validateJestConfig()">Validate Config</button>
                </div>

                <div class="card">
                    <h3>Module Mapping</h3>
                    <div class="input-group">
                        <label for="module-pattern">Module Pattern</label>
                        <input type="text" id="module-pattern" placeholder="^(axios|winston)$">
                    </div>
                    <div class="input-group">
                        <label for="module-stub">Stub Path</label>
                        <input type="text" id="module-stub" placeholder="qtests/stubs/axios">
                    </div>
                    <button class="btn" onclick="addModuleMapping()">Add Module Mapping</button>
                    <div id="module-mappings" style="margin-top: 15px;">
                        <!-- Module mappings will be displayed here -->
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>Generated Jest Configuration</h4>
                <div class="code-block">
// config/jest.config.mjs
export default {
  // Test environment
  testEnvironment: 'node',
  
  // TypeScript support
  preset: 'ts-jest/presets/default-esm',
  extensionsToTreatAsEsm: ['.ts'],
  
  // Module resolution
  moduleNameMapper: {
    '^(axios)$': 'qtests/stubs/axios',
    '^(winston)$': 'qtests/stubs/winston',
    '^(mongoose)$': 'qtests/stubs/mongoose'
  },
  
  // Test setup
  setupFilesAfterEnv: ['<rootDir>/config/jest-setup.ts'],
  setupFiles: ['<rootDir>/config/jest-require-polyfill.cjs'],
  
  // Performance
  cache: true,
  maxWorkers: 4,
  
  // Discovery
  testMatch: [
    '**/__tests__/**/*.ts',
    '**/?(*.)+(spec|test).ts'
  ],
  
  // Exclusions
  testPathIgnorePatterns: [
    '/node_modules/',
    '/dist/',
    '/build/'
  ]
};
                </div>
            </div>

            <div class="demo-section">
                <h4>Environment Configuration</h4>
                <div class="input-group">
                    <label for="test-env-config">Test Environment Variables</label>
                    <textarea id="test-env-config" placeholder="NODE_ENV=test
PORT=3000
DATABASE_URL=mongodb://localhost:27017/test
API_KEY=test-api-key
LOG_LEVEL=debug"></textarea>
                </div>
                <button class="btn" onclick="saveEnvironmentConfig()">Save Environment</button>
                <button class="btn secondary" onclick="loadEnvironmentConfig()">Load Environment</button>
            </div>
        </div>

        <!-- Advanced Features Tab -->
        <div id="advanced-features" class="tab-content">
            <h2>üî¨ Advanced Testing Features</h2>
            <div class="alert info">
                Advanced utilities for rate limiting, validation, memory monitoring, error handling, and test isolation in complex testing scenarios.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>‚ö° Rate Limiting</h3>
                    <div class="input-group">
                        <label for="rate-window">Window (ms)</label>
                        <input type="number" id="rate-window" value="60000" placeholder="60000">
                    </div>
                    <div class="input-group">
                        <label for="rate-max">Max Requests</label>
                        <input type="number" id="rate-max" value="100" placeholder="100">
                    </div>
                    <div class="input-group">
                        <label for="rate-key">Rate Limit Key</label>
                        <input type="text" id="rate-key" value="user-123" placeholder="user-123">
                    </div>
                    <button class="btn" onclick="testRateLimiting()">Test Rate Limiting</button>
                    <div id="rate-results" class="status info" style="margin-top: 10px;">Ready to test</div>
                </div>

                <div class="card">
                    <h3>üõ°Ô∏è Streaming Validation</h3>
                    <div class="input-group">
                        <label for="validation-input-stream">Input Stream</label>
                        <textarea id="validation-input-stream" rows="3" placeholder="Enter text to validate..."></textarea>
                    </div>
                    <div class="input-group">
                        <label for="validation-schema">Validation Schema</label>
                        <select id="validation-schema">
                            <option value="safeString">Safe String</option>
                            <option value="email">Email</option>
                            <option value="htmlSanitized">HTML Sanitized</option>
                            <option value="xssProtected">XSS Protected</option>
                        </select>
                    </div>
                    <button class="btn" onclick="runStreamingValidation()">Validate Stream</button>
                    <div id="validation-results" class="status info" style="margin-top: 10px;">Ready to validate</div>
                </div>

                <div class="card">
                    <h3>üß† Memory Monitoring</h3>
                    <div class="metrics">
                        <div class="metric">
                            <div class="metric-value" id="memory-heap-used">0MB</div>
                            <div class="metric-label">Heap Used</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="memory-heap-total">0MB</div>
                            <div class="metric-label">Heap Total</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="memory-external">0MB</div>
                            <div class="metric-label">External</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn" onclick="startMemoryMonitoring()">Start Monitoring</button>
                        <button class="btn warning" onclick="detectMemoryLeaks()">Detect Leaks</button>
                        <button class="btn error" onclick="performMemoryCleanup()">Cleanup</button>
                    </div>
                </div>

                <div class="card">
                    <h3>üîÑ Error Wrapping</h3>
                    <div class="input-group">
                        <label for="error-operation">Operation Type</label>
                        <select id="error-operation">
                            <option value="async">Async Operation</option>
                            <option value="sync">Sync Operation</option>
                            <option value="route">Route Handler</option>
                            <option value="database">Database Query</option>
                            <option value="api">API Call</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="error-scenario">Error Scenario</label>
                        <select id="error-scenario">
                            <option value="network">Network Error</option>
                            <option value="validation">Validation Error</option>
                            <option value="timeout">Timeout Error</option>
                            <option value="database">Database Error</option>
                            <option value="success">Success Case</option>
                        </select>
                    </div>
                    <button class="btn" onclick="testErrorWrapping()">Test Error Wrapper</button>
                    <div id="error-results" class="status info" style="margin-top: 10px;">Ready to test</div>
                </div>
            </div>

            <div class="demo-section">
                <h4>Test Isolation Dashboard</h4>
                <div class="grid">
                    <div class="card">
                        <h3>üìä Environment State</h3>
                        <div id="env-state-display" class="terminal" style="min-height: 120px;">
                            <div>Environment Variables: 0</div>
                            <div>Test Mode: Inactive</div>
                            <div>Isolation Level: None</div>
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button class="btn" onclick="backupEnvironment()">Backup</button>
                            <button class="btn secondary" onclick="restoreEnvironment()">Restore</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>üîå Connection Tracking</h3>
                        <div class="metrics">
                            <div class="metric">
                                <div class="metric-value" id="tracked-servers">0</div>
                                <div class="metric-label">Servers</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value" id="tracked-databases">0</div>
                                <div class="metric-label">Databases</div>
                            </div>
                            <div class="metric">
                                <div class="metric-value" id="tracked-mocks">0</div>
                                <div class="metric-label">Mocks</div>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button class="btn success" onclick="setupTestIsolation()">Setup Isolation</button>
                            <button class="btn error" onclick="cleanupTestIsolation()">Cleanup All</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>Browser Polyfills</h4>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="polyfill-clipboard">
                        Clipboard API
                    </label>
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="polyfill-intersection">
                        Intersection Observer
                    </label>
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="polyfill-resize">
                        Resize Observer
                    </label>
                </div>
                <div class="input-group">
                    <label>
                        <input type="checkbox" class="checkbox" id="polyfill-matchmedia">
                        Match Media
                    </label>
                </div>
                <button class="btn" onclick="setupPolyfills()">Setup Selected Polyfills</button>
                <button class="btn secondary" onclick="testPolyfills()">Test Polyfills</button>
            </div>
        </div>

        <!-- Email & HTTP Testing Tab -->
        <div id="email-http-testing" class="tab-content">
            <h2>üìß Email & üåê HTTP Testing</h2>
            <div class="alert success">
                Comprehensive email mocking and HTTP testing utilities for integration testing without external dependencies.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>üìß Email Testing</h3>
                    <div class="input-group">
                        <label for="email-to">To</label>
                        <input type="email" id="email-to" placeholder="user@example.com">
                    </div>
                    <div class="input-group">
                        <label for="email-subject">Subject</label>
                        <input type="text" id="email-subject" placeholder="Test Email">
                    </div>
                    <div class="input-group">
                        <label for="email-body">Message</label>
                        <textarea id="email-body" rows="3" placeholder="Hello, this is a test email!"></textarea>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn" onclick="sendTestEmail()">Send Email</button>
                        <button class="btn secondary" onclick="viewEmailHistory()">View History</button>
                        <button class="btn warning" onclick="clearEmailHistory()">Clear History</button>
                    </div>
                    <div id="email-results" class="status info" style="margin-top: 10px;">Ready to send emails</div>
                </div>

                <div class="card">
                    <h3>üåê HTTP Testing</h3>
                    <div class="input-group">
                        <label for="http-method">Method</label>
                        <select id="http-method">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="PATCH">PATCH</option>
                            <option value="DELETE">DELETE</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="http-path">Path</label>
                        <input type="text" id="http-path" value="/api/users" placeholder="/api/users">
                    </div>
                    <div class="input-group">
                        <label for="http-body">Request Body (JSON)</label>
                        <textarea id="http-body" rows="3" placeholder='{"name": "John", "email": "john@example.com"}'></textarea>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn" onclick="createMockRoute()">Create Route</button>
                        <button class="btn success" onclick="testHttpEndpoint()">Test Endpoint</button>
                    </div>
                    <div id="http-results" class="status info" style="margin-top: 10px;">Ready to test HTTP</div>
                </div>
            </div>

            <div class="demo-section">
                <h4>üìß Email History</h4>
                <div id="email-history-display" class="terminal" style="min-height: 200px; max-height: 300px;">
                    <div style="color: #6b7280;">No emails sent yet...</div>
                </div>
            </div>

            <div class="demo-section">
                <h4>üåê Mock HTTP Server</h4>
                <div id="http-server-display" class="terminal" style="min-height: 200px; max-height: 300px;">
                    <div style="color: #6b7280;">No routes configured yet...</div>
                </div>
            </div>
        </div>

        <!-- Route Testing Tab -->
        <div id="route-testing" class="tab-content">
            <h2>üõ£Ô∏è Route Testing Utilities</h2>
            <div class="alert success">
                Comprehensive route testing utilities that eliminate duplication in HTTP route testing patterns with parameterized test generation.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>üöÄ Route Test Generator</h3>
                    <div class="input-group">
                        <label for="route-gen-method">HTTP Method</label>
                        <select id="route-gen-method">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                            <option value="PATCH">PATCH</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="route-gen-path">Route Path</label>
                        <input type="text" id="route-gen-path" value="/api/users/:id" placeholder="/api/users/:id">
                    </div>
                    <div class="input-group">
                        <label for="route-gen-description">Test Description</label>
                        <input type="text" id="route-gen-description" placeholder="User management endpoints">
                    </div>
                    <button class="btn" onclick="generateComprehensiveRouteTests()">Generate Tests</button>
                    <button class="btn secondary" onclick="previewRouteTests()">Preview Tests</button>
                </div>

                <div class="card">
                    <h3>üìã Test Scenarios</h3>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="scenario-success" checked>
                            Success Response Testing
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="scenario-validation" checked>
                            Validation Error Testing
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="scenario-auth" checked>
                            Authentication Testing
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="scenario-params" checked>
                            Parameter Testing
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="scenario-server-error">
                            Server Error Testing
                        </label>
                    </div>
                </div>

                <div class="card">
                    <h3>üéõÔ∏è Response Configuration</h3>
                    <div class="input-group">
                        <label for="success-status">Success Status Code</label>
                        <input type="number" id="success-status" value="200" min="200" max="299">
                    </div>
                    <div class="input-group">
                        <label for="error-status">Error Status Code</label>
                        <input type="number" id="error-status" value="400" min="400" max="599">
                    </div>
                    <div class="input-group">
                        <label for="response-data">Success Response Data (JSON)</label>
                        <textarea id="response-data" rows="3" placeholder='{"id": 123, "name": "John", "email": "john@example.com"}'></textarea>
                    </div>
                    <div class="input-group">
                        <label for="error-data">Error Response Data (JSON)</label>
                        <textarea id="error-data" rows="2" placeholder='{"error": "Validation failed", "details": ["Name is required"]}'></textarea>
                    </div>
                </div>

                <div class="card">
                    <h3>‚ö° Quick Route Templates</h3>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button class="btn" onclick="loadRouteTemplate('crud')">CRUD Operations</button>
                        <button class="btn" onclick="loadRouteTemplate('auth')">Authentication</button>
                        <button class="btn" onclick="loadRouteTemplate('search')">Search & Filter</button>
                        <button class="btn" onclick="loadRouteTemplate('file')">File Upload</button>
                        <button class="btn" onclick="loadRouteTemplate('webhook')">Webhook Handler</button>
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>üìù Generated Route Tests</h4>
                <div id="route-test-output" class="code-block" style="max-height: 400px; overflow-y: auto;">
                    <div style="color: #6b7280;">Configure route settings and click "Generate Tests" to see the generated test code...</div>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button class="btn success" onclick="copyRouteTests()">Copy Tests</button>
                    <button class="btn secondary" onclick="downloadRouteTests()">Download Tests</button>
                    <button class="btn" onclick="validateRouteTests()">Validate Tests</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>üß™ Route Testing Examples</h4>
                <div class="code-block">
// Example: Generated tests for GET /api/users/:id
import { describe, it, expect, beforeEach, afterEach } from '@jest/globals';
import { createMockApp, supertest } from 'qtests/utils/httpTest';
import { generateRouteTests } from 'qtests/lib/routeTestUtils';

describe('User Routes', () => {
  let app: any;
  let client: any;

  beforeEach(async () => {
    app = createMockApp();
    client = supertest(app);
  });

  afterEach(async () => {
    await app.close();
  });

  it('should fetch user successfully', async () => {
    const response = await client
      .get('/api/users/123')
      .expect(200);

    expect(response.body).toMatchObject({
      id: 123,
      name: expect.any(String),
      email: expect.any(String)
    });
  });

  it('should handle user not found', async () => {
    const response = await client
      .get('/api/users/999')
      .expect(404);

    expect(response.body.error).toBe('User not found');
  });

  it('should validate user ID format', async () => {
    const response = await client
      .get('/api/users/invalid')
      .expect(400);

    expect(response.body.error).toContain('Invalid user ID');
  });
});
                </div>
            </div>

            <div class="demo-section">
                <h4>üìä Route Testing Statistics</h4>
                <div class="metrics">
                    <div class="metric">
                        <div class="metric-value" id="routes-generated">0</div>
                        <div class="metric-label">Routes Generated</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="tests-created">0</div>
                        <div class="metric-label">Tests Created</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="scenarios-covered">0</div>
                        <div class="metric-label">Scenarios Covered</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="code-saved">0%</div>
                        <div class="metric-label">Code Saved</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Performance & Benchmarking Tab -->
        <div id="performance" class="tab-content">
            <h2>üìä Performance & Benchmarking</h2>
            <div class="alert warning">
                Monitor test performance, benchmark different approaches, and optimize your test suite for maximum efficiency.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>‚ö° Test Performance Metrics</h3>
                    <div class="metrics">
                        <div class="metric">
                            <div class="metric-value" id="perf-tests-per-second">0</div>
                            <div class="metric-label">Tests/Second</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="perf-avg-duration">0ms</div>
                            <div class="metric-label">Avg Duration</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="perf-memory-usage">0MB</div>
                            <div class="metric-label">Memory Usage</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="perf-cpu-usage">0%</div>
                            <div class="metric-label">CPU Usage</div>
                        </div>
                    </div>
                    <button class="btn" onclick="startPerformanceMonitoring()">Start Monitoring</button>
                    <button class="btn secondary" onclick="runPerformanceBenchmark()">Run Benchmark</button>
                </div>

                <div class="card">
                    <h3>üèÉ Batch Processing Analysis</h3>
                    <div class="input-group">
                        <label for="batch-size">Batch Size</label>
                        <input type="number" id="batch-size" value="4" min="1" max="16">
                    </div>
                    <div class="input-group">
                        <label for="test-count">Test Count</label>
                        <input type="number" id="test-count" value="100" min="10" max="1000">
                    </div>
                    <button class="btn" onclick="compareBatchingStrategies()">Compare Strategies</button>
                    <div id="batch-results" class="terminal" style="margin-top: 10px; min-height: 120px;">
                        <div>Ready to compare batching strategies...</div>
                    </div>
                </div>

                <div class="card">
                    <h3>üîÑ waitForCondition Testing</h3>
                    <div class="input-group">
                        <label for="wait-timeout">Timeout (ms)</label>
                        <input type="number" id="wait-timeout" value="2000" min="100" max="10000">
                    </div>
                    <div class="input-group">
                        <label for="wait-interval">Interval (ms)</label>
                        <input type="number" id="wait-interval" value="25" min="10" max="500">
                    </div>
                    <button class="btn" onclick="testWaitForCondition()">Test waitForCondition</button>
                    <div id="wait-results" class="terminal" style="margin-top: 10px; min-height: 100px;">
                        <div>Ready to test waitForCondition...</div>
                    </div>
                </div>

                <div class="card">
                    <h3>üõ£Ô∏è Route Testing Utilities</h3>
                    <div class="input-group">
                        <label for="route-method">HTTP Method</label>
                        <select id="route-method">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="route-path">Route Path</label>
                        <input type="text" id="route-path" value="/api/users/:id" placeholder="/api/users/:id">
                    </div>
                    <button class="btn" onclick="generateRouteTests()">Generate Route Tests</button>
                    <div id="route-test-results" class="terminal" style="margin-top: 10px; min-height: 100px;">
                        <div>Ready to generate route tests...</div>
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>üìà Performance Charts</h4>
                <canvas id="performance-chart" width="800" height="300"></canvas>
                <button class="btn secondary" onclick="drawPerformanceChart()" style="margin-top: 10px;">Update Chart</button>
            </div>

            <div class="demo-section">
                <h4>üéØ Optimization Recommendations</h4>
                <div id="optimization-tips" class="alert info">
                    <ul style="margin: 0; padding-left: 20px;">
                        <li>Use batch processing for large test suites</li>
                        <li>Enable test isolation to prevent cross-test interference</li>
                        <li>Stub external services to reduce test execution time</li>
                        <li>Use parallel execution where tests are independent</li>
                        <li>Consider waitForCondition for async operations</li>
                        <li>Use route testing utilities for API endpoint testing</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Integration Flows Tab -->
        <div id="integration-flows" class="tab-content">
            <h2>üîÑ Complete Integration Workflows</h2>
            <div class="alert success">
                End-to-end testing workflows demonstrating real-world integration patterns with QTests framework.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>üõí E-commerce Application Flow</h3>
                    <div class="workflow-steps">
                        <div class="workflow-step completed">
                            <div class="workflow-step-number">1</div>
                            <div>User Registration</div>
                        </div>
                        <div class="workflow-step completed">
                            <div class="workflow-step-number">2</div>
                            <div>Product Browse</div>
                        </div>
                        <div class="workflow-step active">
                            <div class="workflow-step-number">3</div>
                            <div>Cart Management</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">4</div>
                            <div>Checkout Process</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">5</div>
                            <div>Payment Processing</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">6</div>
                            <div>Order Confirmation</div>
                        </div>
                    </div>
                    <button class="btn success" onclick="runEcommerceFlow()">Run Complete Flow</button>
                    <button class="btn secondary" onclick="runEcommerceStep('cart')">Test Cart Step</button>
                </div>

                <div class="card">
                    <h3>üì± Social Media Application Flow</h3>
                    <div class="workflow-steps">
                        <div class="workflow-step completed">
                            <div class="workflow-step-number">1</div>
                            <div>User Authentication</div>
                        </div>
                        <div class="workflow-step active">
                            <div class="workflow-step-number">2</div>
                            <div>Feed Loading</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">3</div>
                            <div>Post Creation</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">4</div>
                            <div>Like/Comment</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">5</div>
                            <div>Notification System</div>
                        </div>
                    </div>
                    <button class="btn success" onclick="runSocialFlow()">Run Complete Flow</button>
                    <button class="btn secondary" onclick="runSocialStep('feed')">Test Feed Step</button>
                </div>

                <div class="card">
                    <h3>üè• Healthcare Application Flow</h3>
                    <div class="workflow-steps">
                        <div class="workflow-step completed">
                            <div class="workflow-step-number">1</div>
                            <div>Patient Registration</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">2</div>
                            <div>Appointment Booking</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">3</div>
                            <div>Medical Records</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">4</div>
                            <div>Prescription Management</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">5</div>
                            <div>Billing System</div>
                        </div>
                    </div>
                    <button class="btn success" onclick="runHealthcareFlow()">Run Complete Flow</button>
                    <button class="btn secondary" onclick="runHealthcareStep('appointment')">Test Appointment Step</button>
                </div>

                <div class="card">
                    <h3>üìä Analytics Dashboard Flow</h3>
                    <div class="workflow-steps">
                        <div class="workflow-step completed">
                            <div class="workflow-step-number">1</div>
                            <div>Data Collection</div>
                        </div>
                        <div class="workflow-step active">
                            <div class="workflow-step-number">2</div>
                            <div>Data Processing</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">3</div>
                            <div>Report Generation</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">4</div>
                            <div>Dashboard Display</div>
                        </div>
                        <div class="workflow-step">
                            <div class="workflow-step-number">5</div>
                            <div>Export Functionality</div>
                        </div>
                    </div>
                    <button class="btn success" onclick="runAnalyticsFlow()">Run Complete Flow</button>
                    <button class="btn secondary" onclick="runAnalyticsStep('processing')">Test Processing Step</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>üîÑ Live Integration Test Output</h4>
                <div id="integration-output" class="terminal" style="min-height: 300px; max-height: 500px;">
                    <div style="color: #4fc3f7;">$ qtests-runner --integration --flow=ecommerce</div>
                    <div>üîÑ Setting up integration test environment...</div>
                    <div>üåê Initializing mock services...</div>
                    <div>üìß Configuring email testing...</div>
                    <div>üí≥ Setting up payment processor mocks...</div>
                    <div>üóÑÔ∏è  Initializing database connections...</div>
                    <div style="color: #10b981;">‚úÖ Integration environment ready</div>
                    <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;">
                        <div>üß™ Starting integration tests...</div>
                        <div style="color: #f59e0b;">‚è≥ Running workflow tests...</div>
                    </div>
                </div>
                <div class="metrics" style="margin-top: 15px;">
                    <div class="metric">
                        <div class="metric-value" id="integration-tests-run">0</div>
                        <div class="metric-label">Tests Run</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="integration-passed">0</div>
                        <div class="metric-label">Passed</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="integration-failed">0</div>
                        <div class="metric-label">Failed</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="integration-duration">0ms</div>
                        <div class="metric-label">Duration</div>
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>üéõÔ∏è Flow Configuration</h4>
                <div class="grid">
                    <div class="card">
                        <h3>Test Environment</h3>
                        <div class="input-group">
                            <label>
                                <input type="checkbox" class="checkbox" id="integration-mock-services" checked>
                                Mock External Services
                            </label>
                        </div>
                        <div class="input-group">
                            <label>
                                <input type="checkbox" class="checkbox" id="integration-real-db">
                                Use Real Database
                            </label>
                        </div>
                        <div class="input-group">
                            <label>
                                <input type="checkbox" class="checkbox" id="integration-email-testing" checked>
                                Enable Email Testing
                            </label>
                        </div>
                        <div class="input-group">
                            <label>
                                <input type="checkbox" class="checkbox" id="integration-memory-monitoring" checked>
                                Memory Monitoring
                            </label>
                        </div>
                    </div>

                    <div class="card">
                        <h3>Flow Options</h3>
                        <div class="input-group">
                            <label for="flow-concurrency">Concurrency Level</label>
                            <select id="flow-concurrency">
                                <option value="1">Sequential</option>
                                <option value="2" selected>2 Parallel</option>
                                <option value="4">4 Parallel</option>
                                <option value="8">8 Parallel</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="flow-timeout">Test Timeout (ms)</label>
                            <input type="number" id="flow-timeout" value="30000" min="5000" max="300000">
                        </div>
                        <div class="input-group">
                            <label for="flow-retries">Max Retries</label>
                            <input type="number" id="flow-retries" value="3" min="0" max="10">
                        </div>
                        <div class="input-group">
                            <label>
                                <input type="checkbox" class="checkbox" id="flow-continue-on-failure">
                                Continue on Failure
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Real-World Scenarios Tab -->
        <div id="real-world-scenarios" class="tab-content">
            <h2>üåç Real-World Testing Scenarios</h2>
            <div class="alert info">
                Comprehensive testing scenarios based on real-world applications and common development challenges.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>üè¢ Enterprise Application Testing</h3>
                    <div class="input-group">
                        <label for="enterprise-scenario">Select Scenario</label>
                        <select id="enterprise-scenario" onchange="loadEnterpriseScenario()">
                            <option value="">Choose a scenario...</option>
                            <option value="user-management">User Management System</option>
                            <option value="inventory">Inventory Management</option>
                            <option value="payroll">Payroll Processing</option>
                            <option value="reporting">Business Intelligence</option>
                            <option value="compliance">Compliance & Auditing</option>
                        </select>
                    </div>
                    <button class="btn" onclick="runEnterpriseScenario()">Run Scenario</button>
                    <button class="btn secondary" onclick="generateEnterpriseTests()">Generate Tests</button>
                </div>

                <div class="card">
                    <h3>üì± Mobile Application Testing</h3>
                    <div class="input-group">
                        <label for="mobile-platform">Platform</label>
                        <select id="mobile-platform">
                            <option value="react-native">React Native</option>
                            <option value="flutter">Flutter</option>
                            <option value="ionic">Ionic</option>
                            <option value="cordova">Cordova</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="mobile-scenario">App Type</label>
                        <select id="mobile-scenario">
                            <option value="social">Social Media</option>
                            <option value="ecommerce">E-commerce</option>
                            <option value="productivity">Productivity</option>
                            <option value="gaming">Gaming</option>
                        </select>
                    </div>
                    <button class="btn" onclick="runMobileScenario()">Run Mobile Tests</button>
                </div>

                <div class="card">
                    <h3>üåê Microservices Architecture</h3>
                    <div class="input-group">
                        <label for="microservices-count">Number of Services</label>
                        <input type="number" id="microservices-count" value="5" min="2" max="20">
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="microservices-api-gateway" checked>
                            API Gateway Testing
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="microservices-service-mesh">
                            Service Mesh Testing
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" class="checkbox" id="microservices-circuit-breaker" checked>
                            Circuit Breaker Testing
                        </label>
                    </div>
                    <button class="btn" onclick="runMicroservicesScenario()">Run Microservices Tests</button>
                </div>

                <div class="card">
                    <h3>ü§ñ AI/ML Application Testing</h3>
                    <div class="input-group">
                        <label for="ml-model-type">Model Type</label>
                        <select id="ml-model-type">
                            <option value="classification">Classification</option>
                            <option value="regression">Regression</option>
                            <option value="nlp">Natural Language Processing</option>
                            <option value="computer-vision">Computer Vision</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="ml-test-data">Test Dataset Size</label>
                        <input type="number" id="ml-test-data" value="1000" min="100" max="10000">
                    </div>
                    <div class="input-group">
                        <label for="ml-accuracy-threshold">Accuracy Threshold (%)</label>
                        <input type="number" id="ml-accuracy-threshold" value="85" min="50" max="99">
                    </div>
                    <button class="btn" onclick="runMLScenario()">Run ML Tests</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>üéØ Scenario Execution Results</h4>
                <div id="scenario-output" class="terminal" style="min-height: 250px; max-height: 400px;">
                    <div style="color: #6b7280;">Select a scenario and click "Run" to see execution results...</div>
                </div>
                <div class="metrics" style="margin-top: 15px;">
                    <div class="metric">
                        <div class="metric-value" id="scenario-score">0%</div>
                        <div class="metric-label">Test Score</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="scenario-coverage">0%</div>
                        <div class="metric-label">Coverage</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="scenario-performance">0ms</div>
                        <div class="metric-label">Performance</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="scenario-reliability">0%</div>
                        <div class="metric-label">Reliability</div>
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>üìä Scenario Comparison</h4>
                <canvas id="scenario-chart" width="800" height="300"></canvas>
                <button class="btn secondary" onclick="drawScenarioChart()" style="margin-top: 10px;">Update Comparison</button>
            </div>
        </div>

        <!-- Playground Tab -->
        <div id="playground" class="tab-content">
            <h2>üéÆ Interactive Playground</h2>
            <div class="alert warning">
                Experiment with QTests features in real-time. Write test code, see results instantly, and explore different testing scenarios.
            </div>

            <div class="grid">
                <div class="card">
                    <h3>Code Editor</h3>
                    <div class="input-group">
                        <label for="playground-code">Test Code</label>
                        <textarea id="playground-code" rows="15" placeholder="// Write your test code here
import { describe, it, expect } from '@jest/globals';
import { stubMethod, mockConsole } from 'qtests/setup';

describe('Sample Test', () => {
  it('should demonstrate stubbing', () => {
    const obj = { method: () => 'original' };
    stubMethod(obj, 'method', () => 'stubbed');
    
    expect(obj.method()).toBe('stubbed');
  });
});"></textarea>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn success" onclick="runPlaygroundCode()">Run Code</button>
                        <button class="btn secondary" onclick="clearPlayground()">Clear</button>
                        <button class="btn" onclick="loadExample()">Load Example</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Execution Results</h3>
                    <div id="playground-results" class="terminal">
                        <div style="color: #6b7280;">Results will appear here...</div>
                    </div>
                    <div class="metrics" style="margin-top: 15px;">
                        <div class="metric">
                            <div class="metric-value" id="playground-passed">0</div>
                            <div class="metric-label">Passed</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="playground-failed">0</div>
                            <div class="metric-label">Failed</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="playground-duration">0ms</div>
                            <div class="metric-label">Duration</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="demo-section">
                <h4>üöÄ Quick Actions</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn" onclick="simulateRealWorldTest()">Run Real-World Test</button>
                    <button class="btn secondary" onclick="generateTestReport()">Generate Report</button>
                    <button class="btn warning" onclick="exportTestConfig()">Export Config</button>
                    <button class="btn success" onclick="validateTestCode()">Validate Code</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>Example Templates</h4>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn" onclick="loadTemplate('basic-stubbing')">Basic Stubbing</button>
                    <button class="btn" onclick="loadTemplate('console-mocking')">Console Mocking</button>
                    <button class="btn" onclick="loadTemplate('env-management')">Environment Management</button>
                    <button class="btn" onclick="loadTemplate('error-wrapping')">Error Wrapping</button>
                    <button class="btn" onclick="loadTemplate('async-testing')">Async Testing</button>
                    <button class="btn" onclick="loadTemplate('react-testing')">React Testing</button>
                    <button class="btn" onclick="loadTemplate('rate-limiting')">Rate Limiting</button>
                    <button class="btn" onclick="loadTemplate('validation')">Validation</button>
                    <button class="btn" onclick="loadTemplate('memory-testing')">Memory Testing</button>
                    <button class="btn" onclick="loadTemplate('email-testing')">Email Testing</button>
                    <button class="btn" onclick="loadTemplate('route-testing')">Route Testing</button>
                    <button class="btn" onclick="loadTemplate('wait-condition')">waitForCondition</button>
                </div>
            </div>

            <div class="demo-section">
                <h4>Feature Explorer</h4>
                <div class="input-group">
                    <label for="feature-select">Select Feature to Explore</label>
                    <select id="feature-select" onchange="exploreFeature()">
                        <option value="">Choose a feature...</option>
                        <option value="stubMethod">stubMethod()</option>
                        <option value="spyOnMethod">spyOnMethod()</option>
                        <option value="mockConsole">mockConsole()</option>
                        <option value="testEnv">testEnv utilities</option>
                        <option value="offlineMode">offlineMode()</option>
                        <option value="errorWrappers">Error Wrappers</option>
                        <option value="memoryMonitor">Memory Monitoring</option>
                        <option value="validation">Validation</option>
                        <option value="rateLimiting">Rate Limiting</option>
                        <option value="emailTesting">Email Testing</option>
                        <option value="httpTesting">HTTP Testing</option>
                        <option value="routeTesting">Route Testing</option>
                        <option value="waitForCondition">waitForCondition()</option>
                        <option value="testIsolation">Test Isolation</option>
                        <option value="polyfills">Browser Polyfills</option>
                    </select>
                </div>
                <div id="feature-explanation" class="alert info" style="display: none;">
                    <!-- Feature explanation will appear here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Footer with additional information -->
    <footer style="background: white; border-radius: 12px; padding: 30px; margin-top: 30px; box-shadow: var(--shadow-lg);">
        <div class="grid">
            <div class="card" style="background: transparent; border: none; box-shadow: none; padding: 0;">
                <h3 style="color: var(--primary); margin-bottom: 15px;">üìö Documentation</h3>
                <ul class="feature-list" style="padding: 0;">
                    <li><a href="#overview" style="color: var(--primary); text-decoration: none;" onclick="showTab('overview', this)">Getting Started</a></li>
                    <li><a href="#test-generation" style="color: var(--primary); text-decoration: none;" onclick="showTab('test-generation', this)">Test Generation</a></li>
                    <li><a href="#mocking" style="color: var(--primary); text-decoration: none;" onclick="showTab('mocking', this)">Mocking Guide</a></li>
                    <li><a href="#advanced-features" style="color: var(--primary); text-decoration: none;" onclick="showTab('advanced-features', this)">Advanced Features</a></li>
                </ul>
            </div>
            
            <div class="card" style="background: transparent; border: none; box-shadow: none; padding: 0;">
                <h3 style="color: var(--primary); margin-bottom: 15px;">üöÄ Quick Links</h3>
                <ul class="feature-list" style="padding: 0;">
                    <li><a href="https://www.npmjs.com/package/qtests" target="_blank" style="color: var(--primary); text-decoration: none;">NPM Package</a></li>
                    <li><a href="https://github.com/qtests/qtests" target="_blank" style="color: var(--primary); text-decoration: none;">GitHub Repository</a></li>
                    <li><a href="#playground" style="color: var(--primary); text-decoration: none;" onclick="showTab('playground', this)">Interactive Playground</a></li>
                    <li><a href="#configuration" style="color: var(--primary); text-decoration: none;" onclick="showTab('configuration', this)">Configuration</a></li>
                </ul>
            </div>
            
            <div class="card" style="background: transparent; border: none; box-shadow: none; padding: 0;">
                <h3 style="color: var(--primary); margin-bottom: 15px;">üõ†Ô∏è CLI Commands</h3>
                <div class="code-block" style="font-size: 12px; margin: 0;">
                    <div># Install</div>
                    <div>npm install qtests --save-dev</div>
                    <div style="margin-top: 10px;"># Generate tests</div>
                    <div>npx qtests-generate</div>
                    <div style="margin-top: 10px;"># Run tests</div>
                    <div>npm test</div>
                </div>
            </div>
            
            <div class="card" style="background: transparent; border: none; box-shadow: none; padding: 0;">
                <h3 style="color: var(--primary); margin-bottom: 15px;">üìä System Status</h3>
                <div class="system-status" style="font-size: 12px; color: #6b7280;">
                    Framework: QTests v2.0.0 | Environment: Browser | Response: 15ms
                </div>
                <div style="margin-top: 10px;">
                    <span class="status success">All Systems Operational</span>
                </div>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border); color: #6b7280; font-size: 14px;">
            <p>¬© 2025 QTests Framework - Comprehensive testing utilities for Node.js applications</p>
            <p style="margin-top: 5px;">Built with ‚ù§Ô∏è for developers who care about testing quality</p>
        </div>
    </footer>

    <script>
        // Tab navigation
        function showTab(tabName, targetElement) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all nav tabs
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab
            const selectedTab = document.getElementById(tabName);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }
            
            // Add active class to clicked nav tab
            const target = targetElement || event?.target;
            if (target && target.classList) {
                target.classList.add('active');
            }
        }

        // Workflow animation
        let workflowStep = 0;
        let workflowInterval = null;
        function runWorkflow() {
            const steps = ['step-1', 'step-2', 'step-3', 'step-4'];
            const progressBar = document.getElementById('workflow-progress');
            
            // Clear any existing interval
            if (workflowInterval) {
                clearInterval(workflowInterval);
            }
            
            workflowInterval = setInterval(() => {
                if (workflowStep > 0) {
                    const prevStep = document.getElementById(steps[workflowStep - 1]);
                    if (prevStep) {
                        prevStep.classList.remove('active');
                        prevStep.classList.add('completed');
                    }
                }
                
                if (workflowStep < steps.length) {
                    const currentStep = document.getElementById(steps[workflowStep]);
                    if (currentStep) {
                        currentStep.classList.add('active');
                    }
                    if (progressBar) {
                        progressBar.style.width = `${(workflowStep + 1) * 25}%`;
                    }
                    workflowStep++;
                } else {
                    clearInterval(workflowInterval);
                    workflowInterval = null;
                    setTimeout(() => {
                        // Reset workflow
                        steps.forEach(step => {
                            const stepElement = document.getElementById(step);
                            if (stepElement) {
                                stepElement.classList.remove('active', 'completed');
                            }
                        });
                        if (progressBar) {
                            progressBar.style.width = '0%';
                        }
                        workflowStep = 0;
                    }, 2000);
                }
            }, 1000);
        }

        // Test Generation
        function generateTests() {
            const sourceDirElement = document.getElementById('source-dir');
            const testDirElement = document.getElementById('test-dir');
            const modeElement = document.getElementById('generation-mode');
            const preview = document.getElementById('generation-preview');
            
            // Validate elements exist
            if (!sourceDirElement || !testDirElement || !modeElement || !preview) {
                console.error('Required elements not found');
                return;
            }
            
            const sourceDir = sourceDirElement.value || 'src';
            const testDir = testDirElement.value || 'tests';
            const mode = modeElement.value || 'ast';
            
            // Sanitize inputs to prevent XSS
            const sanitizedSourceDir = sourceDir.replace(/[<>&"']/g, '');
            const sanitizedTestDir = testDir.replace(/[<>&"']/g '');
            const sanitizedMode = mode.replace(/[<>&"']/g '');
            
            preview.innerHTML = `
                <div style="color: #4fc3f7;">$ qtests-generate --mode ${sanitizedMode} --src-dir ${sanitizedSourceDir} --test-dir ${sanitizedTestDir}</div>
                <div>üîç Analyzing source files in ${sanitizedSourceDir}/...</div>
                <div>üìù Found ${Math.floor(Math.random() * 20) + 5} TypeScript files</div>
                <div>‚öõÔ∏è  Detected ${Math.floor(Math.random() * 5) + 1} React components</div>
                <div>üåê  Detected ${Math.floor(Math.random() * 8) + 2} Express routes</div>
                <div>üß™  Generating ${Math.floor(Math.random() * 15) + 5} test files...</div>
                <div style="color: #10b981;">‚úÖ Test generation completed successfully!</div>
                <div>üìÅ Tests saved to ${sanitizedTestDir}/</div>
            `;
        }

        function previewGeneration() {
            generateTests(); // Same functionality for demo
        }

        // Test Runner
        let testRunning = false;
        let testRunnerInterval = null;
        function runTests() {
            if (testRunning) return;
            testRunning = true;
            
            const output = document.getElementById('test-output');
            const progress = document.getElementById('test-progress');
            const status = document.getElementById('test-status');
            const passedElement = document.getElementById('tests-passed');
            const failedElement = document.getElementById('tests-failed');
            const skippedElement = document.getElementById('tests-skipped');
            const durationElement = document.getElementById('test-duration');
            
            // Validate elements exist
            if (!output || !progress || !status || !passedElement || !failedElement || !skippedElement || !durationElement) {
                console.error('Required test runner elements not found');
                testRunning = false;
                return;
            }
            
            output.innerHTML = `
                <div style="color: #4fc3f7;">$ qtests-runner --config config/jest.config.mjs --pattern **/*.test.ts</div>
                <div>üîç Discovering test files...</div>
                <div>üì¶ Found 15 test files</div>
                <div>‚ö° Starting batch execution (4 concurrent)...</div>
                <div style="color: #f59e0b;">‚è≥ Running tests...</div>
            `;
            
            status.textContent = 'Running tests...';
            status.className = 'status warning';
            
            let progressValue = 0;
            
            // Clear any existing interval
            if (testRunnerInterval) {
                clearInterval(testRunnerInterval);
            }
            
            testRunnerInterval = setInterval(() => {
                progressValue += Math.random() * 15;
                if (progressValue >= 100) {
                    progressValue = 100;
                    clearInterval(testRunnerInterval);
                    testRunnerInterval = null;
                    
                    // Show results
                    const passed = Math.floor(Math.random() * 10) + 5;
                    const failed = Math.floor(Math.random() * 3);
                    const skipped = Math.floor(Math.random() * 2);
                    const duration = Math.floor(Math.random() * 500) + 200;
                    
                    passedElement.textContent = passed;
                    failedElement.textContent = failed;
                    skippedElement.textContent = skipped;
                    durationElement.textContent = duration + 'ms';
                    
                    output.innerHTML += `
                        <div style="color: #10b981;">‚úÖ Tests completed!</div>
                        <div>üìä Results: ${passed} passed, ${failed} failed, ${skipped} skipped</div>
                        <div>‚è±Ô∏è  Duration: ${duration}ms</div>
                        <div>üöÄ Performance: 69% faster than standard Jest</div>
                    `;
                    
                    status.textContent = failed > 0 ? 'Tests completed with failures' : 'All tests passed';
                    status.className = failed > 0 ? 'status error' : 'status success';
                    testRunning = false;
                }
                if (progress) {
                    progress.style.width = progressValue + '%';
                }
            }, 200);
        }

        function runTestsWithCoverage() {
            runTests(); // Same for demo, but would include coverage
        }

        // Mocking & Stubbing
        function applyStubs() {
            const stubs = [];
            if (document.getElementById('stub-axios').checked) stubs.push('axios');
            if (document.getElementById('stub-winston').checked) stubs.push('winston');
            if (document.getElementById('stub-mongoose').checked) stubs.push('mongoose');
            if (document.getElementById('stub-console').checked) stubs.push('console');
            
            alert(`Applied stubs for: ${stubs.join(', ')}`);
        }

        function resetStubs() {
            alert('All stubs have been reset');
        }

        function createMethodStub() {
            const target = document.getElementById('stub-target').value;
            const method = document.getElementById('stub-method').value;
            const impl = document.getElementById('stub-implementation').value;
            
            if (target && method) {
                alert(`Created stub for ${target}.${method}()`);
            } else {
                alert('Please fill in target and method fields');
            }
        }

        function toggleOfflineMode() {
            const checkbox = document.getElementById('offline-mode');
            const status = document.getElementById('offline-status');
            
            if (checkbox.checked) {
                status.textContent = 'Offline mode - All external services stubbed';
                status.className = 'status warning';
            } else {
                status.textContent = 'Online mode - External services active';
                status.className = 'status info';
            }
        }

        // Utilities
        function setTestEnv() {
            const varName = document.getElementById('env-var-name').value;
            const varValue = document.getElementById('env-var-value').value;
            
            if (varName && varValue) {
                alert(`Set ${varName} = ${varValue}`);
            } else {
                alert('Please fill in environment variable name and value');
            }
        }

        function saveAndRestoreEnv() {
            alert('Environment saved and can be restored');
        }

        function createErrorWrapper() {
            const type = document.getElementById('error-wrapper-type').value;
            alert(`Generated ${type} error wrapper`);
        }

        let memoryMonitoringInterval = null;
        function startMemoryMonitoring() {
            const usageElement = document.getElementById('memory-usage');
            const heapElement = document.getElementById('heap-size');
            
            // Clear any existing interval
            if (memoryMonitoringInterval) {
                clearInterval(memoryMonitoringInterval);
            }
            
            // Validate elements exist
            if (!usageElement || !heapElement) {
                console.error('Memory monitoring elements not found');
                return;
            }
            
            memoryMonitoringInterval = setInterval(() => {
                const usage = Math.floor(Math.random() * 50) + 20;
                const heap = Math.floor(Math.random() * 30) + 15;
                
                usageElement.textContent = usage + 'MB';
                heapElement.textContent = heap + 'MB';
            }, 1000);
            
            setTimeout(() => {
                clearInterval(memoryMonitoringInterval);
                memoryMonitoringInterval = null;
            }, 10000);
        }

        function detectMemoryLeaks() {
            alert('Memory leak detection completed - No leaks detected');
        }

        function runValidation() {
            const type = document.getElementById('validation-type').value;
            const input = document.getElementById('validation-input').value;
            
            if (input) {
                alert(`${type} validation completed for: "${input}"`);
            } else {
                alert('Please enter text to validate');
            }
        }

        function setupTestIsolation() {
            alert('Test isolation setup completed');
        }

        function cleanupTestIsolation() {
            alert('Test isolation cleanup completed');
        }

        // Configuration
        function generateJestConfig() {
            alert('Jest configuration generated successfully');
        }

        function validateJestConfig() {
            alert('Jest configuration is valid');
        }

        function addModuleMapping() {
            const pattern = document.getElementById('module-pattern').value;
            const stub = document.getElementById('module-stub').value;
            const mappings = document.getElementById('module-mappings');
            
            if (pattern && stub) {
                mappings.innerHTML += `<div class="status success">${pattern} ‚Üí ${stub}</div>`;
                document.getElementById('module-pattern').value = '';
                document.getElementById('module-stub').value = '';
            }
        }

        function saveEnvironmentConfig() {
            alert('Environment configuration saved');
        }

        function loadEnvironmentConfig() {
            alert('Environment configuration loaded');
        }

        // Playground
        function runPlaygroundCode() {
            const code = document.getElementById('playground-code').value;
            const results = document.getElementById('playground-results');
            
            if (!code.trim()) {
                results.innerHTML = '<div style="color: #ef4444;">Please enter some code to run</div>';
                return;
            }
            
            results.innerHTML = `
                <div style="color: #4fc3f7;">> Running test code...</div>
                <div>‚úì Sample Test</div>
                <div>  ‚úì should demonstrate stubbing</div>
                <div style="color: #10b981;">‚úÖ All tests passed (1 test, 1 assertion)</div>
                <div>‚è±Ô∏è  Duration: ${Math.floor(Math.random() * 50) + 10}ms</div>
            `;
            
            document.getElementById('playground-passed').textContent = '1';
            document.getElementById('playground-failed').textContent = '0';
            document.getElementById('playground-duration').textContent = Math.floor(Math.random() * 50) + 10 + 'ms';
        }

        function clearPlayground() {
            document.getElementById('playground-code').value = '';
            document.getElementById('playground-results').innerHTML = '<div style="color: #6b7280;">Results will appear here...</div>';
            document.getElementById('playground-passed').textContent = '0';
            document.getElementById('playground-failed').textContent = '0';
            document.getElementById('playground-duration').textContent = '0ms';
        }

function loadExample() {
            const exampleCode = `import { describe, it, expect, beforeEach } from '@jest/globals';
import { stubMethod, mockConsole, testEnv } from 'qtests/setup';

describe('UserService Example', () => {
  let userService;
  let consoleSpy;

  beforeEach(() => {
    // Setup test environment
    testEnv.setTestEnv();
    
    // Mock console
    consoleSpy = mockConsole();
    
    // Create service with stubbed dependencies
    userService = {
      fetchUser: (id) => ({ id, name: 'John' }),
      saveUser: (user) => Promise.resolve({ ...user, id: 1 })
    };
    
    // Stub methods
    stubMethod(userService, 'fetchUser', jest.fn());
  });

  it('should fetch user successfully', async () => {
    const result = await userService.fetchUser(123);
    
    expect(result).toBeDefined();
    expect(result.id).toBe(123);
    expect(consoleSpy.log).toHaveBeenCalledWith('User fetched');
  });

  it('should handle errors gracefully', async () => {
    stubMethod(userService, 'fetchUser', jest.fn().mockRejectedValue(new Error('Not found')));
    
    await expect(userService.fetchUser(999)).rejects.toThrow('Not found');
  });
});`;
            
            document.getElementById('playground-code').value = exampleCode;
        }

        function validateTestCode() {
            const code = document.getElementById('playground-code').value;
            const results = document.getElementById('playground-results');
            
            if (!code.trim()) {
                results.innerHTML = '<div style="color: #ef4444;">‚ùå No code to validate</div>';
                return;
            }
            
            // Simple validation checks
            const issues = [];
            const suggestions = [];
            
            if (!code.includes('describe(')) {
                issues.push('Missing describe() block');
            }
            
            if (!code.includes('it(') && !code.includes('test(')) {
                issues.push('Missing test case (it() or test())');
            }
            
            if (!code.includes('expect(')) {
                suggestions.push('Add assertions with expect()');
            }
            
            if (code.includes('stubMethod') && !code.includes('jest.fn()')) {
                suggestions.push('Consider using jest.fn() for stub implementations');
            }
            
            if (code.includes('async') && !code.includes('await')) {
                issues.push('Async function missing await keyword');
            }
            
            if (issues.length === 0) {
                results.innerHTML = `
                    <div style="color: #10b981;">‚úÖ Code validation passed</div>
                    <div>üìä Structure: Valid</div>
                    <div>üß™ Tests: Detected</div>
                    <div>üìù Assertions: Present</div>
                    ${suggestions.length > 0 ? `<div style="color: #f59e0b; margin-top: 10px;">üí° Suggestions: ${suggestions.join(', ')}</div>` : ''}
                `;
            } else {
                results.innerHTML = `
                    <div style="color: #ef4444;">‚ùå Code validation failed</div>
                    <div>üö® Issues found:</div>
                    ${issues.map(issue => `<div style="color: #ef4444; margin-left: 20px;">‚Ä¢ ${issue}</div>`).join('')}
                    ${suggestions.length > 0 ? `<div style="color: #f59e0b; margin-top: 10px;">üí° Suggestions: ${suggestions.join(', ')}</div>` : ''}
                `;
            }
        }

        function loadTemplate(templateName) {
            const playgroundCodeElement = document.getElementById('playground-code');
            
            if (!playgroundCodeElement) {
                console.error('Playground code element not found');
                return;
            }
            
            const templates = {
                'basic-stubbing': `// Basic Method Stubbing
import { stubMethod } from 'qtests/setup';

const calculator = {
  add: (a, b) => a + b,
  multiply: (a, b) => a * b
};

// Stub add method
stubMethod(calculator, 'add', jest.fn().mockReturnValue(100));

console.log(calculator.add(5, 10)); // Returns 100, not 15`,
                
                'console-mocking': `// Console Mocking
import { mockConsole } from 'qtests/setup';

// Mock console methods
const consoleSpy = mockConsole();

console.log('Test message');
console.error('Error message');
console.warn('Warning message');

// Check what was logged
expect(consoleSpy.log).toHaveBeenCalledWith('Test message');
expect(consoleSpy.error).toHaveBeenCalledWith('Error message');`,
                
                'env-management': `// Environment Management
import { testEnv } from 'qtests/setup';

// Set test environment
testEnv.setTestEnv({
  NODE_ENV: 'test',
  API_URL: 'http://localhost:3000',
  DEBUG: 'true'
});

// Save current environment
testEnv.saveEnv();

// Modify environment for test
process.env.NODE_ENV = 'production';

// Restore after test
testEnv.restoreEnv();`,
                
                'error-wrapping': `// Error Wrapping
import { createAsyncErrorWrapper } from 'qtests/utils/errorHandling';

const riskyOperation = async (data) => {
  if (!data) throw new Error('No data provided');
  return { success: true, data };
};

// Wrap with error handling
const safeOperation = createAsyncErrorWrapper(riskyOperation, {
  errorMessage: 'Operation failed',
  fallbackValue: { success: false, error: 'Wrapped error' }
});

await safeOperation(null); // Returns fallback instead of throwing`,
                
                'async-testing': `// Async Testing
import { waitForCondition } from 'qtests/utils';

describe('Async Operations', () => {
  it('should wait for condition', async () => {
    let counter = 0;
    
    // Simulate async operation
    setTimeout(() => counter = 5, 100);
    
    // Wait for condition to be true
    await waitForCondition(() => counter === 5, { timeout: 1000 });
    
    expect(counter).toBe(5);
  });
});`,
                
                'react-testing': `// React Component Testing
import React from 'react';
import { render, screen } from '@testing-library/react';
import { stubMethod } from 'qtests/setup';

// Mock API service
const apiService = {
  fetchUser: jest.fn()
};

stubMethod(apiService, 'fetchUser', jest.fn().mockResolvedValue({
  id: 1,
  name: 'John Doe'
}));

// Test component
const UserComponent = () => {
  const [user, setUser] = React.useState(null);
  
  React.useEffect(() => {
    apiService.fetchUser().then(setUser);
  }, []);
  
  return user ? <div>{user.name}</div> : <div>Loading...</div>;
};

test('renders user name', async () => {
  render(<UserComponent />);
  
  expect(screen.getByText('Loading...')).toBeInTheDocument();
  
  const userName = await screen.findByText('John Doe');
  expect(userName).toBeInTheDocument();
});`
            };
            
            const code = templates[templateName];
            if (code) {
                playgroundCodeElement.value = code;
            }
        }
        }

        function exploreFeature() {
            const select = document.getElementById('feature-select');
            const explanation = document.getElementById('feature-explanation');
            
            const explanations = {
                'stubMethod': 'stubMethod(object, methodName, implementation) - Replaces a method on an object with a stub implementation. Useful for isolating dependencies in tests.',
                'spyOnMethod': 'spyOnMethod(object, methodName) - Creates a spy for a method that tracks calls without replacing the implementation. Helps verify method interactions.',
                'mockConsole': 'mockConsole() - Replaces console methods with Jest spies that track calls. Keeps test output clean while allowing console behavior verification.',
                'testEnv': 'testEnv utilities - Manage environment variables in tests with setTestEnv(), saveEnv(), and restoreEnv(). Ensures test isolation and predictable environment state.',
                'offlineMode': 'offlineMode.setOfflineMode(true) - Enables offline mode that stubs all external services (HTTP requests, database connections, etc.). Perfect for unit testing.',
                'errorWrappers': 'Error Wrappers - createAsyncErrorWrapper() and createSyncErrorWrapper() wrap functions with error handling, providing fallback values and consistent error reporting.',
                'memoryMonitor': 'Memory Monitoring - memoryMonitor() and detectMemoryLeaks() track memory usage during tests, helping identify memory leaks and performance issues.',
                'validation': 'Validation Utilities - StreamingStringValidator, HTML sanitization, and XSS protection utilities help test input validation and security measures.'
            };
            
            if (select.value && explanations[select.value]) {
                explanation.textContent = explanations[select.value];
                explanation.style.display = 'block';
            } else {
                explanation.style.display = 'none';
            }
        }

        // Advanced Features Functions
        function testRateLimiting() {
            const window = parseInt(document.getElementById('rate-window').value) || 60000;
            const max = parseInt(document.getElementById('rate-max').value) || 100;
            const key = document.getElementById('rate-key').value || 'test-key';
            const results = document.getElementById('rate-results');
            
            results.innerHTML = `<div class="status warning">Testing rate limiting...</div>`;
            
            setTimeout(() => {
                const allowed = Math.random() > 0.3; // Simulate rate limit check
                const remaining = Math.floor(Math.random() * max);
                
                results.innerHTML = allowed 
                    ? `<div class="status success">Request allowed - ${remaining} remaining</div>`
                    : `<div class="status error">Rate limit exceeded - Retry after 30s</div>`;
            }, 500);
        }

        function runStreamingValidation() {
            const input = document.getElementById('validation-input-stream').value;
            const schema = document.getElementById('validation-schema').value;
            const results = document.getElementById('validation-results');
            
            if (!input) {
                results.innerHTML = `<div class="status error">Please enter text to validate</div>`;
                return;
            }
            
            results.innerHTML = `<div class="status warning">Validating stream...</div>`;
            
            setTimeout(() => {
                const isValid = Math.random() > 0.2; // Simulate validation
                const sanitized = input.replace(/<script[^>]*>.*?<\/script>/gi, '[SCRIPT_REMOVED]');
                
                results.innerHTML = isValid
                    ? `<div class="status success">‚úÖ Valid ${schema}</div>`
                    : `<div class="status error">‚ùå Invalid ${schema} - Sanitized: ${sanitized.substring(0, 50)}...</div>`;
            }, 300);
        }

        function performMemoryCleanup() {
            const results = document.getElementById('memory-results') || document.createElement('div');
            results.id = 'memory-results';
            results.className = 'status success';
            results.textContent = 'üßπ Memory cleanup completed - 25MB freed';
            
            const memoryCard = document.querySelector('#advanced-features .card:nth-child(3)');
            if (memoryCard && !document.getElementById('memory-results')) {
                memoryCard.appendChild(results);
            }
        }

        function testErrorWrapping() {
            const operation = document.getElementById('error-operation').value;
            const scenario = document.getElementById('error-scenario').value;
            const results = document.getElementById('error-results');
            
            results.innerHTML = `<div class="status warning">Testing ${operation} error wrapper...</div>`;
            
            setTimeout(() => {
                if (scenario === 'success') {
                    results.innerHTML = `<div class="status success">‚úÖ Operation completed successfully</div>`;
                } else {
                    results.innerHTML = `<div class="status info">üõ°Ô∏è Error wrapped: ${scenario} - Fallback applied</div>`;
                }
            }, 400);
        }

        function backupEnvironment() {
            const display = document.getElementById('env-state-display');
            const envCount = Object.keys(process.env || {}).length;
            
            display.innerHTML = `
                <div>‚úÖ Environment backed up</div>
                <div>Environment Variables: ${envCount}</div>
                <div>Test Mode: Active</div>
                <div>Isolation Level: Full</div>
                <div>Backup ID: backup-${Date.now()}</div>
            `;
        }

        function restoreEnvironment() {
            const display = document.getElementById('env-state-display');
            
            display.innerHTML = `
                <div>‚úÖ Environment restored</div>
                <div>Environment Variables: ${Math.floor(Math.random() * 20) + 5}</div>
                <div>Test Mode: Inactive</div>
                <div>Isolation Level: None</div>
                <div>Restore Time: ${new Date().toLocaleTimeString()}</div>
            `;
        }

        function setupPolyfills() {
            const polyfills = [];
            if (document.getElementById('polyfill-clipboard').checked) polyfills.push('Clipboard');
            if (document.getElementById('polyfill-intersection').checked) polyfills.push('Intersection Observer');
            if (document.getElementById('polyfill-resize').checked) polyfills.push('Resize Observer');
            if (document.getElementById('polyfill-matchmedia').checked) polyfills.push('Match Media');
            
            if (polyfills.length > 0) {
                alert(`‚úÖ Setup complete for: ${polyfills.join(', ')}`);
            } else {
                alert('‚ö†Ô∏è Please select at least one polyfill');
            }
        }

        function testPolyfills() {
            alert('üß™ Polyfill testing complete - All working correctly');
        }

        // Email & HTTP Testing Functions
        function sendTestEmail() {
            const to = document.getElementById('email-to').value;
            const subject = document.getElementById('email-subject').value;
            const body = document.getElementById('email-body').value;
            const results = document.getElementById('email-results');
            
            if (!to) {
                results.innerHTML = `<div class="status error">Please enter recipient email</div>`;
                return;
            }
            
            results.innerHTML = `<div class="status warning">Sending email...</div>`;
            
            setTimeout(() => {
                const messageId = `msg-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                results.innerHTML = `<div class="status success">‚úÖ Email sent - ID: ${messageId}</div>`;
                updateEmailHistory(to, subject, body, messageId);
            }, 800);
        }

        function updateEmailHistory(to, subject, body, messageId) {
            const history = document.getElementById('email-history-display');
            const timestamp = new Date().toLocaleTimeString();
            
            if (history.innerHTML.includes('No emails sent yet')) {
                history.innerHTML = '';
            }
            
            history.innerHTML = `
                <div style="color: #10b981;">‚úÖ Email Sent</div>
                <div>üìß To: ${to}</div>
                <div>üìã Subject: ${subject}</div>
                <div>üìù Body: ${body.substring(0, 50)}${body.length > 50 ? '...' : ''}</div>
                <div>üÜî ID: ${messageId}</div>
                <div>‚è∞ Time: ${timestamp}</div>
                <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;"></div>
            ` + history.innerHTML;
        }

        function viewEmailHistory() {
            const history = document.getElementById('email-history-display');
            if (history.innerHTML.includes('No emails sent yet')) {
                history.innerHTML = '<div style="color: #f59e0b;">üì≠ No emails in history yet</div>';
            }
        }

        function clearEmailHistory() {
            const history = document.getElementById('email-history-display');
            history.innerHTML = '<div style="color: #6b7280;">üóëÔ∏è Email history cleared</div>';
            document.getElementById('email-results').innerHTML = '<div class="status info">History cleared</div>';
        }

        function createMockRoute() {
            const method = document.getElementById('http-method').value;
            const path = document.getElementById('http-path').value;
            const server = document.getElementById('http-server-display');
            
            if (server.innerHTML.includes('No routes configured yet')) {
                server.innerHTML = '';
            }
            
            server.innerHTML = `
                <div style="color: #10b981;">‚úÖ Route Created</div>
                <div>üåê ${method} ${path}</div>
                <div>üìù Handler: Mock response</div>
                <div>‚è∞ Time: ${new Date().toLocaleTimeString()}</div>
                <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;"></div>
            ` + server.innerHTML;
            
            document.getElementById('http-results').innerHTML = `<div class="status success">‚úÖ Route created: ${method} ${path}</div>`;
        }

        function testHttpEndpoint() {
            const method = document.getElementById('http-method').value;
            const path = document.getElementById('http-path').value;
            const body = document.getElementById('http-body').value;
            const results = document.getElementById('http-results');
            
            results.innerHTML = `<div class="status warning">Testing ${method} ${path}...</div>`;
            
            setTimeout(() => {
                const statusCodes = { GET: 200, POST: 201, PUT: 200, PATCH: 200, DELETE: 204 };
                const status = statusCodes[method] || 200;
                
                results.innerHTML = `
                    <div class="status success">‚úÖ Request completed</div>
                    <div>üìä Status: ${status}</div>
                    <div>‚è±Ô∏è Duration: ${Math.floor(Math.random() * 100) + 10}ms</div>
                `;
            }, 600);
        }

        // Performance Functions
        let performanceInterval = null;
        function startPerformanceMonitoring() {
            const testsPerSec = document.getElementById('perf-tests-per-second');
            const avgDuration = document.getElementById('perf-avg-duration');
            const memoryUsage = document.getElementById('perf-memory-usage');
            const cpuUsage = document.getElementById('perf-cpu-usage');
            
            if (performanceInterval) {
                clearInterval(performanceInterval);
            }
            
            performanceInterval = setInterval(() => {
                testsPerSec.textContent = Math.floor(Math.random() * 50) + 10;
                avgDuration.textContent = Math.floor(Math.random() * 100) + 20 + 'ms';
                memoryUsage.textContent = Math.floor(Math.random() * 100) + 50 + 'MB';
                cpuUsage.textContent = Math.floor(Math.random() * 60) + 10 + '%';
            }, 1000);
            
            setTimeout(() => {
                clearInterval(performanceInterval);
                performanceInterval = null;
            }, 10000);
        }

        // Additional utility functions for enhanced demo
        function generateTestReport() {
            const reportData = {
                timestamp: new Date().toISOString(),
                framework: 'QTests v2.0.0',
                tests: {
                    total: Math.floor(Math.random() * 100) + 50,
                    passed: Math.floor(Math.random() * 80) + 40,
                    failed: Math.floor(Math.random() * 10) + 1,
                    skipped: Math.floor(Math.random() * 5)
                },
                performance: {
                    avgDuration: Math.floor(Math.random() * 50) + 10,
                    memoryUsage: Math.floor(Math.random() * 100) + 50,
                    coverage: Math.floor(Math.random() * 30) + 70
                },
                features: {
                    stubbing: true,
                    mocking: true,
                    validation: true,
                    rateLimiting: true,
                    memoryMonitoring: true,
                    emailTesting: true,
                    httpTesting: true
                }
            };
            
            const reportHtml = `
                <div style="background: #1f2937; color: #f3f4f6; padding: 20px; border-radius: 8px; font-family: monospace;">
                    <div style="color: #10b981; font-weight: bold;">üìä QTests Test Report</div>
                    <div>Generated: ${reportData.timestamp}</div>
                    <div>Framework: ${reportData.framework}</div>
                    <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;">
                        <div style="color: #22d3ee;">Test Results:</div>
                        <div>  Total: ${reportData.tests.total}</div>
                        <div>  Passed: ${reportData.tests.passed}</div>
                        <div>  Failed: ${reportData.tests.failed}</div>
                        <div>  Skipped: ${reportData.tests.skipped}</div>
                    </div>
                    <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;">
                        <div style="color: #22d3ee;">Performance:</div>
                        <div>  Avg Duration: ${reportData.performance.avgDuration}ms</div>
                        <div>  Memory Usage: ${reportData.performance.memoryUsage}MB</div>
                        <div>  Coverage: ${reportData.performance.coverage}%</div>
                    </div>
                    <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;">
                        <div style="color: #22d3ee;">Active Features:</div>
                        <div>  ${Object.entries(reportData.features).filter(([k,v]) => v).map(([k]) => k).join(', ')}</div>
                    </div>
                </div>
            `;
            
            const reportWindow = window.open('', '_blank', 'width=600,height=500');
            reportWindow.document.write(`
                <html>
                    <head><title>QTests Test Report</title></head>
                    <body style="background: #111; margin: 20px;">
                        ${reportHtml}
                        <div style="margin-top: 20px;">
                            <button onclick="window.print()" style="background: #10b981; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">Print Report</button>
                            <button onclick="window.close()" style="background: #ef4444; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-left: 10px;">Close</button>
                        </div>
                    </body>
                </html>
            `);
        }

        function exportTestConfig() {
            const config = {
                name: 'QTests Configuration',
                version: '2.0.0',
                jest: {
                    testEnvironment: 'node',
                    preset: 'ts-jest/presets/default-esm',
                    setupFilesAfterEnv: ['<rootDir>/config/jest-setup.ts'],
                    moduleNameMapper: {
                        'axios': 'qtests/stubs/axios',
                        'winston': 'qtests/stubs/winston',
                        'mongoose': 'qtests/stubs/mongoose'
                    }
                },
                qtests: {
                    offlineMode: false,
                    memoryMonitoring: true,
                    testIsolation: true,
                    emailTesting: true,
                    httpTesting: true
                }
            };
            
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'qtests-config.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function simulateRealWorldTest() {
            const output = document.getElementById('test-output');
            if (!output) return;
            
            output.innerHTML = `
                <div style="color: #4fc3f7;">$ qtests-runner --config config/jest.config.mjs --testPathPattern=integration</div>
                <div>üîç Discovering integration tests...</div>
                <div>üì¶ Found 8 integration test files</div>
                <div>‚ö° Starting integration test suite...</div>
                <div style="color: #f59e0b;">üîÑ Setting up test environment...</div>
                <div>üåê Initializing mock servers...</div>
                <div>üìß Setting up email testing...</div>
                <div>üß† Starting memory monitoring...</div>
                <div style="color: #10b981;">‚úÖ Environment setup complete</div>
                <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;">
                    <div>üß™ Running integration tests...</div>
                    <div>  ‚úì UserService Integration Tests</div>
                    <div>    ‚úì should create user via API</div>
                    <div>    ‚úì should handle validation errors</div>
                    <div>    ‚úì should send welcome email</div>
                    <div>  ‚úì PaymentService Integration Tests</div>
                    <div>    ‚úì should process payment successfully</div>
                    <div>    ‚úì should handle declined payments</div>
                    <div>    ‚úì should retry failed payments</div>
                    <div>  ‚úì NotificationService Integration Tests</div>
                    <div>    ‚úì should send push notifications</div>
                    <div>    ‚úì should handle rate limiting</div>
                </div>
                <div style="color: #10b981; border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;">
                    ‚úÖ Integration tests completed successfully!
                </div>
                <div>üìä Results: 24 passed, 0 failed, 0 skipped</div>
                <div>‚è±Ô∏è  Duration: 1.2s</div>
                <div>üß† Memory: +15MB (within limits)</div>
                <div>üìß Emails sent: 3 (mock)</div>
                <div>üåê API calls: 12 (stubbed)</div>
            `;
            
            // Update metrics
            setTimeout(() => {
                const passedElement = document.getElementById('tests-passed');
                const failedElement = document.getElementById('tests-failed');
                const durationElement = document.getElementById('test-duration');
                
                if (passedElement) passedElement.textContent = '24';
                if (failedElement) failedElement.textContent = '0';
                if (durationElement) durationElement.textContent = '1200ms';
            }, 2000);
        }

        function runPerformanceBenchmark() {
            const batchResults = document.getElementById('batch-results');
            batchResults.innerHTML = `
                <div>üèÉ Running performance benchmark...</div>
                <div>üìä Testing different batch sizes...</div>
                <div>‚ö° Measuring execution times...</div>
            `;
            
            setTimeout(() => {
                batchResults.innerHTML = `
                    <div style="color: #10b981;">‚úÖ Benchmark Complete</div>
                    <div>üìà Best Performance: Batch size 8</div>
                    <div>‚ö° Speed Improvement: 69% vs sequential</div>
                    <div>üß† Memory Efficiency: +45%</div>
                    <div>‚è±Ô∏è Avg Test Time: 12ms (vs 38ms sequential)</div>
                `;
            }, 2000);
        }

        function compareBatchingStrategies() {
            const batchSize = parseInt(document.getElementById('batch-size').value) || 4;
            const testCount = parseInt(document.getElementById('test-count').value) || 100;
            const results = document.getElementById('batch-results');
            
            results.innerHTML = `
                <div>üîÑ Comparing strategies for ${testCount} tests...</div>
                <div>üì¶ Batch size: ${batchSize}</div>
            `;
            
            setTimeout(() => {
                results.innerHTML = `
                    <div style="color: #10b981;">üìä Strategy Comparison Results</div>
                    <div>üèÜ Winner: Parallel Batching</div>
                    <div>‚ö° Sequential: ${testCount * 25}ms</div>
                    <div>üîÑ Parallel Batching: ${Math.floor(testCount * 25 / 4)}ms</div>
                    <div>üìà Performance Gain: 75% faster</div>
                    <div>üß† Memory Usage: +15%</div>
                `;
            }, 1500);
        }

        // waitForCondition testing
        function testWaitForCondition() {
            const timeout = parseInt(document.getElementById('wait-timeout').value) || 2000;
            const interval = parseInt(document.getElementById('wait-interval').value) || 25;
            const results = document.getElementById('wait-results');
            
            results.innerHTML = `
                <div>üîÑ Testing waitForCondition...</div>
                <div>‚è±Ô∏è Timeout: ${timeout}ms, Interval: ${interval}ms</div>
            `;
            
            // Simulate async condition
            let conditionMet = false;
            setTimeout(() => {
                conditionMet = true;
            }, Math.random() * 1500 + 500);
            
            // Simulate waiting for condition
            const startTime = Date.now();
            const checkInterval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                
                if (conditionMet || elapsed > timeout) {
                    clearInterval(checkInterval);
                    
                    if (conditionMet) {
                        results.innerHTML = `
                            <div style="color: #10b981;">‚úÖ Condition met!</div>
                            <div>‚è±Ô∏è Wait time: ${elapsed}ms</div>
                            <div>üéØ Success: Condition satisfied within timeout</div>
                        `;
                    } else {
                        results.innerHTML = `
                            <div style="color: #ef4444;">‚ùå Timeout reached</div>
                            <div>‚è±Ô∏è Wait time: ${elapsed}ms</div>
                            <div>‚ö†Ô∏è Error: Condition not met within ${timeout}ms</div>
                        `;
                    }
                } else {
                    results.innerHTML = `
                        <div>üîÑ Testing waitForCondition...</div>
                        <div>‚è±Ô∏è Timeout: ${timeout}ms, Interval: ${interval}ms</div>
                        <div>‚è≥ Waiting... (${elapsed}ms elapsed)</div>
                    `;
                }
            }, interval);
        }

        // Route testing utilities
        function generateRouteTests() {
            const method = document.getElementById('route-method').value;
            const path = document.getElementById('route-path').value;
            const results = document.getElementById('route-test-results');
            
            if (!path) {
                results.innerHTML = `<div style="color: #ef4444;">‚ùå Please enter a route path</div>`;
                return;
            }
            
            results.innerHTML = `
                <div>üîÑ Generating route tests for ${method} ${path}...</div>
                <div>üìù Creating test scenarios...</div>
            `;
            
            setTimeout(() => {
                const testCode = generateRouteTestCode(method, path);
                results.innerHTML = `
                    <div style="color: #10b981;">‚úÖ Route tests generated!</div>
                    <div>üìù Method: ${method}</div>
                    <div>üõ£Ô∏è Path: ${path}</div>
                    <div>üß™ Test scenarios: 4</div>
                    <div style="border-top: 1px solid #444; margin-top: 10px; padding-top: 10px;">
                        <div style="color: #22d3ee; font-family: monospace; font-size: 12px; white-space: pre-wrap;">${testCode}</div>
                    </div>
                `;
            }, 1000);
        }

        function generateRouteTestCode(method, path) {
            const routeName = path.replace(/[^a-zA-Z0-9]/g, '_').replace(/^_+|_+$/g, '');
            const hasParams = path.includes(':');
            
            let testCode = `// Generated tests for ${method} ${path}
import { describe, it, expect, beforeEach, afterEach } from '@jest/globals';
import { createMockApp, supertest } from 'qtests/utils/httpTest';
import { generateRouteTests } from 'qtests/lib/routeTestUtils';

describe('${routeName} Routes', () => {
  let app: any;
  let client: any;

  beforeEach(async () => {
    app = createMockApp();
    client = supertest(app);
  });

  afterEach(async () => {
    await app.close();
  });

  it('should handle successful ${method} request', async () => {
    const response = await client
      .${method.toLowerCase()}('${path}')
      .expect(200);

    expect(response.body).toBeDefined();
    expect(response.body.success).toBe(true);
  });`;

            if (hasParams) {
                testCode += `

  it('should handle ${method} request with parameters', async () => {
    const testId = '123';
    const response = await client
      .${method.toLowerCase()}('${path.replace(':id', testId)}')
      .expect(200);

    expect(response.body.id).toBe(testId);
  });`;
            }

            testCode += `

  it('should handle validation errors', async () => {
    const response = await client
      .${method.toLowerCase()}('${path}')
      .send({ invalid: 'data' })
      .expect(400);

    expect(response.body.error).toBeDefined();
  });

  it('should handle server errors', async () => {
    // Mock server error
    jest.spyOn(console, 'error').mockImplementation();
    
    const response = await client
      .${method.toLowerCase()}('${path}')
      .expect(500);

    expect(response.body.error).toBeDefined();
  });
});`;

            return testCode;
        }

        // Enhanced template loading
        function loadTemplate(templateName) {
            const playgroundCodeElement = document.getElementById('playground-code');
            
            if (!playgroundCodeElement) {
                console.error('Playground code element not found');
                return;
            }
            
            const templates = {
                'basic-stubbing': `// Basic Method Stubbing
import { stubMethod } from 'qtests/setup';

const calculator = {
  add: (a, b) => a + b,
  multiply: (a, b) => a * b
};

// Stub add method
stubMethod(calculator, 'add', jest.fn().mockReturnValue(100));

console.log(calculator.add(5, 10)); // Returns 100, not 15`,
                
                'console-mocking': `// Console Mocking
import { mockConsole } from 'qtests/setup';

// Mock console methods
const consoleSpy = mockConsole();

console.log('Test message');
console.error('Error message');
console.warn('Warning message');

// Check what was logged
expect(consoleSpy.log).toHaveBeenCalledWith('Test message');
expect(consoleSpy.error).toHaveBeenCalledWith('Error message');`,
                
                'env-management': `// Environment Management
import { testEnv } from 'qtests/setup';

// Set test environment
testEnv.setTestEnv({
  NODE_ENV: 'test',
  API_URL: 'http://localhost:3000',
  DEBUG: 'true'
});

// Save current environment
testEnv.saveEnv();

// Modify environment for test
process.env.NODE_ENV = 'production';

// Restore after test
testEnv.restoreEnv();`,
                
                'error-wrapping': `// Error Wrapping
import { createAsyncErrorWrapper } from 'qtests/utils/errorHandling';

const riskyOperation = async (data) => {
  if (!data) throw new Error('No data provided');
  return { success: true, data };
};

// Wrap with error handling
const safeOperation = createAsyncErrorWrapper(riskyOperation, {
  errorMessage: 'Operation failed',
  fallbackValue: { success: false, error: 'Wrapped error' }
});

await safeOperation(null); // Returns fallback instead of throwing`,
                
                'async-testing': `// Async Testing
import { waitForCondition } from 'qtests/utils';

describe('Async Operations', () => {
  it('should wait for condition', async () => {
    let counter = 0;
    
    // Simulate async operation
    setTimeout(() => counter = 5, 100);
    
    // Wait for condition to be true
    await waitForCondition(() => counter === 5, { timeout: 1000 });
    
    expect(counter).toBe(5);
  });
});`,
                
                'react-testing': `// React Component Testing
import React from 'react';
import { render, screen } from '@testing-library/react';
import { stubMethod } from 'qtests/setup';

// Mock API service
const apiService = {
  fetchUser: jest.fn()
};

stubMethod(apiService, 'fetchUser', jest.fn().mockResolvedValue({
  id: 1,
  name: 'John Doe'
}));

// Test component
const UserComponent = () => {
  const [user, setUser] = React.useState(null);
  
  React.useEffect(() => {
    apiService.fetchUser().then(setUser);
  }, []);
  
  return user ? <div>{user.name}</div> : <div>Loading...</div>;
};

test('renders user name', async () => {
  render(<UserComponent />);
  
  expect(screen.getByText('Loading...')).toBeInTheDocument();
  
  const userName = await screen.findByText('John Doe');
  expect(userName).toBeInTheDocument();
});`,

                'rate-limiting': `// Rate Limiting Test
import { createDistributedRateLimiter } from 'qtests/utils/rateLimiter';

describe('Rate Limiting', () => {
  let limiter;
  
  beforeEach(() => {
    limiter = createDistributedRateLimiter({
      windowMs: 60000,
      maxRequests: 10
    });
  });
  
  it('should allow requests within limit', async () => {
    const req = { ip: '127.0.0.1', path: '/api/test' };
    
    for (let i = 0; i < 5; i++) {
      const result = await limiter.isAllowed(req);
      expect(result.allowed).toBe(true);
    }
  });
  
  it('should block requests exceeding limit', async () => {
    const req = { ip: '127.0.0.1', path: '/api/test' };
    
    // Exhaust limit
    for (let i = 0; i < 10; i++) {
      await limiter.isAllowed(req);
    }
    
    // Next request should be blocked
    const result = await limiter.isAllowed(req);
    expect(result.allowed).toBe(false);
  });
});`,

                'validation': `// Streaming Validation Test
import { createStreamingValidator } from 'qtests/utils/streamingValidator';

describe('Streaming Validation', () => {
  let validator;
  
  beforeEach(() => {
    validator = createStreamingValidator({
      maxLength: 100,
      allowHtml: false,
      sanitizeXss: true
    });
  });
  
  it('should validate safe strings', async () => {
    const result = await validator.validate('Hello, world!');
    expect(result.isValid).toBe(true);
    expect(result.sanitized).toBe('Hello, world!');
  });
  
  it('should sanitize dangerous content', async () => {
    const dangerous = '<script>alert("xss")</script>Hello';
    const result = await validator.validate(dangerous);
    
    expect(result.isValid).toBe(false);
    expect(result.sanitized).not.toContain('<script>');
  });
});`,

                'memory-testing': `// Memory Monitoring Test
import { memoryMonitor, detectMemoryLeaks } from 'qtests/utils/memory';

describe('Memory Monitoring', () => {
  it('should track memory usage', async () => {
    const snapshot = await memoryMonitor.getSnapshot();
    
    expect(snapshot.heapUsed).toBeGreaterThan(0);
    expect(snapshot.heapTotal).toBeGreaterThan(snapshot.heapUsed);
  });
  
  it('should detect memory leaks', async () => {
    // Simulate potential memory leak
    const leaks = [];
    
    for (let i = 0; i < 1000; i++) {
      leaks.push(new Array(1000).fill('leak'));
    }
    
    const leakReport = await detectMemoryLeaks();
    expect(leakReport.leaksDetected).toBe(true);
  });
});`,

                'email-testing': `// Email Testing
import { sendEmail, getEmailHistory, clearEmailHistory } from 'qtests/utils/sendEmail';

describe('Email Testing', () => {
  beforeEach(() => {
    clearEmailHistory();
  });
  
  it('should send email successfully', async () => {
    const emailData = {
      to: 'test@example.com',
      subject: 'Test Email',
      text: 'This is a test email'
    };
    
    const result = await sendEmail(emailData);
    
    expect(result.success).toBe(true);
    expect(result.messageId).toBeDefined();
    expect(result.to).toBe('test@example.com');
  });
  
  it('should track email history', async () => {
    await sendEmail({
      to: 'user1@example.com',
      subject: 'Email 1'
    });
    
    await sendEmail({
      to: 'user2@example.com',
      subject: 'Email 2'
    });
    
    const history = getEmailHistory();
    expect(history).toHaveLength(2);
    expect(history[0].to).toBe('user1@example.com');
    expect(history[1].to).toBe('user2@example.com');
  });
});`,

                'route-testing': `// Route Testing with Utilities
import { generateRouteTests, createMockApp, supertest } from 'qtests/lib/routeTestUtils';

describe('API Route Testing', () => {
  let app: any;
  let client: any;

  beforeEach(async () => {
    app = createMockApp();
    client = supertest(app);
  });

  afterEach(async () => {
    await app.close();
  });

  it('should test GET /api/users/:id', async () => {
    const routeConfig = {
      method: 'GET' as const,
      path: '/api/users/:id',
      successResponse: { id: 123, name: 'John' },
      errorResponse: { error: 'User not found' }
    };

    const tests = generateRouteTests(routeConfig);
    
    // Test success case
    const response = await client
      .get('/api/users/123')
      .expect(200);

    expect(response.body).toMatchObject(routeConfig.successResponse);
  });

  it('should test POST /api/users', async () => {
    const userData = { name: 'Jane', email: 'jane@example.com' };
    
    const response = await client
      .post('/api/users')
      .send(userData)
      .expect(201);

    expect(response.body).toMatchObject({ ...userData, id: expect.any(Number) });
  });
});`,

                'wait-condition': `// waitForCondition Testing
import { waitForCondition } from 'qtests/lib/waitForCondition';

describe('waitForCondition', () => {
  it('should wait for condition to become true', async () => {
    let counter = 0;
    
    // Simulate async operation
    setTimeout(() => counter = 5, 100);
    
    // Wait for condition
    await waitForCondition(() => counter === 5, { timeoutMs: 1000 });
    
    expect(counter).toBe(5);
  });

  it('should timeout if condition never becomes true', async () => {
    let conditionMet = false;
    
    await expect(
      waitForCondition(() => conditionMet, { timeoutMs: 100 })
    ).rejects.toThrow('waitForCondition: timeout after 100ms');
  });

  it('should handle async predicate functions', async () => {
    let data = null;
    
    setTimeout(() => data = 'loaded', 50);
    
    await waitForCondition(async () => {
      return data === 'loaded';
    }, { timeoutMs: 200 });
    
    expect(data).toBe('loaded');
  });
});`
            };
            
            const code = templates[templateName];
            if (code) {
                playgroundCodeElement.value = code;
            }
        }

        // Enhanced feature explanations
        function exploreFeature() {
            const select = document.getElementById('feature-select');
            const explanation = document.getElementById('feature-explanation');
            
            const explanations = {
                'stubMethod': 'stubMethod(object, methodName, implementation) - Replaces a method on an object with a stub implementation. Useful for isolating dependencies in tests.',
                'spyOnMethod': 'spyOnMethod(object, methodName) - Creates a spy for a method that tracks calls without replacing the implementation. Helps verify method interactions.',
                'mockConsole': 'mockConsole() - Replaces console methods with Jest spies that track calls. Keeps test output clean while allowing console behavior verification.',
                'testEnv': 'testEnv utilities - Manage environment variables in tests with setTestEnv(), saveEnv(), and restoreEnv(). Ensures test isolation and predictable environment state.',
                'offlineMode': 'offlineMode.setOfflineMode(true) - Enables offline mode that stubs all external services (HTTP requests, database connections, etc.). Perfect for unit testing.',
                'errorWrappers': 'Error Wrappers - createAsyncErrorWrapper() and createSyncErrorWrapper() wrap functions with error handling, providing fallback values and consistent error reporting.',
                'memoryMonitor': 'Memory Monitoring - memoryMonitor() and detectMemoryLeaks() track memory usage during tests, helping identify memory leaks and performance issues.',
                'validation': 'Validation Utilities - StreamingStringValidator, HTML sanitization, and XSS protection utilities help test input validation and security measures.',
                'rateLimiting': 'Rate Limiting - DistributedRateLimiter and InMemoryRateLimiter provide rate limiting functionality for testing API endpoints and preventing abuse.',
                'emailTesting': 'Email Testing - sendEmail() utility provides mock email sending for testing email functionality without external SMTP servers.',
                'httpTesting': 'HTTP Testing - createMockApp() and supertest() provide Express-like mocking and HTTP testing capabilities for API testing.',
                'routeTesting': 'Route Testing - generateRouteTests() and route testing utilities eliminate duplication in HTTP route testing with parameterized test generation for common scenarios.',
                'waitForCondition': 'waitForCondition() - Async utility that waits for a predicate function to return true, with configurable timeout and interval. Perfect for testing async operations.',
                'testIsolation': 'Test Isolation - backupEnvironment(), restoreEnvironment(), trackServer(), and closeAllServers() provide comprehensive test isolation utilities.',
                'polyfills': 'Browser Polyfills - setupClipboard(), setupIntersectionObserver(), and other polyfills enable testing browser-specific APIs in Node.js environments.'
            };
            
            if (select.value && explanations[select.value]) {
                explanation.textContent = explanations[select.value];
                explanation.style.display = 'block';
            } else {
                explanation.style.display = 'none';
            }
        }

        // Route Testing Functions
        function generateComprehensiveRouteTests() {
            const method = document.getElementById('route-gen-method').value;
            const path = document.getElementById('route-gen-path').value;
            const description = document.getElementById('route-gen-description').value;
            const output = document.getElementById('route-test-output');
            
            if (!path) {
                output.innerHTML = '<div style="color: #ef4444;">‚ùå Please enter a route path</div>';
                return;
            }
            
            const scenarios = {
                success: document.getElementById('scenario-success').checked,
                validation: document.getElementById('scenario-validation').checked,
                auth: document.getElementById('scenario-auth').checked,
                params: document.getElementById('scenario-params').checked,
                serverError: document.getElementById('scenario-server-error').checked
            };
            
            const successStatus = document.getElementById('success-status').value || '200';
            const errorStatus = document.getElementById('error-status').value || '400';
            const responseData = document.getElementById('response-data').value || '{"success": true}';
            const errorData = document.getElementById('error-data').value || '{"error": "Bad request"}';
            
            output.innerHTML = '<div style="color: #f59e0b;">üîÑ Generating comprehensive route tests...</div>';
            
            setTimeout(() => {
                const testCode = generateFullRouteTestSuite(method, path, description, scenarios, {
                    successStatus,
                    errorStatus,
                    responseData,
                    errorData
                });
                
                output.innerHTML = `<pre style="margin: 0; white-space: pre-wrap;">${testCode}</pre>`;
                
                // Update statistics
                updateRouteTestingStats(method, path, scenarios);
            }, 1000);
        }

        function generateFullRouteTestSuite(method, path, description, scenarios, config) {
            const routeName = path.replace(/[^a-zA-Z0-9]/g, '_').replace(/^_+|_+$/g, '') || 'route';
            const hasParams = path.includes(':');
            const desc = description || `Tests for ${method} ${path}`;
            
            let testSuite = `/**
 * ${desc}
 * Generated by QTests Route Testing Utilities
 */
import { describe, it, expect, beforeEach, afterEach } from '@jest/globals';
import { createMockApp, supertest } from 'qtests/utils/httpTest';
import { generateRouteTests } from 'qtests/lib/routeTestUtils';

describe('${routeName}', () => {
  let app: any;
  let client: any;

  beforeEach(async () => {
    app = createMockApp();
    client = supertest(app);
  });

  afterEach(async () => {
    await app.close();
  });`;

            // Success scenario
            if (scenarios.success) {
                testSuite += `

  it('should handle successful ${method} request', async () => {
    const response = await client
      .${method.toLowerCase()}('${path}')
      .expect(${config.successStatus});

    expect(response.body).toBeDefined();
    expect(response.body).toMatchObject(${config.responseData});
  });`;
            }

            // Parameter testing
            if (scenarios.params && hasParams) {
                testSuite += `

  it('should handle ${method} request with parameters', async () => {
    const testParams = {${extractRouteParams(path).map(param => `      ${param}: 'test-value'`).join(',\n')}};
    const paramPath = '${path}'.replace(${extractRouteParams(path).map(param => `/:${param}`).join('').replace(/^\//, '')}, Object.values(testParams).join('/'));
    
    const response = await client
      .${method.toLowerCase()}(paramPath)
      .expect(${config.successStatus});

    expect(response.body).toBeDefined();
    Object.entries(testParams).forEach(([key, value]) => {
      expect(response.body[key]).toBe(value);
    });
  });`;
            }

            // Validation testing
            if (scenarios.validation) {
                testSuite += `

  it('should handle validation errors', async () => {
    const response = await client
      .${method.toLowerCase()}('${path}')
      .send({ invalid: 'data' })
      .expect(${config.errorStatus});

    expect(response.body).toMatchObject(${config.errorData});
  });`;
            }

            // Authentication testing
            if (scenarios.auth) {
                testSuite += `

  it('should require authentication', async () => {
    const response = await client
      .${method.toLowerCase()}('${path}')
      .expect(401);

    expect(response.body.error).toBe('Authentication required');
  });

  it('should handle valid authentication', async () => {
    const response = await client
      .${method.toLowerCase()}('${path}')
      .set('Authorization', 'Bearer valid-token')
      .expect(${config.successStatus});

    expect(response.body).toBeDefined();
  });`;
            }

            // Server error testing
            if (scenarios.serverError) {
                testSuite += `

  it('should handle server errors gracefully', async () => {
    // Mock server error
    jest.spyOn(console, 'error').mockImplementation();
    
    const response = await client
      .${method.toLowerCase()}('${path}')
      .expect(500);

    expect(response.body.error).toBeDefined();
    expect(response.body.error).toBe('Internal server error');
  });`;
            }

            testSuite += `
});`;

            return testSuite;
        }

        function extractRouteParams(path) {
            const params = [];
            const parts = path.split('/');
            parts.forEach(part => {
                if (part.startsWith(':')) {
                    params.push(part.substring(1));
                }
            });
            return params;
        }

        function previewRouteTests() {
            generateComprehensiveRouteTests(); // Same functionality for demo
        }

        function loadRouteTemplate(templateType) {
            const templates = {
                'crud': {
                    method: 'GET',
                    path: '/api/users/:id',
                    description: 'CRUD user operations',
                    scenarios: { success: true, validation: true, auth: true, params: true, serverError: false },
                    config: { successStatus: '200', errorStatus: '404', responseData: '{"id": 123, "name": "John"}', errorData: '{"error": "User not found"}' }
                },
                'auth': {
                    method: 'POST',
                    path: '/api/auth/login',
                    description: 'Authentication endpoints',
                    scenarios: { success: true, validation: true, auth: false, params: false, serverError: true },
                    config: { successStatus: '200', errorStatus: '401', responseData: '{"token": "jwt-token", "user": {"id": 1}}', errorData: '{"error": "Invalid credentials"}' }
                },
                'search': {
                    method: 'GET',
                    path: '/api/search',
                    description: 'Search and filter endpoints',
                    scenarios: { success: true, validation: true, auth: true, params: false, serverError: false },
                    config: { successStatus: '200', errorStatus: '400', responseData: '{"results": [], "total": 0}', errorData: '{"error": "Invalid search query"}' }
                },
                'file': {
                    method: 'POST',
                    path: '/api/upload',
                    description: 'File upload endpoints',
                    scenarios: { success: true, validation: true, auth: true, params: false, serverError: true },
                    config: { successStatus: '201', errorStatus: '413', responseData: '{"fileId": "abc123", "size": 1024}', errorData: '{"error": "File too large"}' }
                },
                'webhook': {
                    method: 'POST',
                    path: '/api/webhooks/payment',
                    description: 'Webhook handlers',
                    scenarios: { success: true, validation: true, auth: true, params: false, serverError: true },
                    config: { successStatus: '200', errorStatus: '400', responseData: '{"processed": true}', errorData: '{"error": "Invalid webhook payload"}' }
                }
            };
            
            const template = templates[templateType];
            if (template) {
                // Set form values
                document.getElementById('route-gen-method').value = template.method;
                document.getElementById('route-gen-path').value = template.path;
                document.getElementById('route-gen-description').value = template.description;
                
                // Set scenarios
                Object.keys(template.scenarios).forEach(key => {
                    const checkbox = document.getElementById(`scenario-${key}`);
                    if (checkbox) checkbox.checked = template.scenarios[key];
                });
                
                // Set config
                document.getElementById('success-status').value = template.config.successStatus;
                document.getElementById('error-status').value = template.config.errorStatus;
                document.getElementById('response-data').value = template.config.responseData;
                document.getElementById('error-data').value = template.config.errorData;
                
                // Generate tests
                generateComprehensiveRouteTests();
            }
        }

        function copyRouteTests() {
            const output = document.getElementById('route-test-output');
            const text = output.textContent;
            
            if (text && !text.includes('Configure route settings')) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('‚úÖ Route tests copied to clipboard!');
                }).catch(() => {
                    alert('‚ùå Failed to copy tests');
                });
            } else {
                alert('‚ö†Ô∏è Please generate tests first');
            }
        }

        function downloadRouteTests() {
            const output = document.getElementById('route-test-output');
            const text = output.textContent;
            
            if (text && !text.includes('Configure route settings')) {
                const blob = new Blob([text], { type: 'text/typescript' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'route-tests.test.ts';
                a.click();
                URL.revokeObjectURL(url);
            } else {
                alert('‚ö†Ô∏è Please generate tests first');
            }
        }

        function validateRouteTests() {
            const output = document.getElementById('route-test-output');
            const text = output.textContent;
            
            if (!text || text.includes('Configure route settings')) {
                alert('‚ö†Ô∏è Please generate tests first');
                return;
            }
            
            // Simple validation checks
            const issues = [];
            const suggestions = [];
            
            if (!text.includes('describe(')) {
                issues.push('Missing describe() block');
            }
            
            if (!text.includes('it(')) {
                issues.push('Missing test cases');
            }
            
            if (!text.includes('expect(')) {
                suggestions.push('Add assertions with expect()');
            }
            
            if (!text.includes('beforeEach')) {
                suggestions.push('Consider adding beforeEach for setup');
            }
            
            if (!text.includes('afterEach')) {
                suggestions.push('Consider adding afterEach for cleanup');
            }
            
            if (issues.length === 0) {
                alert('‚úÖ Route tests validation passed!\n\nüìä Structure: Valid\nüß™ Tests: Detected\nüìù Assertions: Present\n' + 
                      (suggestions.length > 0 ? `\nüí° Suggestions: ${suggestions.join(', ')}` : ''));
            } else {
                alert('‚ùå Route tests validation failed!\n\nüö® Issues found:\n' + 
                      issues.map(issue => `‚Ä¢ ${issue}`).join('\n') + 
                      (suggestions.length > 0 ? `\n\nüí° Suggestions: ${suggestions.join(', ')}` : ''));
            }
        }

        function updateRouteTestingStats(method, path, scenarios) {
            const routesGenerated = parseInt(document.getElementById('routes-generated').textContent) + 1;
            const testsCreated = parseInt(document.getElementById('tests-created').textContent) + Object.values(scenarios).filter(Boolean).length;
            const scenariosCovered = parseInt(document.getElementById('scenarios-covered').textContent) + Object.values(scenarios).filter(Boolean).length;
            
            document.getElementById('routes-generated').textContent = routesGenerated;
            document.getElementById('tests-created').textContent = testsCreated;
            document.getElementById('scenarios-covered').textContent = scenariosCovered;
            document.getElementById('code-saved').textContent = Math.min(95, routesGenerated * 15) + '%';
        }

        // Chart drawing function
        function drawPerformanceChart() {
            const canvas = document.getElementById('performance-chart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            
            // Sample data
            const data = [
                { label: 'Sequential', value: 100, color: '#ef4444' },
                { label: 'Batch Size 2', value: 65, color: '#f59e0b' },
                { label: 'Batch Size 4', value: 40, color: '#22d3ee' },
                { label: 'Batch Size 8', value: 31, color: '#10b981' }
            ];
            
            // Draw bars
            const barWidth = width / (data.length * 2);
            const maxValue = Math.max(...data.map(d => d.value));
            
            data.forEach((item, index) => {
                const barHeight = (item.value / maxValue) * (height - 40);
                const x = (index * 2 + 0.5) * barWidth;
                const y = height - barHeight - 20;
                
                // Draw bar
                ctx.fillStyle = item.color;
                ctx.fillRect(x, y, barWidth, barHeight);
                
                // Draw label
                ctx.fillStyle = '#374151';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(item.label, x + barWidth / 2, height - 5);
                
                // Draw value
                ctx.fillText(item.value + 'ms', x + barWidth / 2, y - 5);
            });
            
            // Draw title
            ctx.fillStyle = '#1f2937';
            ctx.font = 'bold 14px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Test Execution Time by Strategy', width / 2, 15);
        }

        // System status dashboard
        function updateSystemStatus() {
            const statusData = {
                framework: 'QTests v2.0.0',
                nodeVersion: typeof process !== 'undefined' ? process.version : 'Browser',
                environment: typeof window !== 'undefined' ? 'Browser' : 'Node.js',
                features: {
                    stubbing: true,
                    mocking: true,
                    validation: true,
                    rateLimiting: true,
                    memoryMonitoring: true,
                    emailTesting: true,
                    httpTesting: true,
                    testIsolation: true
                },
                performance: {
                    responseTime: Math.floor(Math.random() * 50) + 10,
                    memoryUsage: Math.floor(Math.random() * 100) + 50,
                    uptime: Date.now() - (window.performance?.timeOrigin || Date.now())
                }
            };
            
            // Update status displays if they exist
            const statusElements = document.querySelectorAll('.system-status');
            statusElements.forEach(element => {
                element.innerHTML = `
                    <div style="font-size: 12px; color: #6b7280;">
                        Framework: ${statusData.framework} | 
                        Environment: ${statusData.environment} | 
                        Response: ${statusData.performance.responseTime}ms
                    </div>
                `;
            });
        }

        // Keyboard shortcuts for navigation
        document.addEventListener('keydown', function(e) {
            // Only trigger shortcuts when not typing in input fields
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') {
                return;
            }
            
            const tabs = ['overview', 'test-generation', 'test-runner', 'mocking', 'utilities', 'advanced-features', 'email-http-testing', 'route-testing', 'performance', 'configuration', 'playground'];
            const currentIndex = tabs.findIndex(tab => document.getElementById(tab).classList.contains('active'));
            
            switch(e.key) {
                case 'ArrowLeft':
                    if (currentIndex > 0) {
                        const prevTab = tabs[currentIndex - 1];
                        const prevButton = document.querySelector(`.nav-tab[onclick*="${prevTab}"]`);
                        if (prevButton) {
                            showTab(prevTab, prevButton);
                        }
                    }
                    e.preventDefault();
                    break;
                    
                case 'ArrowRight':
                    if (currentIndex < tabs.length - 1) {
                        const nextTab = tabs[currentIndex + 1];
                        const nextButton = document.querySelector(`.nav-tab[onclick*="${nextTab}"]`);
                        if (nextButton) {
                            showTab(nextTab, nextButton);
                        }
                    }
                    e.preventDefault();
                    break;
                    
                case '1':
                case '2':
                case '3':
                case '4':
                case '5':
                case '6':
                case '7':
                case '8':
                case '9':
                    const tabIndex = parseInt(e.key) - 1;
                    if (tabIndex < tabs.length) {
                        const targetTab = tabs[tabIndex];
                        const targetButton = document.querySelector(`.nav-tab[onclick*="${targetTab}"]`);
                        if (targetButton) {
                            showTab(targetTab, targetButton);
                        }
                    }
                    e.preventDefault();
                    break;
                    
                case 'r':
                case 'R':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        // Refresh current tab data
                        if (currentIndex === 2) { // Test runner tab
                            runTests();
                        } else if (currentIndex === 9) { // Playground tab
                            runPlaygroundCode();
                        }
                    }
                    break;
                    
                case '?':
                    // Show help modal
                    showKeyboardShortcuts();
                    e.preventDefault();
                    break;
            }
        });

        function showKeyboardShortcuts() {
            const shortcuts = `
                <div style="background: #1f2937; color: #f3f4f6; padding: 20px; border-radius: 8px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; min-width: 400px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);">
                    <h3 style="color: #10b981; margin-bottom: 15px;">‚å®Ô∏è Keyboard Shortcuts</h3>
                    <div style="line-height: 1.8;">
                        <div><strong>‚Üê/‚Üí</strong> - Navigate tabs</div>
                        <div><strong>1-9</strong> - Jump to specific tab</div>
                        <div><strong>Ctrl/Cmd + R</strong> - Refresh current tab</div>
                        <div><strong>?</strong> - Show this help</div>
                        <div><strong>Esc</strong> - Close this dialog</div>
                    </div>
                    <button onclick="this.parentElement.remove()" style="background: #10b981; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-top: 15px;">Close</button>
                </div>
                <div onclick="this.remove()" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999;"></div>
            `;
            
            const modal = document.createElement('div');
            modal.innerHTML = shortcuts;
            document.body.appendChild(modal);
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('QTests Demo loaded successfully');
            
            // Draw initial performance chart
            setTimeout(() => {
                drawPerformanceChart();
            }, 1000);
            
            // Start system status monitoring
            setInterval(updateSystemStatus, 5000);
            updateSystemStatus();
            
            // Add keyboard shortcuts hint to header
            const header = document.querySelector('header');
            if (header) {
                const shortcutsHint = document.createElement('div');
                shortcutsHint.style.cssText = 'font-size: 12px; color: #6b7280; margin-top: 10px;';
                shortcutsHint.innerHTML = 'üí° Press <strong>?</strong> for keyboard shortcuts';
                header.appendChild(shortcutsHint);
            }
            
            // Cleanup intervals on page unload to prevent memory leaks
            window.addEventListener('beforeunload', function() {
                if (workflowInterval) clearInterval(workflowInterval);
                if (testRunnerInterval) clearInterval(testRunnerInterval);
                if (memoryMonitoringInterval) clearInterval(memoryMonitoringInterval);
                if (performanceInterval) clearInterval(performanceInterval);
            });
        });
    </script>
</body>
</html>