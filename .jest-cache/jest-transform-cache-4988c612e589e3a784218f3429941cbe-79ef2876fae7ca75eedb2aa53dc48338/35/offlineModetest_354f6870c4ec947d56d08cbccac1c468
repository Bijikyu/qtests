4758d25589b0f78b552024d0d5a0888d
/**
 * Enhanced Offline Mode Tests
 * 
 * This test suite verifies the enhanced offline mode functionality including
 * environment variable detection, automatic configuration, and the new
 * environment adapter patterns. These tests ensure the offline mode utility
 * works correctly with both programmatic and environment-based configuration.
 * 
 * Test coverage includes:
 * - Environment variable detection (CODEX, OFFLINE_MODE)
 * - Automatic offline mode configuration
 * - Enhanced axios mock factory integration
 * - Improved qerrors handling
 * - Environment adapter creation
 * - State management and caching behavior
 */

const {
  setOfflineMode,
  isOfflineMode,
  getAxios,
  getQerrors,
  getEnvironmentState,
  createEnvironmentAdapters,
  clearOfflineCache
} = require('../utils/offlineMode');
describe('Enhanced Offline Mode', () => {
  // Save original environment variables
  const originalEnv = process.env;
  beforeEach(() => {
    // Reset environment variables for each test
    jest.resetModules();
    process.env = {
      ...originalEnv
    };
    clearOfflineCache();
  });
  afterAll(() => {
    // Restore original environment
    process.env = originalEnv;
  });
  describe('Environment Variable Detection', () => {
    test('detects CODEX environment variable', () => {
      process.env.CODEX = 'true';

      // Re-require module to pick up environment changes
      jest.resetModules();
      const offlineMode = require('../utils/offlineMode');
      const envState = offlineMode.getEnvironmentState();
      expect(envState.codexFlag).toBe(true);
      expect(envState.environmentDetected).toBe(true);
    });
    test('detects OFFLINE_MODE environment variable', () => {
      process.env.OFFLINE_MODE = 'true';
      jest.resetModules();
      const offlineMode = require('../utils/offlineMode');
      const envState = offlineMode.getEnvironmentState();
      expect(envState.offlineFlagExplicit).toBe(true);
      expect(envState.environmentDetected).toBe(true);
    });
    test('handles case-insensitive environment variables', () => {
      process.env.CODEX = 'TRUE';
      process.env.OFFLINE_MODE = 'True';
      jest.resetModules();
      const offlineMode = require('../utils/offlineMode');
      const envState = offlineMode.getEnvironmentState();
      expect(envState.codexFlag).toBe(true);
      expect(envState.offlineFlagExplicit).toBe(true);
    });
    test('ignores invalid environment variable values', () => {
      process.env.CODEX = 'false';
      process.env.OFFLINE_MODE = 'no';
      jest.resetModules();
      const offlineMode = require('../utils/offlineMode');
      const envState = offlineMode.getEnvironmentState();
      expect(envState.codexFlag).toBe(false);
      expect(envState.offlineFlagExplicit).toBe(false);
      expect(envState.environmentDetected).toBe(false);
    });
  });
  describe('Enhanced Axios Integration', () => {
    test('returns mock axios factory instance in offline mode', async () => {
      setOfflineMode(true);
      const axios = getAxios();

      // Verify it's a mock axios with enhanced capabilities
      expect(typeof axios.get).toBe('function');
      expect(typeof axios.post).toBe('function');
      expect(typeof axios.put).toBe('function');
      expect(typeof axios.delete).toBe('function');
      expect(typeof axios.request).toBe('function');

      // Test that it returns proper mock responses
      const response = await axios.get('/api/test');
      expect(response.status).toBe(200);
      expect(response.data).toEqual({});
      expect(response.statusText).toBe('OK');
    });
    test('mock axios handles all HTTP methods correctly', async () => {
      setOfflineMode(true);
      const axios = getAxios();

      // Test GET request
      const getResponse = await axios.get('/api/users');
      expect(getResponse.status).toBe(200);

      // Test POST request with data
      const postResponse = await axios.post('/api/users', {
        name: 'test'
      });
      expect(postResponse.status).toBe(200);

      // Test PUT request
      const putResponse = await axios.put('/api/users/1', {
        name: 'updated'
      });
      expect(putResponse.status).toBe(200);

      // Test DELETE request
      const deleteResponse = await axios.delete('/api/users/1');
      expect(deleteResponse.status).toBe(200);

      // Test generic request method
      const requestResponse = await axios.request({
        method: 'PATCH',
        url: '/api/test'
      });
      expect(requestResponse.status).toBe(200);
    });
  });
  describe('Enhanced Qerrors Handling', () => {
    test('returns enhanced no-op qerrors in offline mode', () => {
      setOfflineMode(true);
      const qerrorsImpl = getQerrors();

      // Verify it has the qerrors function
      expect(typeof qerrorsImpl.qerrors).toBe('function');

      // Test that it executes without throwing
      expect(() => {
        qerrorsImpl.qerrors();
      }).not.toThrow();
    });
    test('enhanced qerrors provides debugging output', () => {
      setOfflineMode(true);

      // Capture console output
      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();
      const qerrorsImpl = getQerrors();
      qerrorsImpl.qerrors();

      // Verify debugging output is generated
      expect(consoleSpy).toHaveBeenCalledWith('noopQerrors is running with none');
      expect(consoleSpy).toHaveBeenCalledWith('noopQerrors has run');
      consoleSpy.mockRestore();
    });
  });
  describe('Environment State Management', () => {
    test('getEnvironmentState returns comprehensive state information', () => {
      setOfflineMode(true);
      const state = getEnvironmentState();
      expect(state).toHaveProperty('codexFlag');
      expect(state).toHaveProperty('offlineFlagExplicit');
      expect(state).toHaveProperty('testEnvironment');
      expect(state).toHaveProperty('isOffline');
      expect(state).toHaveProperty('environmentDetected');
      expect(state.isOffline).toBe(true);
    });
    test('tracks environment detection correctly', () => {
      // Initially no environment detection
      let state = getEnvironmentState();
      expect(state.environmentDetected).toBe(false);

      // Set programmatic offline mode
      setOfflineMode(true);
      state = getEnvironmentState();
      expect(state.isOffline).toBe(true);
    });
  });
  describe('Environment Adapter Creation', () => {
    test('createEnvironmentAdapters returns complete adapter set', () => {
      setOfflineMode(true);
      const adapters = createEnvironmentAdapters();
      expect(adapters).toHaveProperty('isOffline');
      expect(adapters).toHaveProperty('axios');
      expect(adapters).toHaveProperty('qerrors');
      expect(adapters.isOffline).toBe(true);
      expect(typeof adapters.axios.get).toBe('function');
      expect(typeof adapters.qerrors.qerrors).toBe('function');
    });
    test('adapter set works together for complete offline simulation', async () => {
      setOfflineMode(true);
      const {
        axios,
        qerrors,
        isOffline
      } = createEnvironmentAdapters();

      // Verify offline state
      expect(isOffline).toBe(true);

      // Test axios functionality
      const response = await axios.get('/api/test');
      expect(response.status).toBe(200);

      // Test qerrors functionality
      expect(() => {
        qerrors.qerrors();
      }).not.toThrow();
    });
    test('adapter set provides online implementations when appropriate', () => {
      setOfflineMode(false);
      const {
        axios,
        qerrors,
        isOffline
      } = createEnvironmentAdapters();
      expect(isOffline).toBe(false);
      // Note: We can't easily test real axios/qerrors loading without dependencies
      // but we can verify the adapters are created without errors
      expect(axios).toBeDefined();
      expect(qerrors).toBeDefined();
    });
  });
  describe('Caching and Performance', () => {
    test('caches implementations for consistent behavior', () => {
      setOfflineMode(true);
      const axios1 = getAxios();
      const axios2 = getAxios();

      // Should return the same cached instance
      expect(axios1).toBe(axios2);
    });
    test('clearOfflineCache resets cached implementations', () => {
      setOfflineMode(true);
      const axios1 = getAxios();
      clearOfflineCache();
      const axios2 = getAxios();

      // Cache should be functional - both instances should work correctly
      // (Note: with static stub modules, object identity may be preserved by Node.js require cache)
      expect(axios1).toBeDefined();
      expect(axios2).toBeDefined();
      expect(typeof axios1.get).toBe('function');
      expect(typeof axios2.get).toBe('function');
    });
    test('cache is cleared when toggling offline mode', () => {
      setOfflineMode(true);
      const axios1 = getAxios();
      setOfflineMode(false);
      const axios2 = getAxios();

      // Should return different instances after mode toggle
      expect(axios1).not.toBe(axios2);
    });
  });
  describe('Error Handling and Fallbacks', () => {
    test('handles module loading errors gracefully', () => {
      setOfflineMode(false);

      // This should not throw even if real modules are unavailable
      expect(() => {
        getAxios();
      }).not.toThrow();
      expect(() => {
        getQerrors();
      }).not.toThrow();
    });
    test('provides fallback implementations when real modules fail', () => {
      setOfflineMode(false);

      // Get implementations (should fallback to stubs if real modules unavailable)
      const axios = getAxios();
      const qerrors = getQerrors();
      expect(axios).toBeDefined();
      expect(qerrors).toBeDefined();
    });
  });
  describe('Integration with Existing Functionality', () => {
    test('maintains compatibility with existing setOfflineMode API', () => {
      // Test original programmatic API still works
      expect(isOfflineMode()).toBe(false);
      setOfflineMode(true);
      expect(isOfflineMode()).toBe(true);
      setOfflineMode(false);
      expect(isOfflineMode()).toBe(false);
    });
    test('works correctly with existing clearOfflineCache function', () => {
      setOfflineMode(true);
      getAxios(); // Load into cache

      // Original cache clearing should still work
      expect(() => {
        clearOfflineCache();
      }).not.toThrow();
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZXRPZmZsaW5lTW9kZSIsImlzT2ZmbGluZU1vZGUiLCJnZXRBeGlvcyIsImdldFFlcnJvcnMiLCJnZXRFbnZpcm9ubWVudFN0YXRlIiwiY3JlYXRlRW52aXJvbm1lbnRBZGFwdGVycyIsImNsZWFyT2ZmbGluZUNhY2hlIiwicmVxdWlyZSIsImRlc2NyaWJlIiwib3JpZ2luYWxFbnYiLCJwcm9jZXNzIiwiZW52IiwiYmVmb3JlRWFjaCIsImplc3QiLCJyZXNldE1vZHVsZXMiLCJhZnRlckFsbCIsInRlc3QiLCJDT0RFWCIsIm9mZmxpbmVNb2RlIiwiZW52U3RhdGUiLCJleHBlY3QiLCJjb2RleEZsYWciLCJ0b0JlIiwiZW52aXJvbm1lbnREZXRlY3RlZCIsIk9GRkxJTkVfTU9ERSIsIm9mZmxpbmVGbGFnRXhwbGljaXQiLCJheGlvcyIsImdldCIsInBvc3QiLCJwdXQiLCJkZWxldGUiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJzdGF0dXMiLCJkYXRhIiwidG9FcXVhbCIsInN0YXR1c1RleHQiLCJnZXRSZXNwb25zZSIsInBvc3RSZXNwb25zZSIsIm5hbWUiLCJwdXRSZXNwb25zZSIsImRlbGV0ZVJlc3BvbnNlIiwicmVxdWVzdFJlc3BvbnNlIiwibWV0aG9kIiwidXJsIiwicWVycm9yc0ltcGwiLCJxZXJyb3JzIiwibm90IiwidG9UaHJvdyIsImNvbnNvbGVTcHkiLCJzcHlPbiIsImNvbnNvbGUiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsIm1vY2tSZXN0b3JlIiwic3RhdGUiLCJ0b0hhdmVQcm9wZXJ0eSIsImlzT2ZmbGluZSIsImFkYXB0ZXJzIiwidG9CZURlZmluZWQiLCJheGlvczEiLCJheGlvczIiXSwic291cmNlcyI6WyJvZmZsaW5lTW9kZS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRW5oYW5jZWQgT2ZmbGluZSBNb2RlIFRlc3RzXG4gKiBcbiAqIFRoaXMgdGVzdCBzdWl0ZSB2ZXJpZmllcyB0aGUgZW5oYW5jZWQgb2ZmbGluZSBtb2RlIGZ1bmN0aW9uYWxpdHkgaW5jbHVkaW5nXG4gKiBlbnZpcm9ubWVudCB2YXJpYWJsZSBkZXRlY3Rpb24sIGF1dG9tYXRpYyBjb25maWd1cmF0aW9uLCBhbmQgdGhlIG5ld1xuICogZW52aXJvbm1lbnQgYWRhcHRlciBwYXR0ZXJucy4gVGhlc2UgdGVzdHMgZW5zdXJlIHRoZSBvZmZsaW5lIG1vZGUgdXRpbGl0eVxuICogd29ya3MgY29ycmVjdGx5IHdpdGggYm90aCBwcm9ncmFtbWF0aWMgYW5kIGVudmlyb25tZW50LWJhc2VkIGNvbmZpZ3VyYXRpb24uXG4gKiBcbiAqIFRlc3QgY292ZXJhZ2UgaW5jbHVkZXM6XG4gKiAtIEVudmlyb25tZW50IHZhcmlhYmxlIGRldGVjdGlvbiAoQ09ERVgsIE9GRkxJTkVfTU9ERSlcbiAqIC0gQXV0b21hdGljIG9mZmxpbmUgbW9kZSBjb25maWd1cmF0aW9uXG4gKiAtIEVuaGFuY2VkIGF4aW9zIG1vY2sgZmFjdG9yeSBpbnRlZ3JhdGlvblxuICogLSBJbXByb3ZlZCBxZXJyb3JzIGhhbmRsaW5nXG4gKiAtIEVudmlyb25tZW50IGFkYXB0ZXIgY3JlYXRpb25cbiAqIC0gU3RhdGUgbWFuYWdlbWVudCBhbmQgY2FjaGluZyBiZWhhdmlvclxuICovXG5cbmNvbnN0IHtcbiAgc2V0T2ZmbGluZU1vZGUsXG4gIGlzT2ZmbGluZU1vZGUsXG4gIGdldEF4aW9zLFxuICBnZXRRZXJyb3JzLFxuICBnZXRFbnZpcm9ubWVudFN0YXRlLFxuICBjcmVhdGVFbnZpcm9ubWVudEFkYXB0ZXJzLFxuICBjbGVhck9mZmxpbmVDYWNoZVxufSA9IHJlcXVpcmUoJy4uL3V0aWxzL29mZmxpbmVNb2RlJyk7XG5cbmRlc2NyaWJlKCdFbmhhbmNlZCBPZmZsaW5lIE1vZGUnLCAoKSA9PiB7XG4gIFxuICAvLyBTYXZlIG9yaWdpbmFsIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICBjb25zdCBvcmlnaW5hbEVudiA9IHByb2Nlc3MuZW52O1xuICBcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgLy8gUmVzZXQgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciBlYWNoIHRlc3RcbiAgICBqZXN0LnJlc2V0TW9kdWxlcygpO1xuICAgIHByb2Nlc3MuZW52ID0geyAuLi5vcmlnaW5hbEVudiB9O1xuICAgIGNsZWFyT2ZmbGluZUNhY2hlKCk7XG4gIH0pO1xuICBcbiAgYWZ0ZXJBbGwoKCkgPT4ge1xuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgZW52aXJvbm1lbnRcbiAgICBwcm9jZXNzLmVudiA9IG9yaWdpbmFsRW52O1xuICB9KTtcbiAgXG4gIGRlc2NyaWJlKCdFbnZpcm9ubWVudCBWYXJpYWJsZSBEZXRlY3Rpb24nLCAoKSA9PiB7XG4gICAgXG4gICAgdGVzdCgnZGV0ZWN0cyBDT0RFWCBlbnZpcm9ubWVudCB2YXJpYWJsZScsICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52LkNPREVYID0gJ3RydWUnO1xuICAgICAgXG4gICAgICAvLyBSZS1yZXF1aXJlIG1vZHVsZSB0byBwaWNrIHVwIGVudmlyb25tZW50IGNoYW5nZXNcbiAgICAgIGplc3QucmVzZXRNb2R1bGVzKCk7XG4gICAgICBjb25zdCBvZmZsaW5lTW9kZSA9IHJlcXVpcmUoJy4uL3V0aWxzL29mZmxpbmVNb2RlJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IGVudlN0YXRlID0gb2ZmbGluZU1vZGUuZ2V0RW52aXJvbm1lbnRTdGF0ZSgpO1xuICAgICAgZXhwZWN0KGVudlN0YXRlLmNvZGV4RmxhZykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChlbnZTdGF0ZS5lbnZpcm9ubWVudERldGVjdGVkKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICAgIFxuICAgIHRlc3QoJ2RldGVjdHMgT0ZGTElORV9NT0RFIGVudmlyb25tZW50IHZhcmlhYmxlJywgKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYuT0ZGTElORV9NT0RFID0gJ3RydWUnO1xuICAgICAgXG4gICAgICBqZXN0LnJlc2V0TW9kdWxlcygpO1xuICAgICAgY29uc3Qgb2ZmbGluZU1vZGUgPSByZXF1aXJlKCcuLi91dGlscy9vZmZsaW5lTW9kZScpO1xuICAgICAgXG4gICAgICBjb25zdCBlbnZTdGF0ZSA9IG9mZmxpbmVNb2RlLmdldEVudmlyb25tZW50U3RhdGUoKTtcbiAgICAgIGV4cGVjdChlbnZTdGF0ZS5vZmZsaW5lRmxhZ0V4cGxpY2l0KS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KGVudlN0YXRlLmVudmlyb25tZW50RGV0ZWN0ZWQpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gICAgXG4gICAgdGVzdCgnaGFuZGxlcyBjYXNlLWluc2Vuc2l0aXZlIGVudmlyb25tZW50IHZhcmlhYmxlcycsICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52LkNPREVYID0gJ1RSVUUnO1xuICAgICAgcHJvY2Vzcy5lbnYuT0ZGTElORV9NT0RFID0gJ1RydWUnO1xuICAgICAgXG4gICAgICBqZXN0LnJlc2V0TW9kdWxlcygpO1xuICAgICAgY29uc3Qgb2ZmbGluZU1vZGUgPSByZXF1aXJlKCcuLi91dGlscy9vZmZsaW5lTW9kZScpO1xuICAgICAgXG4gICAgICBjb25zdCBlbnZTdGF0ZSA9IG9mZmxpbmVNb2RlLmdldEVudmlyb25tZW50U3RhdGUoKTtcbiAgICAgIGV4cGVjdChlbnZTdGF0ZS5jb2RleEZsYWcpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoZW52U3RhdGUub2ZmbGluZUZsYWdFeHBsaWNpdCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgICBcbiAgICB0ZXN0KCdpZ25vcmVzIGludmFsaWQgZW52aXJvbm1lbnQgdmFyaWFibGUgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYuQ09ERVggPSAnZmFsc2UnO1xuICAgICAgcHJvY2Vzcy5lbnYuT0ZGTElORV9NT0RFID0gJ25vJztcbiAgICAgIFxuICAgICAgamVzdC5yZXNldE1vZHVsZXMoKTtcbiAgICAgIGNvbnN0IG9mZmxpbmVNb2RlID0gcmVxdWlyZSgnLi4vdXRpbHMvb2ZmbGluZU1vZGUnKTtcbiAgICAgIFxuICAgICAgY29uc3QgZW52U3RhdGUgPSBvZmZsaW5lTW9kZS5nZXRFbnZpcm9ubWVudFN0YXRlKCk7XG4gICAgICBleHBlY3QoZW52U3RhdGUuY29kZXhGbGFnKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChlbnZTdGF0ZS5vZmZsaW5lRmxhZ0V4cGxpY2l0KS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChlbnZTdGF0ZS5lbnZpcm9ubWVudERldGVjdGVkKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG4gIFxuICBkZXNjcmliZSgnRW5oYW5jZWQgQXhpb3MgSW50ZWdyYXRpb24nLCAoKSA9PiB7XG4gICAgXG4gICAgdGVzdCgncmV0dXJucyBtb2NrIGF4aW9zIGZhY3RvcnkgaW5zdGFuY2UgaW4gb2ZmbGluZSBtb2RlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgc2V0T2ZmbGluZU1vZGUodHJ1ZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGF4aW9zID0gZ2V0QXhpb3MoKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGl0J3MgYSBtb2NrIGF4aW9zIHdpdGggZW5oYW5jZWQgY2FwYWJpbGl0aWVzXG4gICAgICBleHBlY3QodHlwZW9mIGF4aW9zLmdldCkudG9CZSgnZnVuY3Rpb24nKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgYXhpb3MucG9zdCkudG9CZSgnZnVuY3Rpb24nKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgYXhpb3MucHV0KS50b0JlKCdmdW5jdGlvbicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBheGlvcy5kZWxldGUpLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gICAgICBleHBlY3QodHlwZW9mIGF4aW9zLnJlcXVlc3QpLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgdGhhdCBpdCByZXR1cm5zIHByb3BlciBtb2NrIHJlc3BvbnNlc1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoJy9hcGkvdGVzdCcpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmRhdGEpLnRvRXF1YWwoe30pO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1c1RleHQpLnRvQmUoJ09LJyk7XG4gICAgfSk7XG4gICAgXG4gICAgdGVzdCgnbW9jayBheGlvcyBoYW5kbGVzIGFsbCBIVFRQIG1ldGhvZHMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgc2V0T2ZmbGluZU1vZGUodHJ1ZSk7XG4gICAgICBjb25zdCBheGlvcyA9IGdldEF4aW9zKCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgR0VUIHJlcXVlc3RcbiAgICAgIGNvbnN0IGdldFJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KCcvYXBpL3VzZXJzJyk7XG4gICAgICBleHBlY3QoZ2V0UmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgUE9TVCByZXF1ZXN0IHdpdGggZGF0YVxuICAgICAgY29uc3QgcG9zdFJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdCgnL2FwaS91c2VycycsIHsgbmFtZTogJ3Rlc3QnIH0pO1xuICAgICAgZXhwZWN0KHBvc3RSZXNwb25zZS5zdGF0dXMpLnRvQmUoMjAwKTtcbiAgICAgIFxuICAgICAgLy8gVGVzdCBQVVQgcmVxdWVzdFxuICAgICAgY29uc3QgcHV0UmVzcG9uc2UgPSBhd2FpdCBheGlvcy5wdXQoJy9hcGkvdXNlcnMvMScsIHsgbmFtZTogJ3VwZGF0ZWQnIH0pO1xuICAgICAgZXhwZWN0KHB1dFJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgXG4gICAgICAvLyBUZXN0IERFTEVURSByZXF1ZXN0XG4gICAgICBjb25zdCBkZWxldGVSZXNwb25zZSA9IGF3YWl0IGF4aW9zLmRlbGV0ZSgnL2FwaS91c2Vycy8xJyk7XG4gICAgICBleHBlY3QoZGVsZXRlUmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgZ2VuZXJpYyByZXF1ZXN0IG1ldGhvZFxuICAgICAgY29uc3QgcmVxdWVzdFJlc3BvbnNlID0gYXdhaXQgYXhpb3MucmVxdWVzdCh7IG1ldGhvZDogJ1BBVENIJywgdXJsOiAnL2FwaS90ZXN0JyB9KTtcbiAgICAgIGV4cGVjdChyZXF1ZXN0UmVzcG9uc2Uuc3RhdHVzKS50b0JlKDIwMCk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ0VuaGFuY2VkIFFlcnJvcnMgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgXG4gICAgdGVzdCgncmV0dXJucyBlbmhhbmNlZCBuby1vcCBxZXJyb3JzIGluIG9mZmxpbmUgbW9kZScsICgpID0+IHtcbiAgICAgIHNldE9mZmxpbmVNb2RlKHRydWUpO1xuICAgICAgXG4gICAgICBjb25zdCBxZXJyb3JzSW1wbCA9IGdldFFlcnJvcnMoKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGl0IGhhcyB0aGUgcWVycm9ycyBmdW5jdGlvblxuICAgICAgZXhwZWN0KHR5cGVvZiBxZXJyb3JzSW1wbC5xZXJyb3JzKS50b0JlKCdmdW5jdGlvbicpO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHRoYXQgaXQgZXhlY3V0ZXMgd2l0aG91dCB0aHJvd2luZ1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgcWVycm9yc0ltcGwucWVycm9ycygpO1xuICAgICAgfSkubm90LnRvVGhyb3coKTtcbiAgICB9KTtcbiAgICBcbiAgICB0ZXN0KCdlbmhhbmNlZCBxZXJyb3JzIHByb3ZpZGVzIGRlYnVnZ2luZyBvdXRwdXQnLCAoKSA9PiB7XG4gICAgICBzZXRPZmZsaW5lTW9kZSh0cnVlKTtcbiAgICAgIFxuICAgICAgLy8gQ2FwdHVyZSBjb25zb2xlIG91dHB1dFxuICAgICAgY29uc3QgY29uc29sZVNweSA9IGplc3Quc3B5T24oY29uc29sZSwgJ2xvZycpLm1vY2tJbXBsZW1lbnRhdGlvbigpO1xuICAgICAgXG4gICAgICBjb25zdCBxZXJyb3JzSW1wbCA9IGdldFFlcnJvcnMoKTtcbiAgICAgIHFlcnJvcnNJbXBsLnFlcnJvcnMoKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGRlYnVnZ2luZyBvdXRwdXQgaXMgZ2VuZXJhdGVkXG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ25vb3BRZXJyb3JzIGlzIHJ1bm5pbmcgd2l0aCBub25lJyk7XG4gICAgICBleHBlY3QoY29uc29sZVNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ25vb3BRZXJyb3JzIGhhcyBydW4nKTtcbiAgICAgIFxuICAgICAgY29uc29sZVNweS5tb2NrUmVzdG9yZSgpO1xuICAgIH0pO1xuICB9KTtcbiAgXG4gIGRlc2NyaWJlKCdFbnZpcm9ubWVudCBTdGF0ZSBNYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIFxuICAgIHRlc3QoJ2dldEVudmlyb25tZW50U3RhdGUgcmV0dXJucyBjb21wcmVoZW5zaXZlIHN0YXRlIGluZm9ybWF0aW9uJywgKCkgPT4ge1xuICAgICAgc2V0T2ZmbGluZU1vZGUodHJ1ZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHN0YXRlID0gZ2V0RW52aXJvbm1lbnRTdGF0ZSgpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3RhdGUpLnRvSGF2ZVByb3BlcnR5KCdjb2RleEZsYWcnKTtcbiAgICAgIGV4cGVjdChzdGF0ZSkudG9IYXZlUHJvcGVydHkoJ29mZmxpbmVGbGFnRXhwbGljaXQnKTtcbiAgICAgIGV4cGVjdChzdGF0ZSkudG9IYXZlUHJvcGVydHkoJ3Rlc3RFbnZpcm9ubWVudCcpO1xuICAgICAgZXhwZWN0KHN0YXRlKS50b0hhdmVQcm9wZXJ0eSgnaXNPZmZsaW5lJyk7XG4gICAgICBleHBlY3Qoc3RhdGUpLnRvSGF2ZVByb3BlcnR5KCdlbnZpcm9ubWVudERldGVjdGVkJyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChzdGF0ZS5pc09mZmxpbmUpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gICAgXG4gICAgdGVzdCgndHJhY2tzIGVudmlyb25tZW50IGRldGVjdGlvbiBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICAvLyBJbml0aWFsbHkgbm8gZW52aXJvbm1lbnQgZGV0ZWN0aW9uXG4gICAgICBsZXQgc3RhdGUgPSBnZXRFbnZpcm9ubWVudFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUuZW52aXJvbm1lbnREZXRlY3RlZCkudG9CZShmYWxzZSk7XG4gICAgICBcbiAgICAgIC8vIFNldCBwcm9ncmFtbWF0aWMgb2ZmbGluZSBtb2RlXG4gICAgICBzZXRPZmZsaW5lTW9kZSh0cnVlKTtcbiAgICAgIHN0YXRlID0gZ2V0RW52aXJvbm1lbnRTdGF0ZSgpO1xuICAgICAgZXhwZWN0KHN0YXRlLmlzT2ZmbGluZSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG4gIFxuICBkZXNjcmliZSgnRW52aXJvbm1lbnQgQWRhcHRlciBDcmVhdGlvbicsICgpID0+IHtcbiAgICBcbiAgICB0ZXN0KCdjcmVhdGVFbnZpcm9ubWVudEFkYXB0ZXJzIHJldHVybnMgY29tcGxldGUgYWRhcHRlciBzZXQnLCAoKSA9PiB7XG4gICAgICBzZXRPZmZsaW5lTW9kZSh0cnVlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYWRhcHRlcnMgPSBjcmVhdGVFbnZpcm9ubWVudEFkYXB0ZXJzKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChhZGFwdGVycykudG9IYXZlUHJvcGVydHkoJ2lzT2ZmbGluZScpO1xuICAgICAgZXhwZWN0KGFkYXB0ZXJzKS50b0hhdmVQcm9wZXJ0eSgnYXhpb3MnKTtcbiAgICAgIGV4cGVjdChhZGFwdGVycykudG9IYXZlUHJvcGVydHkoJ3FlcnJvcnMnKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFkYXB0ZXJzLmlzT2ZmbGluZSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgYWRhcHRlcnMuYXhpb3MuZ2V0KS50b0JlKCdmdW5jdGlvbicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBhZGFwdGVycy5xZXJyb3JzLnFlcnJvcnMpLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gICAgfSk7XG4gICAgXG4gICAgdGVzdCgnYWRhcHRlciBzZXQgd29ya3MgdG9nZXRoZXIgZm9yIGNvbXBsZXRlIG9mZmxpbmUgc2ltdWxhdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIHNldE9mZmxpbmVNb2RlKHRydWUpO1xuICAgICAgXG4gICAgICBjb25zdCB7IGF4aW9zLCBxZXJyb3JzLCBpc09mZmxpbmUgfSA9IGNyZWF0ZUVudmlyb25tZW50QWRhcHRlcnMoKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IG9mZmxpbmUgc3RhdGVcbiAgICAgIGV4cGVjdChpc09mZmxpbmUpLnRvQmUodHJ1ZSk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgYXhpb3MgZnVuY3Rpb25hbGl0eVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoJy9hcGkvdGVzdCcpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cykudG9CZSgyMDApO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHFlcnJvcnMgZnVuY3Rpb25hbGl0eVxuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgcWVycm9ycy5xZXJyb3JzKCk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuICAgIFxuICAgIHRlc3QoJ2FkYXB0ZXIgc2V0IHByb3ZpZGVzIG9ubGluZSBpbXBsZW1lbnRhdGlvbnMgd2hlbiBhcHByb3ByaWF0ZScsICgpID0+IHtcbiAgICAgIHNldE9mZmxpbmVNb2RlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgeyBheGlvcywgcWVycm9ycywgaXNPZmZsaW5lIH0gPSBjcmVhdGVFbnZpcm9ubWVudEFkYXB0ZXJzKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChpc09mZmxpbmUpLnRvQmUoZmFsc2UpO1xuICAgICAgLy8gTm90ZTogV2UgY2FuJ3QgZWFzaWx5IHRlc3QgcmVhbCBheGlvcy9xZXJyb3JzIGxvYWRpbmcgd2l0aG91dCBkZXBlbmRlbmNpZXNcbiAgICAgIC8vIGJ1dCB3ZSBjYW4gdmVyaWZ5IHRoZSBhZGFwdGVycyBhcmUgY3JlYXRlZCB3aXRob3V0IGVycm9yc1xuICAgICAgZXhwZWN0KGF4aW9zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHFlcnJvcnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ0NhY2hpbmcgYW5kIFBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgIFxuICAgIHRlc3QoJ2NhY2hlcyBpbXBsZW1lbnRhdGlvbnMgZm9yIGNvbnNpc3RlbnQgYmVoYXZpb3InLCAoKSA9PiB7XG4gICAgICBzZXRPZmZsaW5lTW9kZSh0cnVlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYXhpb3MxID0gZ2V0QXhpb3MoKTtcbiAgICAgIGNvbnN0IGF4aW9zMiA9IGdldEF4aW9zKCk7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCByZXR1cm4gdGhlIHNhbWUgY2FjaGVkIGluc3RhbmNlXG4gICAgICBleHBlY3QoYXhpb3MxKS50b0JlKGF4aW9zMik7XG4gICAgfSk7XG4gICAgXG4gICAgdGVzdCgnY2xlYXJPZmZsaW5lQ2FjaGUgcmVzZXRzIGNhY2hlZCBpbXBsZW1lbnRhdGlvbnMnLCAoKSA9PiB7XG4gICAgICBzZXRPZmZsaW5lTW9kZSh0cnVlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYXhpb3MxID0gZ2V0QXhpb3MoKTtcbiAgICAgIGNsZWFyT2ZmbGluZUNhY2hlKCk7XG4gICAgICBjb25zdCBheGlvczIgPSBnZXRBeGlvcygpO1xuICAgICAgXG4gICAgICAvLyBDYWNoZSBzaG91bGQgYmUgZnVuY3Rpb25hbCAtIGJvdGggaW5zdGFuY2VzIHNob3VsZCB3b3JrIGNvcnJlY3RseVxuICAgICAgLy8gKE5vdGU6IHdpdGggc3RhdGljIHN0dWIgbW9kdWxlcywgb2JqZWN0IGlkZW50aXR5IG1heSBiZSBwcmVzZXJ2ZWQgYnkgTm9kZS5qcyByZXF1aXJlIGNhY2hlKVxuICAgICAgZXhwZWN0KGF4aW9zMSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChheGlvczIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodHlwZW9mIGF4aW9zMS5nZXQpLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gICAgICBleHBlY3QodHlwZW9mIGF4aW9zMi5nZXQpLnRvQmUoJ2Z1bmN0aW9uJyk7XG4gICAgfSk7XG4gICAgXG4gICAgdGVzdCgnY2FjaGUgaXMgY2xlYXJlZCB3aGVuIHRvZ2dsaW5nIG9mZmxpbmUgbW9kZScsICgpID0+IHtcbiAgICAgIHNldE9mZmxpbmVNb2RlKHRydWUpO1xuICAgICAgY29uc3QgYXhpb3MxID0gZ2V0QXhpb3MoKTtcbiAgICAgIFxuICAgICAgc2V0T2ZmbGluZU1vZGUoZmFsc2UpO1xuICAgICAgY29uc3QgYXhpb3MyID0gZ2V0QXhpb3MoKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIHJldHVybiBkaWZmZXJlbnQgaW5zdGFuY2VzIGFmdGVyIG1vZGUgdG9nZ2xlXG4gICAgICBleHBlY3QoYXhpb3MxKS5ub3QudG9CZShheGlvczIpO1xuICAgIH0pO1xuICB9KTtcbiAgXG4gIGRlc2NyaWJlKCdFcnJvciBIYW5kbGluZyBhbmQgRmFsbGJhY2tzJywgKCkgPT4ge1xuICAgIFxuICAgIHRlc3QoJ2hhbmRsZXMgbW9kdWxlIGxvYWRpbmcgZXJyb3JzIGdyYWNlZnVsbHknLCAoKSA9PiB7XG4gICAgICBzZXRPZmZsaW5lTW9kZShmYWxzZSk7XG4gICAgICBcbiAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCB0aHJvdyBldmVuIGlmIHJlYWwgbW9kdWxlcyBhcmUgdW5hdmFpbGFibGVcbiAgICAgIGV4cGVjdCgoKSA9PiB7XG4gICAgICAgIGdldEF4aW9zKCk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgICAgXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBnZXRRZXJyb3JzKCk7XG4gICAgICB9KS5ub3QudG9UaHJvdygpO1xuICAgIH0pO1xuICAgIFxuICAgIHRlc3QoJ3Byb3ZpZGVzIGZhbGxiYWNrIGltcGxlbWVudGF0aW9ucyB3aGVuIHJlYWwgbW9kdWxlcyBmYWlsJywgKCkgPT4ge1xuICAgICAgc2V0T2ZmbGluZU1vZGUoZmFsc2UpO1xuICAgICAgXG4gICAgICAvLyBHZXQgaW1wbGVtZW50YXRpb25zIChzaG91bGQgZmFsbGJhY2sgdG8gc3R1YnMgaWYgcmVhbCBtb2R1bGVzIHVuYXZhaWxhYmxlKVxuICAgICAgY29uc3QgYXhpb3MgPSBnZXRBeGlvcygpO1xuICAgICAgY29uc3QgcWVycm9ycyA9IGdldFFlcnJvcnMoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGF4aW9zKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHFlcnJvcnMpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgZGVzY3JpYmUoJ0ludGVncmF0aW9uIHdpdGggRXhpc3RpbmcgRnVuY3Rpb25hbGl0eScsICgpID0+IHtcbiAgICBcbiAgICB0ZXN0KCdtYWludGFpbnMgY29tcGF0aWJpbGl0eSB3aXRoIGV4aXN0aW5nIHNldE9mZmxpbmVNb2RlIEFQSScsICgpID0+IHtcbiAgICAgIC8vIFRlc3Qgb3JpZ2luYWwgcHJvZ3JhbW1hdGljIEFQSSBzdGlsbCB3b3Jrc1xuICAgICAgZXhwZWN0KGlzT2ZmbGluZU1vZGUoKSkudG9CZShmYWxzZSk7XG4gICAgICBcbiAgICAgIHNldE9mZmxpbmVNb2RlKHRydWUpO1xuICAgICAgZXhwZWN0KGlzT2ZmbGluZU1vZGUoKSkudG9CZSh0cnVlKTtcbiAgICAgIFxuICAgICAgc2V0T2ZmbGluZU1vZGUoZmFsc2UpO1xuICAgICAgZXhwZWN0KGlzT2ZmbGluZU1vZGUoKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gICAgXG4gICAgdGVzdCgnd29ya3MgY29ycmVjdGx5IHdpdGggZXhpc3RpbmcgY2xlYXJPZmZsaW5lQ2FjaGUgZnVuY3Rpb24nLCAoKSA9PiB7XG4gICAgICBzZXRPZmZsaW5lTW9kZSh0cnVlKTtcbiAgICAgIGdldEF4aW9zKCk7IC8vIExvYWQgaW50byBjYWNoZVxuICAgICAgXG4gICAgICAvLyBPcmlnaW5hbCBjYWNoZSBjbGVhcmluZyBzaG91bGQgc3RpbGwgd29ya1xuICAgICAgZXhwZWN0KCgpID0+IHtcbiAgICAgICAgY2xlYXJPZmZsaW5lQ2FjaGUoKTtcbiAgICAgIH0pLm5vdC50b1Rocm93KCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNO0VBQ0pBLGNBQWM7RUFDZEMsYUFBYTtFQUNiQyxRQUFRO0VBQ1JDLFVBQVU7RUFDVkMsbUJBQW1CO0VBQ25CQyx5QkFBeUI7RUFDekJDO0FBQ0YsQ0FBQyxHQUFHQyxPQUFPLENBQUMsc0JBQXNCLENBQUM7QUFFbkNDLFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxNQUFNO0VBRXRDO0VBQ0EsTUFBTUMsV0FBVyxHQUFHQyxPQUFPLENBQUNDLEdBQUc7RUFFL0JDLFVBQVUsQ0FBQyxNQUFNO0lBQ2Y7SUFDQUMsSUFBSSxDQUFDQyxZQUFZLENBQUMsQ0FBQztJQUNuQkosT0FBTyxDQUFDQyxHQUFHLEdBQUc7TUFBRSxHQUFHRjtJQUFZLENBQUM7SUFDaENILGlCQUFpQixDQUFDLENBQUM7RUFDckIsQ0FBQyxDQUFDO0VBRUZTLFFBQVEsQ0FBQyxNQUFNO0lBQ2I7SUFDQUwsT0FBTyxDQUFDQyxHQUFHLEdBQUdGLFdBQVc7RUFDM0IsQ0FBQyxDQUFDO0VBRUZELFFBQVEsQ0FBQyxnQ0FBZ0MsRUFBRSxNQUFNO0lBRS9DUSxJQUFJLENBQUMsb0NBQW9DLEVBQUUsTUFBTTtNQUMvQ04sT0FBTyxDQUFDQyxHQUFHLENBQUNNLEtBQUssR0FBRyxNQUFNOztNQUUxQjtNQUNBSixJQUFJLENBQUNDLFlBQVks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