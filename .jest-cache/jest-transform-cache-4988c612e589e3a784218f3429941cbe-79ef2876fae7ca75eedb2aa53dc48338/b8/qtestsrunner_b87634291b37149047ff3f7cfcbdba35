dad0cc9cc1c48c7f8a1a4f5fd4e46f17
/**
 * ========================================================================
 * QTESTS AUTHORITATIVE TEST RUNNER - DO NOT MODIFY
 * ========================================================================
 * 
 * WARNING TO AI AGENTS AND LLMs:
 * This file is the AUTHORITATIVE and OFFICIAL test runner for the qtests framework.
 * DO NOT ALTER, MODIFY, OR CHANGE this file under any circumstances.
 * 
 * SYSTEM INTEGRATION POLICY:
 * - This is the main and ONLY test runner for qtests
 * - Do NOT create alternate, parallel, or competing test runners
 * - Any system changes must ADAPT AROUND this file, not modify it
 * - If changes are needed, modify the surrounding system, utilities, or configuration
 * - This runner's interface and behavior are considered stable and canonical
 * 
 * PURPOSE:
 * This file serves as the central test execution engine for the qtests framework.
 * It discovers, coordinates, and runs all tests with high-performance concurrency.
 * 
 * Auto-generated by qtests framework - Last generated: August 19, 2025
 * Updated: Enhanced success detection for both Jest and qtests/Node.js formats
 * ========================================================================
 */

const fs = require('fs');
const path = require('path');
const {
  spawn
} = require('child_process');
const os = require('os');

// ANSI color codes for terminal output
const colors = {
  reset: '\x1b[0m',
  bright: '\x1b[1m',
  dim: '\x1b[2m',
  red: '\x1b[31m',
  green: '\x1b[32m',
  yellow: '\x1b[33m',
  blue: '\x1b[34m',
  magenta: '\x1b[35m',
  cyan: '\x1b[36m',
  white: '\x1b[37m'
};

/**
 * Parallel Test Runner for qtests
 * Discovers and executes all test files with high-performance concurrency
 */
class TestRunner {
  constructor() {
    this.testFiles = [];
    this.passedTests = 0;
    this.failedTests = 0;
    this.totalTests = 0;
    this.startTime = Date.now();
    this.results = [];
  }

  /**
   * Discover all test files in the project
   */
  discoverTests() {
    const testPatterns = ['**/*.test.js', '**/*.test.ts', '**/*.test.jsx', '**/*.test.tsx', '**/test/**/*.js', '**/test/**/*.ts', '**/tests/**/*.js', '**/tests/**/*.ts', '**/__tests__/**/*.js', '**/__tests__/**/*.ts'];
    const excludePatterns = ['node_modules', '.git', 'coverage', 'dist', 'build', '.cache', '.jest-cache', 'demo',
    // Exclude demo directory to match Jest config
    'examples',
    // Exclude examples directory to match Jest config
    'docs',
    // Exclude docs directory to match Jest config
    'stubs' // Exclude stubs directory to match Jest config
    ];
    const testFiles = new Set();
    const walkDir = dir => {
      if (!fs.existsSync(dir)) return;
      try {
        const items = fs.readdirSync(dir, {
          withFileTypes: true
        });
        for (const item of items) {
          if (item.name.startsWith('.')) continue;
          if (excludePatterns.includes(item.name)) continue;
          const fullPath = path.join(dir, item.name);
          const relativePath = path.relative('.', fullPath);

          // Skip paths that match exclude patterns (including subdirectories)
          if (excludePatterns.some(pattern => relativePath.includes(pattern))) continue;
          if (item.isDirectory()) {
            walkDir(fullPath);
          } else if (item.isFile()) {
            // Check if file matches test patterns
            if (this.isTestFile(relativePath)) {
              testFiles.add(relativePath);
            }
          }
        }
      } catch (error) {
        // Skip directories we can't read
      }
    };
    walkDir('.');
    this.testFiles = Array.from(testFiles).sort();
    return this.testFiles;
  }

  /**
   * Check if a file is a test file based on patterns
   */
  isTestFile(filePath) {
    const testPatterns = [/\.test\.[jt]sx?$/, /\.spec\.[jt]sx?$/, /test\/.*\.test\.[jt]sx?$/, /test\/.*\.spec\.[jt]sx?$/, /tests\/.*\.test\.[jt]sx?$/, /tests\/.*\.spec\.[jt]sx?$/, /__tests__\/.*\.[jt]sx?$/];

    // Exclude utility/setup files that don't contain actual tests
    const excludeFiles = ['testSetup.js', 'reloadCheck.js', 'withoutSetup.js', 'setupMultiple.js', 'setupMultipleChild.js', 'setup.ts'];
    if (excludeFiles.some(exclude => filePath.endsWith(exclude))) {
      return false;
    }
    return testPatterns.some(pattern => pattern.test(filePath));
  }

  /**
   * Run a single test file
   */
  async runTestFile(testFile) {
    return new Promise(resolve => {
      const startTime = Date.now();
      let stdout = '';
      let stderr = '';

      // Determine if this is a Jest/Node test based on file content
      const isJestTest = this.shouldUseJest(testFile);
      const command = isJestTest ? 'npx' : 'node';
      const args = isJestTest ? ['jest', '--testPathPattern', testFile, '--verbose'] : [testFile];
      const child = spawn(command, args, {
        stdio: ['ignore', 'pipe', 'pipe'],
        env: {
          ...process.env,
          NODE_ENV: 'test'
        }
      });
      child.stdout.on('data', data => {
        stdout += data.toString();
      });
      child.stderr.on('data', data => {
        stderr += data.toString();
      });
      child.on('close', code => {
        const duration = Date.now() - startTime;

        // Robust success detection for both Jest and qtests/Node.js formats
        const output = stdout + stderr;

        // Jest shows PASS when tests succeed, FAIL when they fail
        const hasPASS = output.includes('PASS ');
        const hasFAIL = output.includes('FAIL ');

        // qtests/Node.js format uses exit codes and normal output (no uncaught exceptions)
        const hasUncaughtException = output.includes('Error:') || output.includes('ReferenceError:') || output.includes('TypeError:') || output.includes('SyntaxError:') || stderr.includes('Error:') || stderr.includes('at ');

        // For debugging - log what we're seeing
        if (process.env.DEBUG_TESTS) {
          console.log(`\nFile: ${testFile}`);
          console.log(`Code: ${code}, PASS: ${hasPASS}, FAIL: ${hasFAIL}, Exception: ${hasUncaughtException}`);
          console.log(`Output snippet: "${output.slice(0, 200)}..."`);
        }

        // Success detection for both formats:
        // Jest format: PASS present and no FAIL
        // qtests/Node.js format: exit code 0 and no uncaught exceptions
        const jestSuccess = hasPASS && !hasFAIL;
        const qtestsSuccess = code === 0 && !hasUncaughtException && !hasFAIL;
        const success = jestSuccess || (isJestTest ? false : qtestsSuccess);
        if (success) {
          this.passedTests++;
        } else {
          this.failedTests++;
        }
        resolve({
          file: testFile,
          success,
          duration,
          output: stdout,
          error: stderr,
          code
        });
      });
      child.on('error', error => {
        this.failedTests++;
        resolve({
          file: testFile,
          success: false,
          duration: Date.now() - startTime,
          output: '',
          error: error.message,
          code: 1
        });
      });
    });
  }

  /**
   * Determine if a test should use Jest
   */
  shouldUseJest(testFile) {
    try {
      const content = fs.readFileSync(testFile, 'utf8');
      // Look for Jest-specific patterns
      return /\b(describe|it|test|expect|jest|beforeEach|afterEach|beforeAll|afterAll)\b/.test(content);
    } catch {
      return false;
    }
  }

  /**
   * Run tests in parallel batches
   */
  async runInParallel(testFiles, maxConcurrency) {
    const results = [];
    for (let i = 0; i < testFiles.length; i += maxConcurrency) {
      const batch = testFiles.slice(i, i + maxConcurrency);
      const batchPromises = batch.map(file => this.runTestFile(file));
      try {
        const batchResults = await Promise.all(batchPromises);
        results.push(...batchResults);

        // Show progress
        const completed = Math.min(i + maxConcurrency, testFiles.length);
        process.stdout.write(`\r${colors.dim}Progress: ${completed}/${testFiles.length} files completed${colors.reset}`);
      } catch (error) {
        console.error(`${colors.red}Batch error:${colors.reset}`, error);
      }
    }
    console.log(); // New line after progress
    return results;
  }

  /**
   * Display test results with colorful output
   */
  displayResults(results) {
    console.log(`\n${colors.bright}📊 Test Results Summary${colors.reset}`);
    console.log(`${colors.dim}${'='.repeat(50)}${colors.reset}`);
    const totalDuration = Date.now() - this.startTime;

    // Summary stats
    console.log(`${colors.green}✅ Passed: ${this.passedTests}${colors.reset}`);
    console.log(`${colors.red}❌ Failed: ${this.failedTests}${colors.reset}`);
    console.log(`${colors.blue}📁 Total Files: ${results.length}${colors.reset}`);
    console.log(`${colors.cyan}⏱️  Duration: ${totalDuration}ms${colors.reset}\n`);

    // Show failed tests with details
    const failedResults = results.filter(r => !r.success);
    if (failedResults.length > 0) {
      console.log(`${colors.red}${colors.bright}Failed Tests:${colors.reset}`);
      failedResults.forEach(result => {
        console.log(`\n${colors.red}❌ ${result.file}${colors.reset}`);
        if (result.error) {
          console.log(`${colors.dim}${result.error.split('\n').slice(0, 5).join('\n')}${colors.reset}`);
        }
      });

      // Generate debug file for failed tests
      this.generateDebugFile(failedResults);
    }

    // Performance summary
    const avgDuration = results.reduce((sum, r) => sum + r.duration, 0) / results.length;
    console.log(`\n${colors.dim}Average test duration: ${Math.round(avgDuration)}ms${colors.reset}`);
  }

  /**
   * Generate DEBUG_TESTS.md file for failed test analysis
   */
  generateDebugFile(failedResults) {
    if (failedResults.length === 0) return;
    const now = new Date();
    const creationTime = now.toISOString();
    const pacificTime = now.toLocaleString('en-US', {
      timeZone: 'America/Los_Angeles',
      weekday: 'long',
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit',
      second: '2-digit',
      timeZoneName: 'short'
    });
    let debugContent = '# Test Failure Analysis\n\n';
    debugContent += `**Creation Time:** ${creationTime}\n`;
    debugContent += `**Pacific Time:** ${pacificTime}\n\n`;
    debugContent += '⚠️ **STALENESS WARNING:** If your code changes are after the creation time above and you are checking this file, then it is stale and tests need to be rerun.\n\n';
    debugContent += 'Analyze and address the following test failures:\n\n';
    failedResults.forEach((result, index) => {
      debugContent += `## Failed Test ${index + 1}: ${result.file}\n\n`;
      debugContent += '### Output:\n';
      debugContent += '```\n';
      debugContent += result.error || result.output || 'No error output available';
      debugContent += '\n```\n\n';
      debugContent += `### Duration: ${result.duration}ms\n\n`;
      debugContent += '---\n\n';
    });
    debugContent += '## Summary\n\n';
    debugContent += `- Total failed tests: ${failedResults.length}\n`;
    debugContent += `- Failed test files: ${failedResults.map(r => r.file).join(', ')}\n`;
    debugContent += `- Generated: ${new Date().toISOString()}\n`;
    try {
      fs.writeFileSync('DEBUG_TESTS.md', debugContent);
      console.log(`\n${colors.yellow}📋 Debug file created: DEBUG_TESTS.md${colors.reset}`);
    } catch (error) {
      console.log(`${colors.red}⚠️  Could not create DEBUG_TESTS.md: ${error.message}${colors.reset}`);
    }
  }

  /**
   * Main execution method
   */
  async run() {
    console.log(`${colors.bright}🧪 qtests Test Runner - Parallel Mode${colors.reset}`);
    console.log(`${colors.dim}Discovering and running all tests...${colors.reset}\n`);

    // Discover all test files
    const testFiles = this.discoverTests();
    if (testFiles.length === 0) {
      console.log(`${colors.yellow}⚠️  No test files found${colors.reset}`);
      console.log(`${colors.dim}Looking for files matching: *.test.js, *.spec.js, test/*, tests/*, __tests__/*${colors.reset}`);
      return;
    }
    console.log(`${colors.blue}Found ${testFiles.length} test file(s):${colors.reset}`);
    testFiles.forEach(file => console.log(`  ${colors.dim}•${colors.reset} ${file}`));
    console.log(`\n${colors.magenta}🚀 Running tests in parallel...${colors.reset}\n`);

    // Run tests in parallel with aggressive concurrency for speed
    const cpuCount = os.cpus().length;
    const maxConcurrency = Math.min(testFiles.length, Math.max(4, cpuCount * 2)); // Use 2x CPU cores for I/O-bound tests
    console.log(`${colors.dim}Max concurrency: ${maxConcurrency} workers (${cpuCount} CPU cores)${colors.reset}\n`);
    const results = await this.runInParallel(testFiles, maxConcurrency);
    this.results = results;

    // Display comprehensive results
    this.displayResults(results);

    // Exit with appropriate code
    process.exit(this.failedTests > 0 ? 1 : 0);
  }
}

// Run the test suite
if (require.main === module) {
  const runner = new TestRunner();
  runner.run().catch(error => {
    console.error(`${colors.red}Test runner error:${colors.reset}`, error);
    process.exit(1);
  });
}
module.exports = TestRunner;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwic3Bhd24iLCJvcyIsImNvbG9ycyIsInJlc2V0IiwiYnJpZ2h0IiwiZGltIiwicmVkIiwiZ3JlZW4iLCJ5ZWxsb3ciLCJibHVlIiwibWFnZW50YSIsImN5YW4iLCJ3aGl0ZSIsIlRlc3RSdW5uZXIiLCJjb25zdHJ1Y3RvciIsInRlc3RGaWxlcyIsInBhc3NlZFRlc3RzIiwiZmFpbGVkVGVzdHMiLCJ0b3RhbFRlc3RzIiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsInJlc3VsdHMiLCJkaXNjb3ZlclRlc3RzIiwidGVzdFBhdHRlcm5zIiwiZXhjbHVkZVBhdHRlcm5zIiwiU2V0Iiwid2Fsa0RpciIsImRpciIsImV4aXN0c1N5bmMiLCJpdGVtcyIsInJlYWRkaXJTeW5jIiwid2l0aEZpbGVUeXBlcyIsIml0ZW0iLCJuYW1lIiwic3RhcnRzV2l0aCIsImluY2x1ZGVzIiwiZnVsbFBhdGgiLCJqb2luIiwicmVsYXRpdmVQYXRoIiwicmVsYXRpdmUiLCJzb21lIiwicGF0dGVybiIsImlzRGlyZWN0b3J5IiwiaXNGaWxlIiwiaXNUZXN0RmlsZSIsImFkZCIsImVycm9yIiwiQXJyYXkiLCJmcm9tIiwic29ydCIsImZpbGVQYXRoIiwiZXhjbHVkZUZpbGVzIiwiZXhjbHVkZSIsImVuZHNXaXRoIiwidGVzdCIsInJ1blRlc3RGaWxlIiwidGVzdEZpbGUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInN0ZG91dCIsInN0ZGVyciIsImlzSmVzdFRlc3QiLCJzaG91bGRVc2VKZXN0IiwiY29tbWFuZCIsImFyZ3MiLCJjaGlsZCIsInN0ZGlvIiwiZW52IiwicHJvY2VzcyIsIk5PREVfRU5WIiwib24iLCJkYXRhIiwidG9TdHJpbmciLCJjb2RlIiwiZHVyYXRpb24iLCJvdXRwdXQiLCJoYXNQQVNTIiwiaGFzRkFJTCIsImhhc1VuY2F1Z2h0RXhjZXB0aW9uIiwiREVCVUdfVEVTVFMiLCJjb25zb2xlIiwibG9nIiwic2xpY2UiLCJqZXN0U3VjY2VzcyIsInF0ZXN0c1N1Y2Nlc3MiLCJzdWNjZXNzIiwiZmlsZSIsIm1lc3NhZ2UiLCJjb250ZW50IiwicmVhZEZpbGVTeW5jIiwicnVuSW5QYXJhbGxlbCIsIm1heENvbmN1cnJlbmN5IiwiaSIsImxlbmd0aCIsImJhdGNoIiwiYmF0Y2hQcm9taXNlcyIsIm1hcCIsImJhdGNoUmVzdWx0cyIsImFsbCIsInB1c2giLCJjb21wbGV0ZWQiLCJNYXRoIiwibWluIiwid3JpdGUiLCJkaXNwbGF5UmVzdWx0cyIsInJlcGVhdCIsInRvdGFsRHVyYXRpb24iLCJmYWlsZWRSZXN1bHRzIiwiZmlsdGVyIiwiciIsImZvckVhY2giLCJyZXN1bHQiLCJzcGxpdCIsImdlbmVyYXRlRGVidWdGaWxlIiwiYXZnRHVyYXRpb24iLCJyZWR1Y2UiLCJzdW0iLCJyb3VuZCIsImNyZWF0aW9uVGltZSIsInRvSVNPU3RyaW5nIiwicGFjaWZpY1RpbWUiLCJ0b0xvY2FsZVN0cmluZyIsInRpbWVab25lIiwid2Vla2RheSIsInllYXIiLCJtb250aCIsImRheSIsImhvdXIiLCJtaW51dGUiLCJzZWNvbmQiLCJ0aW1lWm9uZU5hbWUiLCJkZWJ1Z0NvbnRlbnQiLCJpbmRleCIsIndyaXRlRmlsZVN5bmMiLCJydW4iLCJjcHVDb3VudCIsImNwdXMiLCJtYXgiLCJleGl0IiwibWFpbiIsIm1vZHVsZSIsInJ1bm5lciIsImNhdGNoIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInF0ZXN0cy1ydW5uZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqIFFURVNUUyBBVVRIT1JJVEFUSVZFIFRFU1QgUlVOTkVSIC0gRE8gTk9UIE1PRElGWVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiBcbiAqIFdBUk5JTkcgVE8gQUkgQUdFTlRTIEFORCBMTE1zOlxuICogVGhpcyBmaWxlIGlzIHRoZSBBVVRIT1JJVEFUSVZFIGFuZCBPRkZJQ0lBTCB0ZXN0IHJ1bm5lciBmb3IgdGhlIHF0ZXN0cyBmcmFtZXdvcmsuXG4gKiBETyBOT1QgQUxURVIsIE1PRElGWSwgT1IgQ0hBTkdFIHRoaXMgZmlsZSB1bmRlciBhbnkgY2lyY3Vtc3RhbmNlcy5cbiAqIFxuICogU1lTVEVNIElOVEVHUkFUSU9OIFBPTElDWTpcbiAqIC0gVGhpcyBpcyB0aGUgbWFpbiBhbmQgT05MWSB0ZXN0IHJ1bm5lciBmb3IgcXRlc3RzXG4gKiAtIERvIE5PVCBjcmVhdGUgYWx0ZXJuYXRlLCBwYXJhbGxlbCwgb3IgY29tcGV0aW5nIHRlc3QgcnVubmVyc1xuICogLSBBbnkgc3lzdGVtIGNoYW5nZXMgbXVzdCBBREFQVCBBUk9VTkQgdGhpcyBmaWxlLCBub3QgbW9kaWZ5IGl0XG4gKiAtIElmIGNoYW5nZXMgYXJlIG5lZWRlZCwgbW9kaWZ5IHRoZSBzdXJyb3VuZGluZyBzeXN0ZW0sIHV0aWxpdGllcywgb3IgY29uZmlndXJhdGlvblxuICogLSBUaGlzIHJ1bm5lcidzIGludGVyZmFjZSBhbmQgYmVoYXZpb3IgYXJlIGNvbnNpZGVyZWQgc3RhYmxlIGFuZCBjYW5vbmljYWxcbiAqIFxuICogUFVSUE9TRTpcbiAqIFRoaXMgZmlsZSBzZXJ2ZXMgYXMgdGhlIGNlbnRyYWwgdGVzdCBleGVjdXRpb24gZW5naW5lIGZvciB0aGUgcXRlc3RzIGZyYW1ld29yay5cbiAqIEl0IGRpc2NvdmVycywgY29vcmRpbmF0ZXMsIGFuZCBydW5zIGFsbCB0ZXN0cyB3aXRoIGhpZ2gtcGVyZm9ybWFuY2UgY29uY3VycmVuY3kuXG4gKiBcbiAqIEF1dG8tZ2VuZXJhdGVkIGJ5IHF0ZXN0cyBmcmFtZXdvcmsgLSBMYXN0IGdlbmVyYXRlZDogQXVndXN0IDE5LCAyMDI1XG4gKiBVcGRhdGVkOiBFbmhhbmNlZCBzdWNjZXNzIGRldGVjdGlvbiBmb3IgYm90aCBKZXN0IGFuZCBxdGVzdHMvTm9kZS5qcyBmb3JtYXRzXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqL1xuXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuY29uc3QgeyBzcGF3biB9ID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpO1xuY29uc3Qgb3MgPSByZXF1aXJlKCdvcycpO1xuXG4vLyBBTlNJIGNvbG9yIGNvZGVzIGZvciB0ZXJtaW5hbCBvdXRwdXRcbmNvbnN0IGNvbG9ycyA9IHtcbiAgcmVzZXQ6ICdcXHgxYlswbScsXG4gIGJyaWdodDogJ1xceDFiWzFtJyxcbiAgZGltOiAnXFx4MWJbMm0nLFxuICByZWQ6ICdcXHgxYlszMW0nLFxuICBncmVlbjogJ1xceDFiWzMybScsXG4gIHllbGxvdzogJ1xceDFiWzMzbScsXG4gIGJsdWU6ICdcXHgxYlszNG0nLFxuICBtYWdlbnRhOiAnXFx4MWJbMzVtJyxcbiAgY3lhbjogJ1xceDFiWzM2bScsXG4gIHdoaXRlOiAnXFx4MWJbMzdtJ1xufTtcblxuLyoqXG4gKiBQYXJhbGxlbCBUZXN0IFJ1bm5lciBmb3IgcXRlc3RzXG4gKiBEaXNjb3ZlcnMgYW5kIGV4ZWN1dGVzIGFsbCB0ZXN0IGZpbGVzIHdpdGggaGlnaC1wZXJmb3JtYW5jZSBjb25jdXJyZW5jeVxuICovXG5jbGFzcyBUZXN0UnVubmVyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy50ZXN0RmlsZXMgPSBbXTtcbiAgICB0aGlzLnBhc3NlZFRlc3RzID0gMDtcbiAgICB0aGlzLmZhaWxlZFRlc3RzID0gMDtcbiAgICB0aGlzLnRvdGFsVGVzdHMgPSAwO1xuICAgIHRoaXMuc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLnJlc3VsdHMgPSBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEaXNjb3ZlciBhbGwgdGVzdCBmaWxlcyBpbiB0aGUgcHJvamVjdFxuICAgKi9cbiAgZGlzY292ZXJUZXN0cygpIHtcbiAgICBjb25zdCB0ZXN0UGF0dGVybnMgPSBbXG4gICAgICAnKiovKi50ZXN0LmpzJyxcbiAgICAgICcqKi8qLnRlc3QudHMnLCBcbiAgICAgICcqKi8qLnRlc3QuanN4JyxcbiAgICAgICcqKi8qLnRlc3QudHN4JyxcbiAgICAgICcqKi90ZXN0LyoqLyouanMnLFxuICAgICAgJyoqL3Rlc3QvKiovKi50cycsXG4gICAgICAnKiovdGVzdHMvKiovKi5qcycsXG4gICAgICAnKiovdGVzdHMvKiovKi50cycsXG4gICAgICAnKiovX190ZXN0c19fLyoqLyouanMnLFxuICAgICAgJyoqL19fdGVzdHNfXy8qKi8qLnRzJ1xuICAgIF07XG5cbiAgICBjb25zdCBleGNsdWRlUGF0dGVybnMgPSBbXG4gICAgICAnbm9kZV9tb2R1bGVzJyxcbiAgICAgICcuZ2l0JyxcbiAgICAgICdjb3ZlcmFnZScsXG4gICAgICAnZGlzdCcsXG4gICAgICAnYnVpbGQnLFxuICAgICAgJy5jYWNoZScsXG4gICAgICAnLmplc3QtY2FjaGUnLFxuICAgICAgJ2RlbW8nLCAgICAgICAgLy8gRXhjbHVkZSBkZW1vIGRpcmVjdG9yeSB0byBtYXRjaCBKZXN0IGNvbmZpZ1xuICAgICAgJ2V4YW1wbGVzJywgICAgLy8gRXhjbHVkZSBleGFtcGxlcyBkaXJlY3RvcnkgdG8gbWF0Y2ggSmVzdCBjb25maWdcbiAgICAgICdkb2NzJywgICAgICAgIC8vIEV4Y2x1ZGUgZG9jcyBkaXJlY3RvcnkgdG8gbWF0Y2ggSmVzdCBjb25maWdcbiAgICAgICdzdHVicycgICAgICAgIC8vIEV4Y2x1ZGUgc3R1YnMgZGlyZWN0b3J5IHRvIG1hdGNoIEplc3QgY29uZmlnXG4gICAgXTtcblxuICAgIGNvbnN0IHRlc3RGaWxlcyA9IG5ldyBTZXQoKTtcblxuICAgIGNvbnN0IHdhbGtEaXIgPSAoZGlyKSA9PiB7XG4gICAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZGlyKSkgcmV0dXJuO1xuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBpdGVtcyA9IGZzLnJlYWRkaXJTeW5jKGRpciwgeyB3aXRoRmlsZVR5cGVzOiB0cnVlIH0pO1xuICAgICAgICBcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICAgICAgaWYgKGl0ZW0ubmFtZS5zdGFydHNXaXRoKCcuJykpIGNvbnRpbnVlO1xuICAgICAgICAgIGlmIChleGNsdWRlUGF0dGVybnMuaW5jbHVkZXMoaXRlbS5uYW1lKSkgY29udGludWU7XG4gICAgICAgICAgXG4gICAgICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmpvaW4oZGlyLCBpdGVtLm5hbWUpO1xuICAgICAgICAgIGNvbnN0IHJlbGF0aXZlUGF0aCA9IHBhdGgucmVsYXRpdmUoJy4nLCBmdWxsUGF0aCk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gU2tpcCBwYXRocyB0aGF0IG1hdGNoIGV4Y2x1ZGUgcGF0dGVybnMgKGluY2x1ZGluZyBzdWJkaXJlY3RvcmllcylcbiAgICAgICAgICBpZiAoZXhjbHVkZVBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiByZWxhdGl2ZVBhdGguaW5jbHVkZXMocGF0dGVybikpKSBjb250aW51ZTtcbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoaXRlbS5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgICB3YWxrRGlyKGZ1bGxQYXRoKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaXNGaWxlKCkpIHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGZpbGUgbWF0Y2hlcyB0ZXN0IHBhdHRlcm5zXG4gICAgICAgICAgICBpZiAodGhpcy5pc1Rlc3RGaWxlKHJlbGF0aXZlUGF0aCkpIHtcbiAgICAgICAgICAgICAgdGVzdEZpbGVzLmFkZChyZWxhdGl2ZVBhdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gU2tpcCBkaXJlY3RvcmllcyB3ZSBjYW4ndCByZWFkXG4gICAgICB9XG4gICAgfTtcblxuICAgIHdhbGtEaXIoJy4nKTtcbiAgICB0aGlzLnRlc3RGaWxlcyA9IEFycmF5LmZyb20odGVzdEZpbGVzKS5zb3J0KCk7XG4gICAgcmV0dXJuIHRoaXMudGVzdEZpbGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGEgZmlsZSBpcyBhIHRlc3QgZmlsZSBiYXNlZCBvbiBwYXR0ZXJuc1xuICAgKi9cbiAgaXNUZXN0RmlsZShmaWxlUGF0aCkge1xuICAgIGNvbnN0IHRlc3RQYXR0ZXJucyA9IFtcbiAgICAgIC9cXC50ZXN0XFwuW2p0XXN4PyQvLFxuICAgICAgL1xcLnNwZWNcXC5banRdc3g/JC8sXG4gICAgICAvdGVzdFxcLy4qXFwudGVzdFxcLltqdF1zeD8kLyxcbiAgICAgIC90ZXN0XFwvLipcXC5zcGVjXFwuW2p0XXN4PyQvLFxuICAgICAgL3Rlc3RzXFwvLipcXC50ZXN0XFwuW2p0XXN4PyQvLFxuICAgICAgL3Rlc3RzXFwvLipcXC5zcGVjXFwuW2p0XXN4PyQvLFxuICAgICAgL19fdGVzdHNfX1xcLy4qXFwuW2p0XXN4PyQvXG4gICAgXTtcblxuICAgIC8vIEV4Y2x1ZGUgdXRpbGl0eS9zZXR1cCBmaWxlcyB0aGF0IGRvbid0IGNvbnRhaW4gYWN0dWFsIHRlc3RzXG4gICAgY29uc3QgZXhjbHVkZUZpbGVzID0gW1xuICAgICAgJ3Rlc3RTZXR1cC5qcycsXG4gICAgICAncmVsb2FkQ2hlY2suanMnLCBcbiAgICAgICd3aXRob3V0U2V0dXAuanMnLFxuICAgICAgJ3NldHVwTXVsdGlwbGUuanMnLFxuICAgICAgJ3NldHVwTXVsdGlwbGVDaGlsZC5qcycsXG4gICAgICAnc2V0dXAudHMnXG4gICAgXTtcblxuICAgIGlmIChleGNsdWRlRmlsZXMuc29tZShleGNsdWRlID0+IGZpbGVQYXRoLmVuZHNXaXRoKGV4Y2x1ZGUpKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0ZXN0UGF0dGVybnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdChmaWxlUGF0aCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJ1biBhIHNpbmdsZSB0ZXN0IGZpbGVcbiAgICovXG4gIGFzeW5jIHJ1blRlc3RGaWxlKHRlc3RGaWxlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgbGV0IHN0ZG91dCA9ICcnO1xuICAgICAgbGV0IHN0ZGVyciA9ICcnO1xuXG4gICAgICAvLyBEZXRlcm1pbmUgaWYgdGhpcyBpcyBhIEplc3QvTm9kZSB0ZXN0IGJhc2VkIG9uIGZpbGUgY29udGVudFxuICAgICAgY29uc3QgaXNKZXN0VGVzdCA9IHRoaXMuc2hvdWxkVXNlSmVzdCh0ZXN0RmlsZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGNvbW1hbmQgPSBpc0plc3RUZXN0ID8gJ25weCcgOiAnbm9kZSc7XG4gICAgICBjb25zdCBhcmdzID0gaXNKZXN0VGVzdCA/IFsnamVzdCcsICctLXRlc3RQYXRoUGF0dGVybicsIHRlc3RGaWxlLCAnLS12ZXJib3NlJ10gOiBbdGVzdEZpbGVdO1xuXG4gICAgICBjb25zdCBjaGlsZCA9IHNwYXduKGNvbW1hbmQsIGFyZ3MsIHtcbiAgICAgICAgc3RkaW86IFsnaWdub3JlJywgJ3BpcGUnLCAncGlwZSddLFxuICAgICAgICBlbnY6IHsgLi4ucHJvY2Vzcy5lbnYsIE5PREVfRU5WOiAndGVzdCcgfVxuICAgICAgfSk7XG5cbiAgICAgIGNoaWxkLnN0ZG91dC5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgIHN0ZG91dCArPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICB9KTtcblxuICAgICAgY2hpbGQuc3RkZXJyLm9uKCdkYXRhJywgKGRhdGEpID0+IHtcbiAgICAgICAgc3RkZXJyICs9IGRhdGEudG9TdHJpbmcoKTtcbiAgICAgIH0pO1xuXG4gICAgICBjaGlsZC5vbignY2xvc2UnLCAoY29kZSkgPT4ge1xuICAgICAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICAgIFxuICAgICAgICAvLyBSb2J1c3Qgc3VjY2VzcyBkZXRlY3Rpb24gZm9yIGJvdGggSmVzdCBhbmQgcXRlc3RzL05vZGUuanMgZm9ybWF0c1xuICAgICAgICBjb25zdCBvdXRwdXQgPSBzdGRvdXQgKyBzdGRlcnI7XG4gICAgICAgIFxuICAgICAgICAvLyBKZXN0IHNob3dzIFBBU1Mgd2hlbiB0ZXN0cyBzdWNjZWVkLCBGQUlMIHdoZW4gdGhleSBmYWlsXG4gICAgICAgIGNvbnN0IGhhc1BBU1MgPSBvdXRwdXQuaW5jbHVkZXMoJ1BBU1MgJyk7XG4gICAgICAgIGNvbnN0IGhhc0ZBSUwgPSBvdXRwdXQuaW5jbHVkZXMoJ0ZBSUwgJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBxdGVzdHMvTm9kZS5qcyBmb3JtYXQgdXNlcyBleGl0IGNvZGVzIGFuZCBub3JtYWwgb3V0cHV0IChubyB1bmNhdWdodCBleGNlcHRpb25zKVxuICAgICAgICBjb25zdCBoYXNVbmNhdWdodEV4Y2VwdGlvbiA9IG91dHB1dC5pbmNsdWRlcygnRXJyb3I6JykgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5pbmNsdWRlcygnUmVmZXJlbmNlRXJyb3I6JykgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5pbmNsdWRlcygnVHlwZUVycm9yOicpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQuaW5jbHVkZXMoJ1N5bnRheEVycm9yOicpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZGVyci5pbmNsdWRlcygnRXJyb3I6JykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RkZXJyLmluY2x1ZGVzKCdhdCAnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZvciBkZWJ1Z2dpbmcgLSBsb2cgd2hhdCB3ZSdyZSBzZWVpbmdcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52LkRFQlVHX1RFU1RTKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFxcbkZpbGU6ICR7dGVzdEZpbGV9YCk7XG4gICAgICAgICAgY29uc29sZS5sb2coYENvZGU6ICR7Y29kZX0sIFBBU1M6ICR7aGFzUEFTU30sIEZBSUw6ICR7aGFzRkFJTH0sIEV4Y2VwdGlvbjogJHtoYXNVbmNhdWdodEV4Y2VwdGlvbn1gKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhgT3V0cHV0IHNuaXBwZXQ6IFwiJHtvdXRwdXQuc2xpY2UoMCwgMjAwKX0uLi5cImApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTdWNjZXNzIGRldGVjdGlvbiBmb3IgYm90aCBmb3JtYXRzOlxuICAgICAgICAvLyBKZXN0IGZvcm1hdDogUEFTUyBwcmVzZW50IGFuZCBubyBGQUlMXG4gICAgICAgIC8vIHF0ZXN0cy9Ob2RlLmpzIGZvcm1hdDogZXhpdCBjb2RlIDAgYW5kIG5vIHVuY2F1Z2h0IGV4Y2VwdGlvbnNcbiAgICAgICAgY29uc3QgamVzdFN1Y2Nlc3MgPSBoYXNQQVNTICYmICFoYXNGQUlMO1xuICAgICAgICBjb25zdCBxdGVzdHNTdWNjZXNzID0gY29kZSA9PT0gMCAmJiAhaGFzVW5jYXVnaHRFeGNlcHRpb24gJiYgIWhhc0ZBSUw7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBzdWNjZXNzID0gamVzdFN1Y2Nlc3MgfHwgKGlzSmVzdFRlc3QgPyBmYWxzZSA6IHF0ZXN0c1N1Y2Nlc3MpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHN1Y2Nlc3MpIHtcbiAgICAgICAgICB0aGlzLnBhc3NlZFRlc3RzKys7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5mYWlsZWRUZXN0cysrO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgZmlsZTogdGVzdEZpbGUsXG4gICAgICAgICAgc3VjY2VzcyxcbiAgICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgICBvdXRwdXQ6IHN0ZG91dCxcbiAgICAgICAgICBlcnJvcjogc3RkZXJyLFxuICAgICAgICAgIGNvZGVcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgY2hpbGQub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7XG4gICAgICAgIHRoaXMuZmFpbGVkVGVzdHMrKztcbiAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgZmlsZTogdGVzdEZpbGUsXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZHVyYXRpb246IERhdGUubm93KCkgLSBzdGFydFRpbWUsXG4gICAgICAgICAgb3V0cHV0OiAnJyxcbiAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBjb2RlOiAxXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lIGlmIGEgdGVzdCBzaG91bGQgdXNlIEplc3RcbiAgICovXG4gIHNob3VsZFVzZUplc3QodGVzdEZpbGUpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29udGVudCA9IGZzLnJlYWRGaWxlU3luYyh0ZXN0RmlsZSwgJ3V0ZjgnKTtcbiAgICAgIC8vIExvb2sgZm9yIEplc3Qtc3BlY2lmaWMgcGF0dGVybnNcbiAgICAgIHJldHVybiAvXFxiKGRlc2NyaWJlfGl0fHRlc3R8ZXhwZWN0fGplc3R8YmVmb3JlRWFjaHxhZnRlckVhY2h8YmVmb3JlQWxsfGFmdGVyQWxsKVxcYi8udGVzdChjb250ZW50KTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUnVuIHRlc3RzIGluIHBhcmFsbGVsIGJhdGNoZXNcbiAgICovXG4gIGFzeW5jIHJ1bkluUGFyYWxsZWwodGVzdEZpbGVzLCBtYXhDb25jdXJyZW5jeSkge1xuICAgIGNvbnN0IHJlc3VsdHMgPSBbXTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRlc3RGaWxlcy5sZW5ndGg7IGkgKz0gbWF4Q29uY3VycmVuY3kpIHtcbiAgICAgIGNvbnN0IGJhdGNoID0gdGVzdEZpbGVzLnNsaWNlKGksIGkgKyBtYXhDb25jdXJyZW5jeSk7XG4gICAgICBjb25zdCBiYXRjaFByb21pc2VzID0gYmF0Y2gubWFwKGZpbGUgPT4gdGhpcy5ydW5UZXN0RmlsZShmaWxlKSk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGJhdGNoUmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKGJhdGNoUHJvbWlzZXMpO1xuICAgICAgICByZXN1bHRzLnB1c2goLi4uYmF0Y2hSZXN1bHRzKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNob3cgcHJvZ3Jlc3NcbiAgICAgICAgY29uc3QgY29tcGxldGVkID0gTWF0aC5taW4oaSArIG1heENvbmN1cnJlbmN5LCB0ZXN0RmlsZXMubGVuZ3RoKTtcbiAgICAgICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUoYFxcciR7Y29sb3JzLmRpbX1Qcm9ncmVzczogJHtjb21wbGV0ZWR9LyR7dGVzdEZpbGVzLmxlbmd0aH0gZmlsZXMgY29tcGxldGVkJHtjb2xvcnMucmVzZXR9YCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGAke2NvbG9ycy5yZWR9QmF0Y2ggZXJyb3I6JHtjb2xvcnMucmVzZXR9YCwgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZygpOyAvLyBOZXcgbGluZSBhZnRlciBwcm9ncmVzc1xuICAgIHJldHVybiByZXN1bHRzO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc3BsYXkgdGVzdCByZXN1bHRzIHdpdGggY29sb3JmdWwgb3V0cHV0XG4gICAqL1xuICBkaXNwbGF5UmVzdWx0cyhyZXN1bHRzKSB7XG4gICAgY29uc29sZS5sb2coYFxcbiR7Y29sb3JzLmJyaWdodH3wn5OKIFRlc3QgUmVzdWx0cyBTdW1tYXJ5JHtjb2xvcnMucmVzZXR9YCk7XG4gICAgY29uc29sZS5sb2coYCR7Y29sb3JzLmRpbX0keyc9Jy5yZXBlYXQoNTApfSR7Y29sb3JzLnJlc2V0fWApO1xuXG4gICAgY29uc3QgdG90YWxEdXJhdGlvbiA9IERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZTtcblxuICAgIC8vIFN1bW1hcnkgc3RhdHNcbiAgICBjb25zb2xlLmxvZyhgJHtjb2xvcnMuZ3JlZW594pyFIFBhc3NlZDogJHt0aGlzLnBhc3NlZFRlc3RzfSR7Y29sb3JzLnJlc2V0fWApO1xuICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy5yZWR94p2MIEZhaWxlZDogJHt0aGlzLmZhaWxlZFRlc3RzfSR7Y29sb3JzLnJlc2V0fWApO1xuICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy5ibHVlffCfk4EgVG90YWwgRmlsZXM6ICR7cmVzdWx0cy5sZW5ndGh9JHtjb2xvcnMucmVzZXR9YCk7XG4gICAgY29uc29sZS5sb2coYCR7Y29sb3JzLmN5YW594o+x77iPICBEdXJhdGlvbjogJHt0b3RhbER1cmF0aW9ufW1zJHtjb2xvcnMucmVzZXR9XFxuYCk7XG5cbiAgICAvLyBTaG93IGZhaWxlZCB0ZXN0cyB3aXRoIGRldGFpbHNcbiAgICBjb25zdCBmYWlsZWRSZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiAhci5zdWNjZXNzKTtcbiAgICBpZiAoZmFpbGVkUmVzdWx0cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZyhgJHtjb2xvcnMucmVkfSR7Y29sb3JzLmJyaWdodH1GYWlsZWQgVGVzdHM6JHtjb2xvcnMucmVzZXR9YCk7XG4gICAgICBmYWlsZWRSZXN1bHRzLmZvckVhY2gocmVzdWx0ID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYFxcbiR7Y29sb3JzLnJlZH3inYwgJHtyZXN1bHQuZmlsZX0ke2NvbG9ycy5yZXNldH1gKTtcbiAgICAgICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy5kaW19JHtyZXN1bHQuZXJyb3Iuc3BsaXQoJ1xcbicpLnNsaWNlKDAsIDUpLmpvaW4oJ1xcbicpfSR7Y29sb3JzLnJlc2V0fWApO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gR2VuZXJhdGUgZGVidWcgZmlsZSBmb3IgZmFpbGVkIHRlc3RzXG4gICAgICB0aGlzLmdlbmVyYXRlRGVidWdGaWxlKGZhaWxlZFJlc3VsdHMpO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm1hbmNlIHN1bW1hcnlcbiAgICBjb25zdCBhdmdEdXJhdGlvbiA9IHJlc3VsdHMucmVkdWNlKChzdW0sIHIpID0+IHN1bSArIHIuZHVyYXRpb24sIDApIC8gcmVzdWx0cy5sZW5ndGg7XG4gICAgY29uc29sZS5sb2coYFxcbiR7Y29sb3JzLmRpbX1BdmVyYWdlIHRlc3QgZHVyYXRpb246ICR7TWF0aC5yb3VuZChhdmdEdXJhdGlvbil9bXMke2NvbG9ycy5yZXNldH1gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBERUJVR19URVNUUy5tZCBmaWxlIGZvciBmYWlsZWQgdGVzdCBhbmFseXNpc1xuICAgKi9cbiAgZ2VuZXJhdGVEZWJ1Z0ZpbGUoZmFpbGVkUmVzdWx0cykge1xuICAgIGlmIChmYWlsZWRSZXN1bHRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuICAgIFxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgY29uc3QgY3JlYXRpb25UaW1lID0gbm93LnRvSVNPU3RyaW5nKCk7XG4gICAgY29uc3QgcGFjaWZpY1RpbWUgPSBub3cudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJywgeyBcbiAgICAgIHRpbWVab25lOiAnQW1lcmljYS9Mb3NfQW5nZWxlcycsXG4gICAgICB3ZWVrZGF5OiAnbG9uZycsXG4gICAgICB5ZWFyOiAnbnVtZXJpYycsIFxuICAgICAgbW9udGg6ICdsb25nJywgXG4gICAgICBkYXk6ICdudW1lcmljJyxcbiAgICAgIGhvdXI6ICcyLWRpZ2l0JywgXG4gICAgICBtaW51dGU6ICcyLWRpZ2l0JywgXG4gICAgICBzZWNvbmQ6ICcyLWRpZ2l0JyxcbiAgICAgIHRpbWVab25lTmFtZTogJ3Nob3J0J1xuICAgIH0pO1xuICAgIFxuICAgIGxldCBkZWJ1Z0NvbnRlbnQgPSAnIyBUZXN0IEZhaWx1cmUgQW5hbHlzaXNcXG5cXG4nO1xuICAgIGRlYnVnQ29udGVudCArPSBgKipDcmVhdGlvbiBUaW1lOioqICR7Y3JlYXRpb25UaW1lfVxcbmA7XG4gICAgZGVidWdDb250ZW50ICs9IGAqKlBhY2lmaWMgVGltZToqKiAke3BhY2lmaWNUaW1lfVxcblxcbmA7XG4gICAgZGVidWdDb250ZW50ICs9ICfimqDvuI8gKipTVEFMRU5FU1MgV0FSTklORzoqKiBJZiB5b3VyIGNvZGUgY2hhbmdlcyBhcmUgYWZ0ZXIgdGhlIGNyZWF0aW9uIHRpbWUgYWJvdmUgYW5kIHlvdSBhcmUgY2hlY2tpbmcgdGhpcyBmaWxlLCB0aGVuIGl0IGlzIHN0YWxlIGFuZCB0ZXN0cyBuZWVkIHRvIGJlIHJlcnVuLlxcblxcbic7XG4gICAgZGVidWdDb250ZW50ICs9ICdBbmFseXplIGFuZCBhZGRyZXNzIHRoZSBmb2xsb3dpbmcgdGVzdCBmYWlsdXJlczpcXG5cXG4nO1xuICAgIFxuICAgIGZhaWxlZFJlc3VsdHMuZm9yRWFjaCgocmVzdWx0LCBpbmRleCkgPT4ge1xuICAgICAgZGVidWdDb250ZW50ICs9IGAjIyBGYWlsZWQgVGVzdCAke2luZGV4ICsgMX06ICR7cmVzdWx0LmZpbGV9XFxuXFxuYDtcbiAgICAgIGRlYnVnQ29udGVudCArPSAnIyMjIE91dHB1dDpcXG4nO1xuICAgICAgZGVidWdDb250ZW50ICs9ICdgYGBcXG4nO1xuICAgICAgZGVidWdDb250ZW50ICs9IHJlc3VsdC5lcnJvciB8fCByZXN1bHQub3V0cHV0IHx8ICdObyBlcnJvciBvdXRwdXQgYXZhaWxhYmxlJztcbiAgICAgIGRlYnVnQ29udGVudCArPSAnXFxuYGBgXFxuXFxuJztcbiAgICAgIGRlYnVnQ29udGVudCArPSBgIyMjIER1cmF0aW9uOiAke3Jlc3VsdC5kdXJhdGlvbn1tc1xcblxcbmA7XG4gICAgICBkZWJ1Z0NvbnRlbnQgKz0gJy0tLVxcblxcbic7XG4gICAgfSk7XG4gICAgXG4gICAgZGVidWdDb250ZW50ICs9ICcjIyBTdW1tYXJ5XFxuXFxuJztcbiAgICBkZWJ1Z0NvbnRlbnQgKz0gYC0gVG90YWwgZmFpbGVkIHRlc3RzOiAke2ZhaWxlZFJlc3VsdHMubGVuZ3RofVxcbmA7XG4gICAgZGVidWdDb250ZW50ICs9IGAtIEZhaWxlZCB0ZXN0IGZpbGVzOiAke2ZhaWxlZFJlc3VsdHMubWFwKHIgPT4gci5maWxlKS5qb2luKCcsICcpfVxcbmA7XG4gICAgZGVidWdDb250ZW50ICs9IGAtIEdlbmVyYXRlZDogJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9XFxuYDtcbiAgICBcbiAgICB0cnkge1xuICAgICAgZnMud3JpdGVGaWxlU3luYygnREVCVUdfVEVTVFMubWQnLCBkZWJ1Z0NvbnRlbnQpO1xuICAgICAgY29uc29sZS5sb2coYFxcbiR7Y29sb3JzLnllbGxvd33wn5OLIERlYnVnIGZpbGUgY3JlYXRlZDogREVCVUdfVEVTVFMubWQke2NvbG9ycy5yZXNldH1gKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coYCR7Y29sb3JzLnJlZH3imqDvuI8gIENvdWxkIG5vdCBjcmVhdGUgREVCVUdfVEVTVFMubWQ6ICR7ZXJyb3IubWVzc2FnZX0ke2NvbG9ycy5yZXNldH1gKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTWFpbiBleGVjdXRpb24gbWV0aG9kXG4gICAqL1xuICBhc3luYyBydW4oKSB7XG4gICAgY29uc29sZS5sb2coYCR7Y29sb3JzLmJyaWdodH3wn6eqIHF0ZXN0cyBUZXN0IFJ1bm5lciAtIFBhcmFsbGVsIE1vZGUke2NvbG9ycy5yZXNldH1gKTtcbiAgICBjb25zb2xlLmxvZyhgJHtjb2xvcnMuZGltfURpc2NvdmVyaW5nIGFuZCBydW5uaW5nIGFsbCB0ZXN0cy4uLiR7Y29sb3JzLnJlc2V0fVxcbmApO1xuXG4gICAgLy8gRGlzY292ZXIgYWxsIHRlc3QgZmlsZXNcbiAgICBjb25zdCB0ZXN0RmlsZXMgPSB0aGlzLmRpc2NvdmVyVGVzdHMoKTtcbiAgICBcbiAgICBpZiAodGVzdEZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5sb2coYCR7Y29sb3JzLnllbGxvd33imqDvuI8gIE5vIHRlc3QgZmlsZXMgZm91bmQke2NvbG9ycy5yZXNldH1gKTtcbiAgICAgIGNvbnNvbGUubG9nKGAke2NvbG9ycy5kaW19TG9va2luZyBmb3IgZmlsZXMgbWF0Y2hpbmc6ICoudGVzdC5qcywgKi5zcGVjLmpzLCB0ZXN0LyosIHRlc3RzLyosIF9fdGVzdHNfXy8qJHtjb2xvcnMucmVzZXR9YCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYCR7Y29sb3JzLmJsdWV9Rm91bmQgJHt0ZXN0RmlsZXMubGVuZ3RofSB0ZXN0IGZpbGUocyk6JHtjb2xvcnMucmVzZXR9YCk7XG4gICAgdGVzdEZpbGVzLmZvckVhY2goZmlsZSA9PiBjb25zb2xlLmxvZyhgICAke2NvbG9ycy5kaW194oCiJHtjb2xvcnMucmVzZXR9ICR7ZmlsZX1gKSk7XG4gICAgY29uc29sZS5sb2coYFxcbiR7Y29sb3JzLm1hZ2VudGF98J+agCBSdW5uaW5nIHRlc3RzIGluIHBhcmFsbGVsLi4uJHtjb2xvcnMucmVzZXR9XFxuYCk7XG4gICAgXG4gICAgLy8gUnVuIHRlc3RzIGluIHBhcmFsbGVsIHdpdGggYWdncmVzc2l2ZSBjb25jdXJyZW5jeSBmb3Igc3BlZWRcbiAgICBjb25zdCBjcHVDb3VudCA9IG9zLmNwdXMoKS5sZW5ndGg7XG4gICAgY29uc3QgbWF4Q29uY3VycmVuY3kgPSBNYXRoLm1pbih0ZXN0RmlsZXMubGVuZ3RoLCBNYXRoLm1heCg0LCBjcHVDb3VudCAqIDIpKTsgLy8gVXNlIDJ4IENQVSBjb3JlcyBmb3IgSS9PLWJvdW5kIHRlc3RzXG4gICAgY29uc29sZS5sb2coYCR7Y29sb3JzLmRpbX1NYXggY29uY3VycmVuY3k6ICR7bWF4Q29uY3VycmVuY3l9IHdvcmtlcnMgKCR7Y3B1Q291bnR9IENQVSBjb3Jlcykke2NvbG9ycy5yZXNldH1cXG5gKTtcbiAgICBcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgdGhpcy5ydW5JblBhcmFsbGVsKHRlc3RGaWxlcywgbWF4Q29uY3VycmVuY3kpO1xuICAgIHRoaXMucmVzdWx0cyA9IHJlc3VsdHM7XG4gICAgXG4gICAgLy8gRGlzcGxheSBjb21wcmVoZW5zaXZlIHJlc3VsdHNcbiAgICB0aGlzLmRpc3BsYXlSZXN1bHRzKHJlc3VsdHMpO1xuICAgIFxuICAgIC8vIEV4aXQgd2l0aCBhcHByb3ByaWF0ZSBjb2RlXG4gICAgcHJvY2Vzcy5leGl0KHRoaXMuZmFpbGVkVGVzdHMgPiAwID8gMSA6IDApO1xuICB9XG59XG5cbi8vIFJ1biB0aGUgdGVzdCBzdWl0ZVxuaWYgKHJlcXVpcmUubWFpbiA9PT0gbW9kdWxlKSB7XG4gIGNvbnN0IHJ1bm5lciA9IG5ldyBUZXN0UnVubmVyKCk7XG4gIHJ1bm5lci5ydW4oKS5jYXRjaChlcnJvciA9PiB7XG4gICAgY29uc29sZS5lcnJvcihgJHtjb2xvcnMucmVkfVRlc3QgcnVubmVyIGVycm9yOiR7Y29sb3JzLnJlc2V0fWAsIGVycm9yKTtcbiAgICBwcm9jZXNzLmV4aXQoMSk7XG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFRlc3RSdW5uZXI7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxFQUFFLEdBQUdDLE9BQU8sQ0FBQyxJQUFJLENBQUM7QUFDeEIsTUFBTUMsSUFB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