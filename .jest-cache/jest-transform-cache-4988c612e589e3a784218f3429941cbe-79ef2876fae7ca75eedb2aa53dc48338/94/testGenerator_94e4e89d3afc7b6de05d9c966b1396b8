cc72269d82cb330ba88c0a5e5ed2e206
/**
 * Test Generator for qtests Framework
 * 
 * Automatically generates unit tests and API tests by scanning source code.
 * Analyzes JavaScript/TypeScript files to detect exports, imports, and API routes,
 * then creates appropriate test files with proper structure and mocking.
 * 
 * Features:
 * - Unit test generation for exported functions/classes
 * - API test generation for Express routes
 * - Automatic mock setup for known libraries
 * - Jest configuration scaffolding
 * - Support for qtests framework integration
 */

const fs = require('fs');
const path = require('path');

// Configuration constants
const DEFAULT_CONFIG = {
  SRC_DIR: 'src',
  TEST_DIR: 'tests/integration',
  KNOWN_MOCKS: ['axios', 'node-fetch', 'pg', 'mongoose', 'fs', 'redis'],
  VALID_EXTS: ['.ts', '.js', '.tsx', '.jsx']
};

// Regex patterns for code analysis
const PATTERNS = {
  qtests: /from ['"]qtests['"]/,
  api: /\b(app|router)\.(get|post|put|delete|patch)\s*\(\s*['"`]([^'"`]+)['"`]/gi,
  exports: /^\s*export\s+(?:const|function|class)\s+([a-zA-Z0-9_]+)/gm,
  imports: /from ['"]([^'"]+)['"]/g
};
class TestGenerator {
  constructor(options = {}) {
    this.config = {
      ...DEFAULT_CONFIG,
      ...options
    };
    this.scanned = [];
  }

  /**
   * Check if directory should be skipped during discovery
   */
  shouldSkipDirectory(dirName) {
    const skipPatterns = ['node_modules', '.git', '.next', 'dist', 'build', 'coverage', '.vscode', '.idea', 'docs', 'documentation', 'assets', 'public', 'static', '.replit_cache', '.config', '.npm', 'logs'];
    return skipPatterns.includes(dirName) || dirName.startsWith('.');
  }

  /**
   * Walk entire project directory structure, respecting skip patterns
   */
  walkProject() {
    const currentDir = process.cwd();
    return this.walkRecursive(currentDir);
  }

  /**
   * Recursively walk directory and return all file paths, skipping irrelevant directories
   */
  walkRecursive(dir) {
    if (!fs.existsSync(dir)) {
      return [];
    }
    return fs.readdirSync(dir, {
      withFileTypes: true
    }).flatMap(entry => {
      const full = path.resolve(dir, entry.name);
      if (entry.isDirectory()) {
        // Skip directories that shouldn't contain tests or source files
        if (this.shouldSkipDirectory(entry.name)) {
          return [];
        }
        return this.walkRecursive(full);
      } else {
        return [full];
      }
    });
  }

  /**
   * Legacy walk method for backwards compatibility (walks single directory)
   */
  walk(dir) {
    if (!fs.existsSync(dir)) {
      return [];
    }
    return fs.readdirSync(dir, {
      withFileTypes: true
    }).flatMap(entry => {
      const full = path.resolve(dir, entry.name);
      return entry.isDirectory() ? this.walk(full) : full;
    });
  }

  /**
   * Categorize discovered files into source files and existing tests
   */
  categorizeFiles(files) {
    const sourceFiles = [];
    const existingTests = [];
    files.forEach(file => {
      const ext = path.extname(file);
      const basename = path.basename(file);

      // Skip files with invalid extensions
      if (!this.config.VALID_EXTS.includes(ext)) {
        return;
      }

      // Check if this is a test file
      if (this.isTestFile(basename)) {
        existingTests.push(file);
      } else {
        // Check if this source file already has a corresponding test
        const hasTest = this.hasCorrespondingTest(file, files);
        if (!hasTest) {
          sourceFiles.push(file);
        }
      }
    });
    return {
      sourceFiles,
      existingTests
    };
  }

  /**
   * Check if filename indicates it's a test file
   */
  isTestFile(filename) {
    const testPatterns = [/\.test\./, /\.spec\./, /_test\./, /_spec\./, /\.e2e\./, /\.integration\./];
    return testPatterns.some(pattern => pattern.test(filename));
  }

  /**
   * Check if a source file has a corresponding test file
   */
  hasCorrespondingTest(sourceFile, allFiles) {
    const dir = path.dirname(sourceFile);
    const basename = path.basename(sourceFile, path.extname(sourceFile));
    const ext = path.extname(sourceFile);

    // Common test file patterns to look for
    const testPatterns = [`${basename}.test${ext}`, `${basename}.spec${ext}`, `${basename}_test${ext}`, `${basename}_spec${ext}`, `${basename}.test.js`, `${basename}.spec.js`, `${basename}.test.ts`, `${basename}.spec.ts`];

    // Look for test files in the same directory
    const sameDirectoryTests = testPatterns.map(pattern => path.join(dir, pattern));

    // Look for test files in common test directories
    const testDirectories = ['tests', 'test', '__tests__', 'spec'];
    const testDirectoryTests = testDirectories.flatMap(testDir => {
      const testPath = path.join(dir, testDir);
      return testPatterns.map(pattern => path.join(testPath, pattern));
    });

    // Check if any of these test files exist
    const allTestPaths = [...sameDirectoryTests, ...testDirectoryTests];
    return allTestPaths.some(testPath => allFiles.some(file => path.resolve(file) === path.resolve(testPath)));
  }

  /**
   * Generate test file path based on source file and test type
   * Supports both feature-first (tests alongside files) and traditional (separate test directory) structures
   */
  getRelativeTestPath(file, type = 'unit') {
    const dir = path.dirname(file);
    const basename = path.basename(file, path.extname(file));
    const ext = path.extname(file);
    if (type === 'unit') {
      // For unit tests, place them alongside the source file with matching extension
      return path.join(dir, `${basename}.test${ext}`);
    } else {
      // For API/integration tests, use the configured test directory
      // Preserve TypeScript for .ts/.tsx files, use JavaScript for others
      const rel = path.relative(process.cwd(), file);
      const testExt = ['.ts', '.tsx'].includes(ext) ? '.ts' : '.js';
      return path.join(this.config.TEST_DIR, rel.replace(/\.[tj]sx?$/, `.test${testExt}`).replace(/[\\/]/g, '__'));
    }
  }

  /**
   * Create directory if it doesn't exist
   */
  createDir(p) {
    const dir = path.dirname(p);
    if (!fs.existsSync(dir)) {
      fs.mkdirSync(dir, {
        recursive: true
      });
    }
  }

  /**
   * Write file only if it doesn't already exist
   */
  writeIfMissing(p, content) {
    if (!fs.existsSync(p)) {
      this.createDir(p);
      fs.writeFileSync(p, content, 'utf8');
      return true;
    }
    return false;
  }

  /**
   * Extract imported modules from file content
   */
  getUsedModules(content) {
    return [...content.matchAll(PATTERNS.imports)].map(m => m[1]).filter(x => !x.startsWith('.') && !x.startsWith('/'));
  }

  /**
   * Generate unit test content for a file - optimized for speed
   */
  createUnitTest(file, exports, usesQtests, mocks) {
    const ext = path.extname(file);
    const isTypeScript = ['.ts', '.tsx'].includes(ext);
    const lines = [`// Auto-generated unit test for ${path.basename(file)} - optimized for speed`];

    // Fast test setup - minimal imports
    if (usesQtests) {
      if (isTypeScript) {
        lines.push(`import { test } from 'qtests';`);
      } else {
        lines.push(`const { test } = require('qtests');`);
      }
    }

    // Batch mock all libraries at once for performance
    if (mocks.length > 0) {
      lines.push(`// Mock external dependencies for speed`);
      mocks.forEach(lib => {
        lines.push(`jest.mock('${lib}', () => ({ __esModule: true, default: jest.fn(), ...jest.requireActual('${lib}') }));`);
      });
    }
    if (isTypeScript) {
      const basename = path.basename(file, path.extname(file));
      lines.push(`import * as mod from './${basename}';`, '');
    } else {
      lines.push(`const mod = require('./${path.basename(file)}');`, '');
    }

    // Standard Jest with optimized performance
    lines.push(`describe('${path.basename(file)}', () => {`);
    for (const fn of exports) {
      lines.push(`  test('${fn} works', async () => {`);
      lines.push(`    // Fast assertion - TODO: implement specific test logic`);
      lines.push(`    expect(typeof mod.${fn}).toBeDefined();`);
      lines.push('  });');
    }
    lines.push('});\n');
    return lines.join('\n');
  }

  /**
   * Generate API test content for an endpoint - optimized for speed
   */
  createApiTest(method, route, isTypeScript = false) {
    const lines = [`// Auto-generated API test for ${method.toUpperCase()} ${route} - optimized for speed`];
    if (isTypeScript) {
      lines.push(`import { httpTest } from 'qtests/lib/envUtils';`, '');
    } else {
      lines.push(`const { httpTest } = require('qtests/lib/envUtils');`, '');
    }

    // Standard Jest with optimized performance
    lines.push(`describe('${method.toUpperCase()} ${route}', () => {`);
    lines.push(`  // Shared app setup for performance`);
    lines.push(`  let sharedApp;`);
    lines.push(`  beforeAll(() => {`);
    lines.push(`    sharedApp = httpTest.createMockApp();`);
    lines.push(`  });`);
    lines.push(``);
    lines.push(`  test('should succeed', async () => {`);
    lines.push(`    // Reuse shared app for speed`);
    lines.push(`    const app = httpTest.createMockApp();`);
    lines.push(`    app.${method.toLowerCase()}('${route}', (req, res) => {`);
    lines.push(`      res.statusCode = 200;`);
    lines.push(`      res.setHeader('content-type', 'application/json');`);
    lines.push(`      res.end(JSON.stringify({ success: true }));`);
    lines.push(`    });`);
    lines.push(`    `);
    lines.push(`    const res = await httpTest.supertest(app)`);
    lines.push(`      .${method.toLowerCase()}('${route}')`);
    lines.push(`      .expect(200)`);
    lines.push(`      .end();`);
    lines.push(`    `);
    lines.push(`    expect(res.body.success).toBe(true);`);
    lines.push('  });', '');
    lines.push('  test(\'should handle error responses\', async () => {');
    lines.push(`    const app = httpTest.createMockApp();`);
    lines.push(`    app.${method.toLowerCase()}('${route}', (req, res) => {`);
    lines.push(`      res.statusCode = 400;`);
    lines.push(`      res.setHeader('content-type', 'application/json');`);
    lines.push(`      res.end(JSON.stringify({ error: 'Bad request' }));`);
    lines.push(`    });`);
    lines.push(`    `);
    lines.push(`    const res = await httpTest.supertest(app)`);
    lines.push(`      .${method.toLowerCase()}('${route}')`);
    lines.push(`      .expect(400)`);
    lines.push(`      .end();`);
    lines.push(`    `);
    lines.push(`    expect(res.body.error).toBe('Bad request');`);
    lines.push('  });');
    lines.push('});\n');
    return lines.join('\n');
  }

  /**
   * Analyze a single file and generate appropriate tests
   */
  analyze(file) {
    const ext = path.extname(file);
    if (!this.config.VALID_EXTS.includes(ext)) {
      return;
    }
    const content = fs.readFileSync(file, 'utf8');
    const usesQtests = PATTERNS.qtests.test(content);
    const imports = this.getUsedModules(content);
    const mockTargets = imports.filter(i => this.config.KNOWN_MOCKS.includes(i) && i !== 'qtests');

    // Generate unit tests for exported functions/classes
    const exports = [...content.matchAll(PATTERNS.exports)].map(m => m[1]);
    if (exports.length > 0) {
      const testPath = this.getRelativeTestPath(file, 'unit');
      const created = this.writeIfMissing(testPath, this.createUnitTest(file, exports, usesQtests, mockTargets));
      if (created) {
        this.scanned.push({
          type: 'unit',
          file: path.relative('.', testPath)
        });
      }
    }

    // Generate API tests for detected routes
    const apis = [...content.matchAll(PATTERNS.api)];
    for (const [,, method, route] of apis) {
      const isTypeScript = ['.ts', '.tsx'].includes(ext);
      const testPath = this.getRelativeTestPath(file, 'api').replace(/\.test\.[jt]s$/, `__${method.toLowerCase()}.test${isTypeScript ? '.ts' : '.js'}`);
      const created = this.writeIfMissing(testPath, this.createApiTest(method, route, isTypeScript));
      if (created) {
        this.scanned.push({
          type: 'api',
          file: path.relative('.', testPath)
        });
      }
    }
  }

  /**
   * Create Jest configuration and setup files
   */
  scaffoldJestSetup() {
    const config = `
// jest.config.js
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  setupFilesAfterEnv: ['./tests/setup.ts'],
  moduleFileExtensions: ['ts', 'js', 'json'],
  roots: ['<rootDir>/src', '<rootDir>/tests'],
};
`.trim();
    const setup = `
// tests/setup.ts
let server;

beforeAll(async () => {
  const app = require('../src/app').default || require('../src/app');
  server = app.listen(4000, () => console.log('Test server started'));
});

afterAll(async () => {
  if (server) server.close();
});
`.trim();
    this.writeIfMissing('jest.config.js', config);
    this.writeIfMissing('tests/setup.ts', setup);
  }

  /**
   * Generate qtests test runner file and update package.json
   * Creates qtests-runner.js and updates the test script in package.json
   * Automatically handles ES module compatibility
   */
  generateTestRunner() {
    const fs = require('fs');
    const path = require('path');

    // Check if project uses ES modules
    const isESModuleProject = this.isESModuleProject();

    // Read the existing qtests-runner.js as template
    const templatePath = path.join(__dirname, '..', 'qtests-runner.js');
    let runnerContent;
    if (fs.existsSync(templatePath)) {
      runnerContent = fs.readFileSync(templatePath, 'utf8');

      // Convert CommonJS to ES modules if needed
      if (isESModuleProject) {
        runnerContent = this.convertToESModule(runnerContent);
      }
    } else {
      // Generate appropriate template based on module type
      if (isESModuleProject) {
        runnerContent = this.generateESModuleTemplate();
      } else {
        runnerContent = this.generateCommonJSTemplate();
      }
    }
    const created = this.writeIfMissing('qtests-runner.js', runnerContent);
    if (created) {
      this.updatePackageJsonTestScript();
      return true;
    }
    return false;
  }

  /**
   * Check if the current project uses ES modules
   */
  isESModuleProject() {
    const fs = require('fs');
    const path = require('path');
    try {
      const packagePath = path.join(process.cwd(), 'package.json');
      if (!fs.existsSync(packagePath)) return false;
      const packageJson = JSON.parse(fs.readFileSync(packagePath, 'utf8'));
      return packageJson.type === 'module';
    } catch {
      return false;
    }
  }

  /**
   * Convert CommonJS code to ES module syntax
   */
  convertToESModule(commonJSCode) {
    return commonJSCode.replace(/const fs = require\('fs'\);/, "import fs from 'fs';").replace(/const path = require\('path'\);/, "import path from 'path';").replace(/const { spawn } = require\('child_process'\);/, "import { spawn } from 'child_process';").replace(/const os = require\('os'\);/, "import os from 'os';").replace(/require\.main === module/, "import.meta.url === `file://${process.argv[1]}`").replace(/module\.exports = TestRunner;/, "export default TestRunner;").replace(/\/\/ Generated as: qtests-runner\.js/, "// Generated as: qtests-runner.js (ES Module Compatible)").replace(/--testPathPattern/g, "--testPathPattern"); // Ensure correct Jest CLI parameter in ES modules
  }

  /**
   * Generate ES module template
   */
  generateESModuleTemplate() {
    return `// qtests Test Runner - Auto-generated by qtests (ES Module)
// This file discovers and runs all tests in your project

import fs from 'fs';
import path from 'path';
import { spawn } from 'child_process';
import os from 'os';

// Basic ES module test runner implementation
console.log('🧪 Basic qtests Test Runner (ES Module)');
console.log('Run tests with: npm test');
`;
  }

  /**
   * Generate CommonJS template  
   */
  generateCommonJSTemplate() {
    return `// qtests Test Runner - Auto-generated by qtests
// This file discovers and runs all tests in your project

const fs = require('fs');
const path = require('path');
const { spawn } = require('child_process');
const os = require('os');

// Basic CommonJS test runner implementation
console.log('🧪 Basic qtests Test Runner');
console.log('Run tests with: npm test');
`;
  }

  /**
   * Update package.json test script to use qtests-runner.cjs (ES module compatible)
   */
  updatePackageJsonTestScript() {
    try {
      const packagePath = path.join(process.cwd(), 'package.json');
      if (!fs.existsSync(packagePath)) {
        console.log('⚠️  package.json not found, skipping test script update');
        return false;
      }
      const packageJson = JSON.parse(fs.readFileSync(packagePath, 'utf8'));

      // Update test script - use .cjs extension for ES module compatibility
      if (!packageJson.scripts) {
        packageJson.scripts = {};
      }
      packageJson.scripts.test = 'node qtests-runner.js';
      fs.writeFileSync(packagePath, JSON.stringify(packageJson, null, 2), 'utf8');
      console.log('✅ Updated package.json test script to use qtests-runner.js');
      return true;
    } catch (error) {
      console.log('⚠️  Could not update package.json:', error.message);
      return false;
    }
  }

  /**
   * Main generator function - comprehensively scans project for test generation
   */
  generate() {
    console.log(`Scanning project for test generation...`);

    // Walk entire project to discover all source files and existing tests
    const projectFiles = this.walkProject();
    const {
      sourceFiles,
      existingTests
    } = this.categorizeFiles(projectFiles);
    console.log(`Found ${sourceFiles.length} source files and ${existingTests.length} existing tests`);

    // Analyze each source file for test generation
    sourceFiles.forEach(file => this.analyze(file));
    this.scaffoldJestSetup();
    if (this.scanned.length === 0) {
      console.log('✅ All tests already exist. Nothing to generate.');
    } else {
      console.log(`✅ Generated ${this.scanned.length} new test files:`);
      this.scanned.forEach(({
        type,
        file
      }) => {
        const label = type === 'unit' ? '📦 Unit' : '🌐 API';
        console.log(`  ${label} → ${file}`);
      });
    }
    return this.scanned;
  }

  /**
   * Get generation results
   */
  getResults() {
    return this.scanned;
  }
}
module.exports = {
  TestGenerator,
  DEFAULT_CONFIG,
  PATTERNS
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwiREVGQVVMVF9DT05GSUciLCJTUkNfRElSIiwiVEVTVF9ESVIiLCJLTk9XTl9NT0NLUyIsIlZBTElEX0VYVFMiLCJQQVRURVJOUyIsInF0ZXN0cyIsImFwaSIsImV4cG9ydHMiLCJpbXBvcnRzIiwiVGVzdEdlbmVyYXRvciIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsImNvbmZpZyIsInNjYW5uZWQiLCJzaG91bGRTa2lwRGlyZWN0b3J5IiwiZGlyTmFtZSIsInNraXBQYXR0ZXJucyIsImluY2x1ZGVzIiwic3RhcnRzV2l0aCIsIndhbGtQcm9qZWN0IiwiY3VycmVudERpciIsInByb2Nlc3MiLCJjd2QiLCJ3YWxrUmVjdXJzaXZlIiwiZGlyIiwiZXhpc3RzU3luYyIsInJlYWRkaXJTeW5jIiwid2l0aEZpbGVUeXBlcyIsImZsYXRNYXAiLCJlbnRyeSIsImZ1bGwiLCJyZXNvbHZlIiwibmFtZSIsImlzRGlyZWN0b3J5Iiwid2FsayIsImNhdGVnb3JpemVGaWxlcyIsImZpbGVzIiwic291cmNlRmlsZXMiLCJleGlzdGluZ1Rlc3RzIiwiZm9yRWFjaCIsImZpbGUiLCJleHQiLCJleHRuYW1lIiwiYmFzZW5hbWUiLCJpc1Rlc3RGaWxlIiwicHVzaCIsImhhc1Rlc3QiLCJoYXNDb3JyZXNwb25kaW5nVGVzdCIsImZpbGVuYW1lIiwidGVzdFBhdHRlcm5zIiwic29tZSIsInBhdHRlcm4iLCJ0ZXN0Iiwic291cmNlRmlsZSIsImFsbEZpbGVzIiwiZGlybmFtZSIsInNhbWVEaXJlY3RvcnlUZXN0cyIsIm1hcCIsImpvaW4iLCJ0ZXN0RGlyZWN0b3JpZXMiLCJ0ZXN0RGlyZWN0b3J5VGVzdHMiLCJ0ZXN0RGlyIiwidGVzdFBhdGgiLCJhbGxUZXN0UGF0aHMiLCJnZXRSZWxhdGl2ZVRlc3RQYXRoIiwidHlwZSIsInJlbCIsInJlbGF0aXZlIiwidGVzdEV4dCIsInJlcGxhY2UiLCJjcmVhdGVEaXIiLCJwIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwid3JpdGVJZk1pc3NpbmciLCJjb250ZW50Iiwid3JpdGVGaWxlU3luYyIsImdldFVzZWRNb2R1bGVzIiwibWF0Y2hBbGwiLCJtIiwiZmlsdGVyIiwieCIsImNyZWF0ZVVuaXRUZXN0IiwidXNlc1F0ZXN0cyIsIm1vY2tzIiwiaXNUeXBlU2NyaXB0IiwibGluZXMiLCJsZW5ndGgiLCJsaWIiLCJmbiIsImNyZWF0ZUFwaVRlc3QiLCJtZXRob2QiLCJyb3V0ZSIsInRvVXBwZXJDYXNlIiwidG9Mb3dlckNhc2UiLCJhbmFseXplIiwicmVhZEZpbGVTeW5jIiwibW9ja1RhcmdldHMiLCJpIiwiY3JlYXRlZCIsImFwaXMiLCJzY2FmZm9sZEplc3RTZXR1cCIsInRyaW0iLCJzZXR1cCIsImdlbmVyYXRlVGVzdFJ1bm5lciIsImlzRVNNb2R1bGVQcm9qZWN0IiwidGVtcGxhdGVQYXRoIiwiX19kaXJuYW1lIiwicnVubmVyQ29udGVudCIsImNvbnZlcnRUb0VTTW9kdWxlIiwiZ2VuZXJhdGVFU01vZHVsZVRlbXBsYXRlIiwiZ2VuZXJhdGVDb21tb25KU1RlbXBsYXRlIiwidXBkYXRlUGFja2FnZUpzb25UZXN0U2NyaXB0IiwicGFja2FnZVBhdGgiLCJwYWNrYWdlSnNvbiIsIkpTT04iLCJwYXJzZSIsImNvbW1vbkpTQ29kZSIsImNvbnNvbGUiLCJsb2ciLCJzY3JpcHRzIiwic3RyaW5naWZ5IiwiZXJyb3IiLCJtZXNzYWdlIiwiZ2VuZXJhdGUiLCJwcm9qZWN0RmlsZXMiLCJsYWJlbCIsImdldFJlc3VsdHMiLCJtb2R1bGUiXSwic291cmNlcyI6WyJ0ZXN0R2VuZXJhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdCBHZW5lcmF0b3IgZm9yIHF0ZXN0cyBGcmFtZXdvcmtcbiAqIFxuICogQXV0b21hdGljYWxseSBnZW5lcmF0ZXMgdW5pdCB0ZXN0cyBhbmQgQVBJIHRlc3RzIGJ5IHNjYW5uaW5nIHNvdXJjZSBjb2RlLlxuICogQW5hbHl6ZXMgSmF2YVNjcmlwdC9UeXBlU2NyaXB0IGZpbGVzIHRvIGRldGVjdCBleHBvcnRzLCBpbXBvcnRzLCBhbmQgQVBJIHJvdXRlcyxcbiAqIHRoZW4gY3JlYXRlcyBhcHByb3ByaWF0ZSB0ZXN0IGZpbGVzIHdpdGggcHJvcGVyIHN0cnVjdHVyZSBhbmQgbW9ja2luZy5cbiAqIFxuICogRmVhdHVyZXM6XG4gKiAtIFVuaXQgdGVzdCBnZW5lcmF0aW9uIGZvciBleHBvcnRlZCBmdW5jdGlvbnMvY2xhc3Nlc1xuICogLSBBUEkgdGVzdCBnZW5lcmF0aW9uIGZvciBFeHByZXNzIHJvdXRlc1xuICogLSBBdXRvbWF0aWMgbW9jayBzZXR1cCBmb3Iga25vd24gbGlicmFyaWVzXG4gKiAtIEplc3QgY29uZmlndXJhdGlvbiBzY2FmZm9sZGluZ1xuICogLSBTdXBwb3J0IGZvciBxdGVzdHMgZnJhbWV3b3JrIGludGVncmF0aW9uXG4gKi9cblxuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcblxuLy8gQ29uZmlndXJhdGlvbiBjb25zdGFudHNcbmNvbnN0IERFRkFVTFRfQ09ORklHID0ge1xuICBTUkNfRElSOiAnc3JjJyxcbiAgVEVTVF9ESVI6ICd0ZXN0cy9pbnRlZ3JhdGlvbicsXG4gIEtOT1dOX01PQ0tTOiBbJ2F4aW9zJywgJ25vZGUtZmV0Y2gnLCAncGcnLCAnbW9uZ29vc2UnLCAnZnMnLCAncmVkaXMnXSxcbiAgVkFMSURfRVhUUzogWycudHMnLCAnLmpzJywgJy50c3gnLCAnLmpzeCddXG59O1xuXG4vLyBSZWdleCBwYXR0ZXJucyBmb3IgY29kZSBhbmFseXNpc1xuY29uc3QgUEFUVEVSTlMgPSB7XG4gIHF0ZXN0czogL2Zyb20gWydcIl1xdGVzdHNbJ1wiXS8sXG4gIGFwaTogL1xcYihhcHB8cm91dGVyKVxcLihnZXR8cG9zdHxwdXR8ZGVsZXRlfHBhdGNoKVxccypcXChcXHMqWydcImBdKFteJ1wiYF0rKVsnXCJgXS9naSxcbiAgZXhwb3J0czogL15cXHMqZXhwb3J0XFxzKyg/OmNvbnN0fGZ1bmN0aW9ufGNsYXNzKVxccysoW2EtekEtWjAtOV9dKykvZ20sXG4gIGltcG9ydHM6IC9mcm9tIFsnXCJdKFteJ1wiXSspWydcIl0vZ1xufTtcblxuY2xhc3MgVGVzdEdlbmVyYXRvciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuY29uZmlnID0geyAuLi5ERUZBVUxUX0NPTkZJRywgLi4ub3B0aW9ucyB9O1xuICAgIHRoaXMuc2Nhbm5lZCA9IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGRpcmVjdG9yeSBzaG91bGQgYmUgc2tpcHBlZCBkdXJpbmcgZGlzY292ZXJ5XG4gICAqL1xuICBzaG91bGRTa2lwRGlyZWN0b3J5KGRpck5hbWUpIHtcbiAgICBjb25zdCBza2lwUGF0dGVybnMgPSBbXG4gICAgICAnbm9kZV9tb2R1bGVzJywgJy5naXQnLCAnLm5leHQnLCAnZGlzdCcsICdidWlsZCcsICdjb3ZlcmFnZScsXG4gICAgICAnLnZzY29kZScsICcuaWRlYScsICdkb2NzJywgJ2RvY3VtZW50YXRpb24nLCAnYXNzZXRzJywgJ3B1YmxpYycsICdzdGF0aWMnLFxuICAgICAgJy5yZXBsaXRfY2FjaGUnLCAnLmNvbmZpZycsICcubnBtJywgJ2xvZ3MnXG4gICAgXTtcbiAgICByZXR1cm4gc2tpcFBhdHRlcm5zLmluY2x1ZGVzKGRpck5hbWUpIHx8IGRpck5hbWUuc3RhcnRzV2l0aCgnLicpO1xuICB9XG5cbiAgLyoqXG4gICAqIFdhbGsgZW50aXJlIHByb2plY3QgZGlyZWN0b3J5IHN0cnVjdHVyZSwgcmVzcGVjdGluZyBza2lwIHBhdHRlcm5zXG4gICAqL1xuICB3YWxrUHJvamVjdCgpIHtcbiAgICBjb25zdCBjdXJyZW50RGlyID0gcHJvY2Vzcy5jd2QoKTtcbiAgICByZXR1cm4gdGhpcy53YWxrUmVjdXJzaXZlKGN1cnJlbnREaXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY3Vyc2l2ZWx5IHdhbGsgZGlyZWN0b3J5IGFuZCByZXR1cm4gYWxsIGZpbGUgcGF0aHMsIHNraXBwaW5nIGlycmVsZXZhbnQgZGlyZWN0b3JpZXNcbiAgICovXG4gIHdhbGtSZWN1cnNpdmUoZGlyKSB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGRpcikpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGZzLnJlYWRkaXJTeW5jKGRpciwgeyB3aXRoRmlsZVR5cGVzOiB0cnVlIH0pLmZsYXRNYXAoZW50cnkgPT4ge1xuICAgICAgY29uc3QgZnVsbCA9IHBhdGgucmVzb2x2ZShkaXIsIGVudHJ5Lm5hbWUpO1xuICAgICAgXG4gICAgICBpZiAoZW50cnkuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgICAvLyBTa2lwIGRpcmVjdG9yaWVzIHRoYXQgc2hvdWxkbid0IGNvbnRhaW4gdGVzdHMgb3Igc291cmNlIGZpbGVzXG4gICAgICAgIGlmICh0aGlzLnNob3VsZFNraXBEaXJlY3RvcnkoZW50cnkubmFtZSkpIHtcbiAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMud2Fsa1JlY3Vyc2l2ZShmdWxsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBbZnVsbF07XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTGVnYWN5IHdhbGsgbWV0aG9kIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSAod2Fsa3Mgc2luZ2xlIGRpcmVjdG9yeSlcbiAgICovXG4gIHdhbGsoZGlyKSB7XG4gICAgaWYgKCFmcy5leGlzdHNTeW5jKGRpcikpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGZzLnJlYWRkaXJTeW5jKGRpciwgeyB3aXRoRmlsZVR5cGVzOiB0cnVlIH0pLmZsYXRNYXAoZW50cnkgPT4ge1xuICAgICAgY29uc3QgZnVsbCA9IHBhdGgucmVzb2x2ZShkaXIsIGVudHJ5Lm5hbWUpO1xuICAgICAgcmV0dXJuIGVudHJ5LmlzRGlyZWN0b3J5KCkgPyB0aGlzLndhbGsoZnVsbCkgOiBmdWxsO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhdGVnb3JpemUgZGlzY292ZXJlZCBmaWxlcyBpbnRvIHNvdXJjZSBmaWxlcyBhbmQgZXhpc3RpbmcgdGVzdHNcbiAgICovXG4gIGNhdGVnb3JpemVGaWxlcyhmaWxlcykge1xuICAgIGNvbnN0IHNvdXJjZUZpbGVzID0gW107XG4gICAgY29uc3QgZXhpc3RpbmdUZXN0cyA9IFtdO1xuICAgIFxuICAgIGZpbGVzLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZSk7XG4gICAgICBjb25zdCBiYXNlbmFtZSA9IHBhdGguYmFzZW5hbWUoZmlsZSk7XG4gICAgICBcbiAgICAgIC8vIFNraXAgZmlsZXMgd2l0aCBpbnZhbGlkIGV4dGVuc2lvbnNcbiAgICAgIGlmICghdGhpcy5jb25maWcuVkFMSURfRVhUUy5pbmNsdWRlcyhleHQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIHRlc3QgZmlsZVxuICAgICAgaWYgKHRoaXMuaXNUZXN0RmlsZShiYXNlbmFtZSkpIHtcbiAgICAgICAgZXhpc3RpbmdUZXN0cy5wdXNoKGZpbGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBzb3VyY2UgZmlsZSBhbHJlYWR5IGhhcyBhIGNvcnJlc3BvbmRpbmcgdGVzdFxuICAgICAgICBjb25zdCBoYXNUZXN0ID0gdGhpcy5oYXNDb3JyZXNwb25kaW5nVGVzdChmaWxlLCBmaWxlcyk7XG4gICAgICAgIGlmICghaGFzVGVzdCkge1xuICAgICAgICAgIHNvdXJjZUZpbGVzLnB1c2goZmlsZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4geyBzb3VyY2VGaWxlcywgZXhpc3RpbmdUZXN0cyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGZpbGVuYW1lIGluZGljYXRlcyBpdCdzIGEgdGVzdCBmaWxlXG4gICAqL1xuICBpc1Rlc3RGaWxlKGZpbGVuYW1lKSB7XG4gICAgY29uc3QgdGVzdFBhdHRlcm5zID0gW1xuICAgICAgL1xcLnRlc3RcXC4vLFxuICAgICAgL1xcLnNwZWNcXC4vLFxuICAgICAgL190ZXN0XFwuLyxcbiAgICAgIC9fc3BlY1xcLi8sXG4gICAgICAvXFwuZTJlXFwuLyxcbiAgICAgIC9cXC5pbnRlZ3JhdGlvblxcLi9cbiAgICBdO1xuICAgIFxuICAgIHJldHVybiB0ZXN0UGF0dGVybnMuc29tZShwYXR0ZXJuID0+IHBhdHRlcm4udGVzdChmaWxlbmFtZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIGEgc291cmNlIGZpbGUgaGFzIGEgY29ycmVzcG9uZGluZyB0ZXN0IGZpbGVcbiAgICovXG4gIGhhc0NvcnJlc3BvbmRpbmdUZXN0KHNvdXJjZUZpbGUsIGFsbEZpbGVzKSB7XG4gICAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKHNvdXJjZUZpbGUpO1xuICAgIGNvbnN0IGJhc2VuYW1lID0gcGF0aC5iYXNlbmFtZShzb3VyY2VGaWxlLCBwYXRoLmV4dG5hbWUoc291cmNlRmlsZSkpO1xuICAgIGNvbnN0IGV4dCA9IHBhdGguZXh0bmFtZShzb3VyY2VGaWxlKTtcbiAgICBcbiAgICAvLyBDb21tb24gdGVzdCBmaWxlIHBhdHRlcm5zIHRvIGxvb2sgZm9yXG4gICAgY29uc3QgdGVzdFBhdHRlcm5zID0gW1xuICAgICAgYCR7YmFzZW5hbWV9LnRlc3Qke2V4dH1gLFxuICAgICAgYCR7YmFzZW5hbWV9LnNwZWMke2V4dH1gLFxuICAgICAgYCR7YmFzZW5hbWV9X3Rlc3Qke2V4dH1gLFxuICAgICAgYCR7YmFzZW5hbWV9X3NwZWMke2V4dH1gLFxuICAgICAgYCR7YmFzZW5hbWV9LnRlc3QuanNgLFxuICAgICAgYCR7YmFzZW5hbWV9LnNwZWMuanNgLFxuICAgICAgYCR7YmFzZW5hbWV9LnRlc3QudHNgLFxuICAgICAgYCR7YmFzZW5hbWV9LnNwZWMudHNgXG4gICAgXTtcbiAgICBcbiAgICAvLyBMb29rIGZvciB0ZXN0IGZpbGVzIGluIHRoZSBzYW1lIGRpcmVjdG9yeVxuICAgIGNvbnN0IHNhbWVEaXJlY3RvcnlUZXN0cyA9IHRlc3RQYXR0ZXJucy5tYXAocGF0dGVybiA9PiBcbiAgICAgIHBhdGguam9pbihkaXIsIHBhdHRlcm4pXG4gICAgKTtcbiAgICBcbiAgICAvLyBMb29rIGZvciB0ZXN0IGZpbGVzIGluIGNvbW1vbiB0ZXN0IGRpcmVjdG9yaWVzXG4gICAgY29uc3QgdGVzdERpcmVjdG9yaWVzID0gWyd0ZXN0cycsICd0ZXN0JywgJ19fdGVzdHNfXycsICdzcGVjJ107XG4gICAgY29uc3QgdGVzdERpcmVjdG9yeVRlc3RzID0gdGVzdERpcmVjdG9yaWVzLmZsYXRNYXAodGVzdERpciA9PiB7XG4gICAgICBjb25zdCB0ZXN0UGF0aCA9IHBhdGguam9pbihkaXIsIHRlc3REaXIpO1xuICAgICAgcmV0dXJuIHRlc3RQYXR0ZXJucy5tYXAocGF0dGVybiA9PiBwYXRoLmpvaW4odGVzdFBhdGgsIHBhdHRlcm4pKTtcbiAgICB9KTtcbiAgICBcbiAgICAvLyBDaGVjayBpZiBhbnkgb2YgdGhlc2UgdGVzdCBmaWxlcyBleGlzdFxuICAgIGNvbnN0IGFsbFRlc3RQYXRocyA9IFsuLi5zYW1lRGlyZWN0b3J5VGVzdHMsIC4uLnRlc3REaXJlY3RvcnlUZXN0c107XG4gICAgcmV0dXJuIGFsbFRlc3RQYXRocy5zb21lKHRlc3RQYXRoID0+IFxuICAgICAgYWxsRmlsZXMuc29tZShmaWxlID0+IHBhdGgucmVzb2x2ZShmaWxlKSA9PT0gcGF0aC5yZXNvbHZlKHRlc3RQYXRoKSlcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHRlc3QgZmlsZSBwYXRoIGJhc2VkIG9uIHNvdXJjZSBmaWxlIGFuZCB0ZXN0IHR5cGVcbiAgICogU3VwcG9ydHMgYm90aCBmZWF0dXJlLWZpcnN0ICh0ZXN0cyBhbG9uZ3NpZGUgZmlsZXMpIGFuZCB0cmFkaXRpb25hbCAoc2VwYXJhdGUgdGVzdCBkaXJlY3RvcnkpIHN0cnVjdHVyZXNcbiAgICovXG4gIGdldFJlbGF0aXZlVGVzdFBhdGgoZmlsZSwgdHlwZSA9ICd1bml0Jykge1xuICAgIGNvbnN0IGRpciA9IHBhdGguZGlybmFtZShmaWxlKTtcbiAgICBjb25zdCBiYXNlbmFtZSA9IHBhdGguYmFzZW5hbWUoZmlsZSwgcGF0aC5leHRuYW1lKGZpbGUpKTtcbiAgICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZSk7XG4gICAgXG4gICAgaWYgKHR5cGUgPT09ICd1bml0Jykge1xuICAgICAgLy8gRm9yIHVuaXQgdGVzdHMsIHBsYWNlIHRoZW0gYWxvbmdzaWRlIHRoZSBzb3VyY2UgZmlsZSB3aXRoIG1hdGNoaW5nIGV4dGVuc2lvblxuICAgICAgcmV0dXJuIHBhdGguam9pbihkaXIsIGAke2Jhc2VuYW1lfS50ZXN0JHtleHR9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZvciBBUEkvaW50ZWdyYXRpb24gdGVzdHMsIHVzZSB0aGUgY29uZmlndXJlZCB0ZXN0IGRpcmVjdG9yeVxuICAgICAgLy8gUHJlc2VydmUgVHlwZVNjcmlwdCBmb3IgLnRzLy50c3ggZmlsZXMsIHVzZSBKYXZhU2NyaXB0IGZvciBvdGhlcnNcbiAgICAgIGNvbnN0IHJlbCA9IHBhdGgucmVsYXRpdmUocHJvY2Vzcy5jd2QoKSwgZmlsZSk7XG4gICAgICBjb25zdCB0ZXN0RXh0ID0gWycudHMnLCAnLnRzeCddLmluY2x1ZGVzKGV4dCkgPyAnLnRzJyA6ICcuanMnO1xuICAgICAgcmV0dXJuIHBhdGguam9pbih0aGlzLmNvbmZpZy5URVNUX0RJUiwgcmVsLnJlcGxhY2UoL1xcLlt0al1zeD8kLywgYC50ZXN0JHt0ZXN0RXh0fWApLnJlcGxhY2UoL1tcXFxcL10vZywgJ19fJykpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGUgZGlyZWN0b3J5IGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICovXG4gIGNyZWF0ZURpcihwKSB7XG4gICAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKHApO1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhkaXIpKSB7XG4gICAgICBmcy5ta2RpclN5bmMoZGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogV3JpdGUgZmlsZSBvbmx5IGlmIGl0IGRvZXNuJ3QgYWxyZWFkeSBleGlzdFxuICAgKi9cbiAgd3JpdGVJZk1pc3NpbmcocCwgY29udGVudCkge1xuICAgIGlmICghZnMuZXhpc3RzU3luYyhwKSkge1xuICAgICAgdGhpcy5jcmVhdGVEaXIocCk7XG4gICAgICBmcy53cml0ZUZpbGVTeW5jKHAsIGNvbnRlbnQsICd1dGY4Jyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgaW1wb3J0ZWQgbW9kdWxlcyBmcm9tIGZpbGUgY29udGVudFxuICAgKi9cbiAgZ2V0VXNlZE1vZHVsZXMoY29udGVudCkge1xuICAgIHJldHVybiBbLi4uY29udGVudC5tYXRjaEFsbChQQVRURVJOUy5pbXBvcnRzKV1cbiAgICAgIC5tYXAobSA9PiBtWzFdKVxuICAgICAgLmZpbHRlcih4ID0+ICF4LnN0YXJ0c1dpdGgoJy4nKSAmJiAheC5zdGFydHNXaXRoKCcvJykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHVuaXQgdGVzdCBjb250ZW50IGZvciBhIGZpbGUgLSBvcHRpbWl6ZWQgZm9yIHNwZWVkXG4gICAqL1xuICBjcmVhdGVVbml0VGVzdChmaWxlLCBleHBvcnRzLCB1c2VzUXRlc3RzLCBtb2Nrcykge1xuICAgIGNvbnN0IGV4dCA9IHBhdGguZXh0bmFtZShmaWxlKTtcbiAgICBjb25zdCBpc1R5cGVTY3JpcHQgPSBbJy50cycsICcudHN4J10uaW5jbHVkZXMoZXh0KTtcbiAgICBcbiAgICBjb25zdCBsaW5lcyA9IFtgLy8gQXV0by1nZW5lcmF0ZWQgdW5pdCB0ZXN0IGZvciAke3BhdGguYmFzZW5hbWUoZmlsZSl9IC0gb3B0aW1pemVkIGZvciBzcGVlZGBdO1xuICAgIFxuICAgIC8vIEZhc3QgdGVzdCBzZXR1cCAtIG1pbmltYWwgaW1wb3J0c1xuICAgIGlmICh1c2VzUXRlc3RzKSB7XG4gICAgICBpZiAoaXNUeXBlU2NyaXB0KSB7XG4gICAgICAgIGxpbmVzLnB1c2goYGltcG9ydCB7IHRlc3QgfSBmcm9tICdxdGVzdHMnO2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGluZXMucHVzaChgY29uc3QgeyB0ZXN0IH0gPSByZXF1aXJlKCdxdGVzdHMnKTtgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQmF0Y2ggbW9jayBhbGwgbGlicmFyaWVzIGF0IG9uY2UgZm9yIHBlcmZvcm1hbmNlXG4gICAgaWYgKG1vY2tzLmxlbmd0aCA+IDApIHtcbiAgICAgIGxpbmVzLnB1c2goYC8vIE1vY2sgZXh0ZXJuYWwgZGVwZW5kZW5jaWVzIGZvciBzcGVlZGApO1xuICAgICAgbW9ja3MuZm9yRWFjaChsaWIgPT4ge1xuICAgICAgICBsaW5lcy5wdXNoKGBqZXN0Lm1vY2soJyR7bGlifScsICgpID0+ICh7IF9fZXNNb2R1bGU6IHRydWUsIGRlZmF1bHQ6IGplc3QuZm4oKSwgLi4uamVzdC5yZXF1aXJlQWN0dWFsKCcke2xpYn0nKSB9KSk7YCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGlzVHlwZVNjcmlwdCkge1xuICAgICAgY29uc3QgYmFzZW5hbWUgPSBwYXRoLmJhc2VuYW1lKGZpbGUsIHBhdGguZXh0bmFtZShmaWxlKSk7XG4gICAgICBsaW5lcy5wdXNoKGBpbXBvcnQgKiBhcyBtb2QgZnJvbSAnLi8ke2Jhc2VuYW1lfSc7YCwgJycpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaW5lcy5wdXNoKGBjb25zdCBtb2QgPSByZXF1aXJlKCcuLyR7cGF0aC5iYXNlbmFtZShmaWxlKX0nKTtgLCAnJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIFN0YW5kYXJkIEplc3Qgd2l0aCBvcHRpbWl6ZWQgcGVyZm9ybWFuY2VcbiAgICBsaW5lcy5wdXNoKGBkZXNjcmliZSgnJHtwYXRoLmJhc2VuYW1lKGZpbGUpfScsICgpID0+IHtgKTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGZuIG9mIGV4cG9ydHMpIHtcbiAgICAgIGxpbmVzLnB1c2goYCAgdGVzdCgnJHtmbn0gd29ya3MnLCBhc3luYyAoKSA9PiB7YCk7XG4gICAgICBsaW5lcy5wdXNoKGAgICAgLy8gRmFzdCBhc3NlcnRpb24gLSBUT0RPOiBpbXBsZW1lbnQgc3BlY2lmaWMgdGVzdCBsb2dpY2ApO1xuICAgICAgbGluZXMucHVzaChgICAgIGV4cGVjdCh0eXBlb2YgbW9kLiR7Zm59KS50b0JlRGVmaW5lZCgpO2ApO1xuICAgICAgbGluZXMucHVzaCgnICB9KTsnKTtcbiAgICB9XG4gICAgXG4gICAgbGluZXMucHVzaCgnfSk7XFxuJyk7XG4gICAgcmV0dXJuIGxpbmVzLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIEFQSSB0ZXN0IGNvbnRlbnQgZm9yIGFuIGVuZHBvaW50IC0gb3B0aW1pemVkIGZvciBzcGVlZFxuICAgKi9cbiAgY3JlYXRlQXBpVGVzdChtZXRob2QsIHJvdXRlLCBpc1R5cGVTY3JpcHQgPSBmYWxzZSkge1xuICAgIGNvbnN0IGxpbmVzID0gW2AvLyBBdXRvLWdlbmVyYXRlZCBBUEkgdGVzdCBmb3IgJHttZXRob2QudG9VcHBlckNhc2UoKX0gJHtyb3V0ZX0gLSBvcHRpbWl6ZWQgZm9yIHNwZWVkYF07XG4gICAgXG4gICAgaWYgKGlzVHlwZVNjcmlwdCkge1xuICAgICAgbGluZXMucHVzaChgaW1wb3J0IHsgaHR0cFRlc3QgfSBmcm9tICdxdGVzdHMvbGliL2VudlV0aWxzJztgLCAnJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpbmVzLnB1c2goYGNvbnN0IHsgaHR0cFRlc3QgfSA9IHJlcXVpcmUoJ3F0ZXN0cy9saWIvZW52VXRpbHMnKTtgLCAnJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIFN0YW5kYXJkIEplc3Qgd2l0aCBvcHRpbWl6ZWQgcGVyZm9ybWFuY2VcbiAgICBsaW5lcy5wdXNoKGBkZXNjcmliZSgnJHttZXRob2QudG9VcHBlckNhc2UoKX0gJHtyb3V0ZX0nLCAoKSA9PiB7YCk7XG4gICAgbGluZXMucHVzaChgICAvLyBTaGFyZWQgYXBwIHNldHVwIGZvciBwZXJmb3JtYW5jZWApO1xuICAgIGxpbmVzLnB1c2goYCAgbGV0IHNoYXJlZEFwcDtgKTtcbiAgICBsaW5lcy5wdXNoKGAgIGJlZm9yZUFsbCgoKSA9PiB7YCk7XG4gICAgbGluZXMucHVzaChgICAgIHNoYXJlZEFwcCA9IGh0dHBUZXN0LmNyZWF0ZU1vY2tBcHAoKTtgKTtcbiAgICBsaW5lcy5wdXNoKGAgIH0pO2ApO1xuICAgIGxpbmVzLnB1c2goYGApO1xuICAgIFxuICAgIGxpbmVzLnB1c2goYCAgdGVzdCgnc2hvdWxkIHN1Y2NlZWQnLCBhc3luYyAoKSA9PiB7YCk7XG4gICAgbGluZXMucHVzaChgICAgIC8vIFJldXNlIHNoYXJlZCBhcHAgZm9yIHNwZWVkYCk7XG4gICAgbGluZXMucHVzaChgICAgIGNvbnN0IGFwcCA9IGh0dHBUZXN0LmNyZWF0ZU1vY2tBcHAoKTtgKTtcbiAgICBsaW5lcy5wdXNoKGAgICAgYXBwLiR7bWV0aG9kLnRvTG93ZXJDYXNlKCl9KCcke3JvdXRlfScsIChyZXEsIHJlcykgPT4ge2ApO1xuICAgIGxpbmVzLnB1c2goYCAgICAgIHJlcy5zdGF0dXNDb2RlID0gMjAwO2ApO1xuICAgIGxpbmVzLnB1c2goYCAgICAgIHJlcy5zZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7YCk7XG4gICAgbGluZXMucHVzaChgICAgICAgcmVzLmVuZChKU09OLnN0cmluZ2lmeSh7IHN1Y2Nlc3M6IHRydWUgfSkpO2ApO1xuICAgIGxpbmVzLnB1c2goYCAgICB9KTtgKTtcbiAgICBsaW5lcy5wdXNoKGAgICAgYCk7XG4gICAgbGluZXMucHVzaChgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGh0dHBUZXN0LnN1cGVydGVzdChhcHApYCk7XG4gICAgbGluZXMucHVzaChgICAgICAgLiR7bWV0aG9kLnRvTG93ZXJDYXNlKCl9KCcke3JvdXRlfScpYCk7XG4gICAgbGluZXMucHVzaChgICAgICAgLmV4cGVjdCgyMDApYCk7XG4gICAgbGluZXMucHVzaChgICAgICAgLmVuZCgpO2ApO1xuICAgIGxpbmVzLnB1c2goYCAgICBgKTtcbiAgICBsaW5lcy5wdXNoKGAgICAgZXhwZWN0KHJlcy5ib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7YCk7XG4gICAgbGluZXMucHVzaCgnICB9KTsnLCAnJyk7XG4gICAgXG4gICAgbGluZXMucHVzaCgnICB0ZXN0KFxcJ3Nob3VsZCBoYW5kbGUgZXJyb3IgcmVzcG9uc2VzXFwnLCBhc3luYyAoKSA9PiB7Jyk7XG4gICAgbGluZXMucHVzaChgICAgIGNvbnN0IGFwcCA9IGh0dHBUZXN0LmNyZWF0ZU1vY2tBcHAoKTtgKTtcbiAgICBsaW5lcy5wdXNoKGAgICAgYXBwLiR7bWV0aG9kLnRvTG93ZXJDYXNlKCl9KCcke3JvdXRlfScsIChyZXEsIHJlcykgPT4ge2ApO1xuICAgIGxpbmVzLnB1c2goYCAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDAwO2ApO1xuICAgIGxpbmVzLnB1c2goYCAgICAgIHJlcy5zZXRIZWFkZXIoJ2NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7YCk7XG4gICAgbGluZXMucHVzaChgICAgICAgcmVzLmVuZChKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAnQmFkIHJlcXVlc3QnIH0pKTtgKTtcbiAgICBsaW5lcy5wdXNoKGAgICAgfSk7YCk7XG4gICAgbGluZXMucHVzaChgICAgIGApO1xuICAgIGxpbmVzLnB1c2goYCAgICBjb25zdCByZXMgPSBhd2FpdCBodHRwVGVzdC5zdXBlcnRlc3QoYXBwKWApO1xuICAgIGxpbmVzLnB1c2goYCAgICAgIC4ke21ldGhvZC50b0xvd2VyQ2FzZSgpfSgnJHtyb3V0ZX0nKWApO1xuICAgIGxpbmVzLnB1c2goYCAgICAgIC5leHBlY3QoNDAwKWApO1xuICAgIGxpbmVzLnB1c2goYCAgICAgIC5lbmQoKTtgKTtcbiAgICBsaW5lcy5wdXNoKGAgICAgYCk7XG4gICAgbGluZXMucHVzaChgICAgIGV4cGVjdChyZXMuYm9keS5lcnJvcikudG9CZSgnQmFkIHJlcXVlc3QnKTtgKTtcbiAgICBsaW5lcy5wdXNoKCcgIH0pOycpO1xuICAgIGxpbmVzLnB1c2goJ30pO1xcbicpO1xuICAgIHJldHVybiBsaW5lcy5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplIGEgc2luZ2xlIGZpbGUgYW5kIGdlbmVyYXRlIGFwcHJvcHJpYXRlIHRlc3RzXG4gICAqL1xuICBhbmFseXplKGZpbGUpIHtcbiAgICBjb25zdCBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZSk7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5WQUxJRF9FWFRTLmluY2x1ZGVzKGV4dCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGY4Jyk7XG4gICAgY29uc3QgdXNlc1F0ZXN0cyA9IFBBVFRFUk5TLnF0ZXN0cy50ZXN0KGNvbnRlbnQpO1xuICAgIGNvbnN0IGltcG9ydHMgPSB0aGlzLmdldFVzZWRNb2R1bGVzKGNvbnRlbnQpO1xuICAgIGNvbnN0IG1vY2tUYXJnZXRzID0gaW1wb3J0cy5maWx0ZXIoaSA9PiBcbiAgICAgIHRoaXMuY29uZmlnLktOT1dOX01PQ0tTLmluY2x1ZGVzKGkpICYmIGkgIT09ICdxdGVzdHMnXG4gICAgKTtcblxuICAgIC8vIEdlbmVyYXRlIHVuaXQgdGVzdHMgZm9yIGV4cG9ydGVkIGZ1bmN0aW9ucy9jbGFzc2VzXG4gICAgY29uc3QgZXhwb3J0cyA9IFsuLi5jb250ZW50Lm1hdGNoQWxsKFBBVFRFUk5TLmV4cG9ydHMpXS5tYXAobSA9PiBtWzFdKTtcbiAgICBpZiAoZXhwb3J0cy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCB0ZXN0UGF0aCA9IHRoaXMuZ2V0UmVsYXRpdmVUZXN0UGF0aChmaWxlLCAndW5pdCcpO1xuICAgICAgY29uc3QgY3JlYXRlZCA9IHRoaXMud3JpdGVJZk1pc3NpbmcoXG4gICAgICAgIHRlc3RQYXRoLCBcbiAgICAgICAgdGhpcy5jcmVhdGVVbml0VGVzdChmaWxlLCBleHBvcnRzLCB1c2VzUXRlc3RzLCBtb2NrVGFyZ2V0cylcbiAgICAgICk7XG4gICAgICBpZiAoY3JlYXRlZCkge1xuICAgICAgICB0aGlzLnNjYW5uZWQucHVzaCh7IFxuICAgICAgICAgIHR5cGU6ICd1bml0JywgXG4gICAgICAgICAgZmlsZTogcGF0aC5yZWxhdGl2ZSgnLicsIHRlc3RQYXRoKSBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgQVBJIHRlc3RzIGZvciBkZXRlY3RlZCByb3V0ZXNcbiAgICBjb25zdCBhcGlzID0gWy4uLmNvbnRlbnQubWF0Y2hBbGwoUEFUVEVSTlMuYXBpKV07XG4gICAgZm9yIChjb25zdCBbLCAsIG1ldGhvZCwgcm91dGVdIG9mIGFwaXMpIHtcbiAgICAgIGNvbnN0IGlzVHlwZVNjcmlwdCA9IFsnLnRzJywgJy50c3gnXS5pbmNsdWRlcyhleHQpO1xuICAgICAgY29uc3QgdGVzdFBhdGggPSB0aGlzLmdldFJlbGF0aXZlVGVzdFBhdGgoZmlsZSwgJ2FwaScpXG4gICAgICAgIC5yZXBsYWNlKC9cXC50ZXN0XFwuW2p0XXMkLywgYF9fJHttZXRob2QudG9Mb3dlckNhc2UoKX0udGVzdCR7aXNUeXBlU2NyaXB0ID8gJy50cycgOiAnLmpzJ31gKTtcbiAgICAgIGNvbnN0IGNyZWF0ZWQgPSB0aGlzLndyaXRlSWZNaXNzaW5nKFxuICAgICAgICB0ZXN0UGF0aCwgXG4gICAgICAgIHRoaXMuY3JlYXRlQXBpVGVzdChtZXRob2QsIHJvdXRlLCBpc1R5cGVTY3JpcHQpXG4gICAgICApO1xuICAgICAgaWYgKGNyZWF0ZWQpIHtcbiAgICAgICAgdGhpcy5zY2FubmVkLnB1c2goeyBcbiAgICAgICAgICB0eXBlOiAnYXBpJywgXG4gICAgICAgICAgZmlsZTogcGF0aC5yZWxhdGl2ZSgnLicsIHRlc3RQYXRoKSBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBKZXN0IGNvbmZpZ3VyYXRpb24gYW5kIHNldHVwIGZpbGVzXG4gICAqL1xuICBzY2FmZm9sZEplc3RTZXR1cCgpIHtcbiAgICBjb25zdCBjb25maWcgPSBgXG4vLyBqZXN0LmNvbmZpZy5qc1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHByZXNldDogJ3RzLWplc3QnLFxuICB0ZXN0RW52aXJvbm1lbnQ6ICdub2RlJyxcbiAgc2V0dXBGaWxlc0FmdGVyRW52OiBbJy4vdGVzdHMvc2V0dXAudHMnXSxcbiAgbW9kdWxlRmlsZUV4dGVuc2lvbnM6IFsndHMnLCAnanMnLCAnanNvbiddLFxuICByb290czogWyc8cm9vdERpcj4vc3JjJywgJzxyb290RGlyPi90ZXN0cyddLFxufTtcbmAudHJpbSgpO1xuXG4gICAgY29uc3Qgc2V0dXAgPSBgXG4vLyB0ZXN0cy9zZXR1cC50c1xubGV0IHNlcnZlcjtcblxuYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgY29uc3QgYXBwID0gcmVxdWlyZSgnLi4vc3JjL2FwcCcpLmRlZmF1bHQgfHwgcmVxdWlyZSgnLi4vc3JjL2FwcCcpO1xuICBzZXJ2ZXIgPSBhcHAubGlzdGVuKDQwMDAsICgpID0+IGNvbnNvbGUubG9nKCdUZXN0IHNlcnZlciBzdGFydGVkJykpO1xufSk7XG5cbmFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgaWYgKHNlcnZlcikgc2VydmVyLmNsb3NlKCk7XG59KTtcbmAudHJpbSgpO1xuXG4gICAgdGhpcy53cml0ZUlmTWlzc2luZygnamVzdC5jb25maWcuanMnLCBjb25maWcpO1xuICAgIHRoaXMud3JpdGVJZk1pc3NpbmcoJ3Rlc3RzL3NldHVwLnRzJywgc2V0dXApO1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHF0ZXN0cyB0ZXN0IHJ1bm5lciBmaWxlIGFuZCB1cGRhdGUgcGFja2FnZS5qc29uXG4gICAqIENyZWF0ZXMgcXRlc3RzLXJ1bm5lci5qcyBhbmQgdXBkYXRlcyB0aGUgdGVzdCBzY3JpcHQgaW4gcGFja2FnZS5qc29uXG4gICAqIEF1dG9tYXRpY2FsbHkgaGFuZGxlcyBFUyBtb2R1bGUgY29tcGF0aWJpbGl0eVxuICAgKi9cbiAgZ2VuZXJhdGVUZXN0UnVubmVyKCkge1xuICAgIGNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbiAgICBjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHByb2plY3QgdXNlcyBFUyBtb2R1bGVzXG4gICAgY29uc3QgaXNFU01vZHVsZVByb2plY3QgPSB0aGlzLmlzRVNNb2R1bGVQcm9qZWN0KCk7XG4gICAgXG4gICAgLy8gUmVhZCB0aGUgZXhpc3RpbmcgcXRlc3RzLXJ1bm5lci5qcyBhcyB0ZW1wbGF0ZVxuICAgIGNvbnN0IHRlbXBsYXRlUGF0aCA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLicsICdxdGVzdHMtcnVubmVyLmpzJyk7XG4gICAgbGV0IHJ1bm5lckNvbnRlbnQ7XG4gICAgXG4gICAgaWYgKGZzLmV4aXN0c1N5bmModGVtcGxhdGVQYXRoKSkge1xuICAgICAgcnVubmVyQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyh0ZW1wbGF0ZVBhdGgsICd1dGY4Jyk7XG4gICAgICBcbiAgICAgIC8vIENvbnZlcnQgQ29tbW9uSlMgdG8gRVMgbW9kdWxlcyBpZiBuZWVkZWRcbiAgICAgIGlmIChpc0VTTW9kdWxlUHJvamVjdCkge1xuICAgICAgICBydW5uZXJDb250ZW50ID0gdGhpcy5jb252ZXJ0VG9FU01vZHVsZShydW5uZXJDb250ZW50KTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gR2VuZXJhdGUgYXBwcm9wcmlhdGUgdGVtcGxhdGUgYmFzZWQgb24gbW9kdWxlIHR5cGVcbiAgICAgIGlmIChpc0VTTW9kdWxlUHJvamVjdCkge1xuICAgICAgICBydW5uZXJDb250ZW50ID0gdGhpcy5nZW5lcmF0ZUVTTW9kdWxlVGVtcGxhdGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJ1bm5lckNvbnRlbnQgPSB0aGlzLmdlbmVyYXRlQ29tbW9uSlNUZW1wbGF0ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBjcmVhdGVkID0gdGhpcy53cml0ZUlmTWlzc2luZygncXRlc3RzLXJ1bm5lci5qcycsIHJ1bm5lckNvbnRlbnQpO1xuICAgIFxuICAgIGlmIChjcmVhdGVkKSB7XG4gICAgICB0aGlzLnVwZGF0ZVBhY2thZ2VKc29uVGVzdFNjcmlwdCgpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgY3VycmVudCBwcm9qZWN0IHVzZXMgRVMgbW9kdWxlc1xuICAgKi9cbiAgaXNFU01vZHVsZVByb2plY3QoKSB7XG4gICAgY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuICAgIGNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBhY2thZ2VQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdwYWNrYWdlLmpzb24nKTtcbiAgICAgIGlmICghZnMuZXhpc3RzU3luYyhwYWNrYWdlUGF0aCkpIHJldHVybiBmYWxzZTtcbiAgICAgIFxuICAgICAgY29uc3QgcGFja2FnZUpzb24gPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwYWNrYWdlUGF0aCwgJ3V0ZjgnKSk7XG4gICAgICByZXR1cm4gcGFja2FnZUpzb24udHlwZSA9PT0gJ21vZHVsZSc7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnQgQ29tbW9uSlMgY29kZSB0byBFUyBtb2R1bGUgc3ludGF4XG4gICAqL1xuICBjb252ZXJ0VG9FU01vZHVsZShjb21tb25KU0NvZGUpIHtcbiAgICByZXR1cm4gY29tbW9uSlNDb2RlXG4gICAgICAucmVwbGFjZSgvY29uc3QgZnMgPSByZXF1aXJlXFwoJ2ZzJ1xcKTsvLCBcImltcG9ydCBmcyBmcm9tICdmcyc7XCIpXG4gICAgICAucmVwbGFjZSgvY29uc3QgcGF0aCA9IHJlcXVpcmVcXCgncGF0aCdcXCk7LywgXCJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcIilcbiAgICAgIC5yZXBsYWNlKC9jb25zdCB7IHNwYXduIH0gPSByZXF1aXJlXFwoJ2NoaWxkX3Byb2Nlc3MnXFwpOy8sIFwiaW1wb3J0IHsgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcIilcbiAgICAgIC5yZXBsYWNlKC9jb25zdCBvcyA9IHJlcXVpcmVcXCgnb3MnXFwpOy8sIFwiaW1wb3J0IG9zIGZyb20gJ29zJztcIilcbiAgICAgIC5yZXBsYWNlKC9yZXF1aXJlXFwubWFpbiA9PT0gbW9kdWxlLywgXCJpbXBvcnQubWV0YS51cmwgPT09IGBmaWxlOi8vJHtwcm9jZXNzLmFyZ3ZbMV19YFwiKVxuICAgICAgLnJlcGxhY2UoL21vZHVsZVxcLmV4cG9ydHMgPSBUZXN0UnVubmVyOy8sIFwiZXhwb3J0IGRlZmF1bHQgVGVzdFJ1bm5lcjtcIilcbiAgICAgIC5yZXBsYWNlKC9cXC9cXC8gR2VuZXJhdGVkIGFzOiBxdGVzdHMtcnVubmVyXFwuanMvLCBcIi8vIEdlbmVyYXRlZCBhczogcXRlc3RzLXJ1bm5lci5qcyAoRVMgTW9kdWxlIENvbXBhdGlibGUpXCIpXG4gICAgICAucmVwbGFjZSgvLS10ZXN0UGF0aFBhdHRlcm4vZywgXCItLXRlc3RQYXRoUGF0dGVyblwiKTsgLy8gRW5zdXJlIGNvcnJlY3QgSmVzdCBDTEkgcGFyYW1ldGVyIGluIEVTIG1vZHVsZXNcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBFUyBtb2R1bGUgdGVtcGxhdGVcbiAgICovXG4gIGdlbmVyYXRlRVNNb2R1bGVUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gYC8vIHF0ZXN0cyBUZXN0IFJ1bm5lciAtIEF1dG8tZ2VuZXJhdGVkIGJ5IHF0ZXN0cyAoRVMgTW9kdWxlKVxuLy8gVGhpcyBmaWxlIGRpc2NvdmVycyBhbmQgcnVucyBhbGwgdGVzdHMgaW4geW91ciBwcm9qZWN0XG5cbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IHNwYXduIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgb3MgZnJvbSAnb3MnO1xuXG4vLyBCYXNpYyBFUyBtb2R1bGUgdGVzdCBydW5uZXIgaW1wbGVtZW50YXRpb25cbmNvbnNvbGUubG9nKCfwn6eqIEJhc2ljIHF0ZXN0cyBUZXN0IFJ1bm5lciAoRVMgTW9kdWxlKScpO1xuY29uc29sZS5sb2coJ1J1biB0ZXN0cyB3aXRoOiBucG0gdGVzdCcpO1xuYDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSBDb21tb25KUyB0ZW1wbGF0ZSAgXG4gICAqL1xuICBnZW5lcmF0ZUNvbW1vbkpTVGVtcGxhdGUoKSB7XG4gICAgcmV0dXJuIGAvLyBxdGVzdHMgVGVzdCBSdW5uZXIgLSBBdXRvLWdlbmVyYXRlZCBieSBxdGVzdHNcbi8vIFRoaXMgZmlsZSBkaXNjb3ZlcnMgYW5kIHJ1bnMgYWxsIHRlc3RzIGluIHlvdXIgcHJvamVjdFxuXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuY29uc3QgeyBzcGF3biB9ID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpO1xuY29uc3Qgb3MgPSByZXF1aXJlKCdvcycpO1xuXG4vLyBCYXNpYyBDb21tb25KUyB0ZXN0IHJ1bm5lciBpbXBsZW1lbnRhdGlvblxuY29uc29sZS5sb2coJ/Cfp6ogQmFzaWMgcXRlc3RzIFRlc3QgUnVubmVyJyk7XG5jb25zb2xlLmxvZygnUnVuIHRlc3RzIHdpdGg6IG5wbSB0ZXN0Jyk7XG5gO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBwYWNrYWdlLmpzb24gdGVzdCBzY3JpcHQgdG8gdXNlIHF0ZXN0cy1ydW5uZXIuY2pzIChFUyBtb2R1bGUgY29tcGF0aWJsZSlcbiAgICovXG4gIHVwZGF0ZVBhY2thZ2VKc29uVGVzdFNjcmlwdCgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFja2FnZVBhdGggPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3BhY2thZ2UuanNvbicpO1xuICAgICAgaWYgKCFmcy5leGlzdHNTeW5jKHBhY2thZ2VQYXRoKSkge1xuICAgICAgICBjb25zb2xlLmxvZygn4pqg77iPICBwYWNrYWdlLmpzb24gbm90IGZvdW5kLCBza2lwcGluZyB0ZXN0IHNjcmlwdCB1cGRhdGUnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYWNrYWdlSnNvbiA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHBhY2thZ2VQYXRoLCAndXRmOCcpKTtcbiAgICAgIFxuICAgICAgLy8gVXBkYXRlIHRlc3Qgc2NyaXB0IC0gdXNlIC5janMgZXh0ZW5zaW9uIGZvciBFUyBtb2R1bGUgY29tcGF0aWJpbGl0eVxuICAgICAgaWYgKCFwYWNrYWdlSnNvbi5zY3JpcHRzKSB7XG4gICAgICAgIHBhY2thZ2VKc29uLnNjcmlwdHMgPSB7fTtcbiAgICAgIH1cbiAgICAgIHBhY2thZ2VKc29uLnNjcmlwdHMudGVzdCA9ICdub2RlIHF0ZXN0cy1ydW5uZXIuanMnO1xuICAgICAgXG4gICAgICBmcy53cml0ZUZpbGVTeW5jKHBhY2thZ2VQYXRoLCBKU09OLnN0cmluZ2lmeShwYWNrYWdlSnNvbiwgbnVsbCwgMiksICd1dGY4Jyk7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIFVwZGF0ZWQgcGFja2FnZS5qc29uIHRlc3Qgc2NyaXB0IHRvIHVzZSBxdGVzdHMtcnVubmVyLmpzJyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyAgQ291bGQgbm90IHVwZGF0ZSBwYWNrYWdlLmpzb246JywgZXJyb3IubWVzc2FnZSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1haW4gZ2VuZXJhdG9yIGZ1bmN0aW9uIC0gY29tcHJlaGVuc2l2ZWx5IHNjYW5zIHByb2plY3QgZm9yIHRlc3QgZ2VuZXJhdGlvblxuICAgKi9cbiAgZ2VuZXJhdGUoKSB7XG4gICAgY29uc29sZS5sb2coYFNjYW5uaW5nIHByb2plY3QgZm9yIHRlc3QgZ2VuZXJhdGlvbi4uLmApO1xuICAgIFxuICAgIC8vIFdhbGsgZW50aXJlIHByb2plY3QgdG8gZGlzY292ZXIgYWxsIHNvdXJjZSBmaWxlcyBhbmQgZXhpc3RpbmcgdGVzdHNcbiAgICBjb25zdCBwcm9qZWN0RmlsZXMgPSB0aGlzLndhbGtQcm9qZWN0KCk7XG4gICAgY29uc3QgeyBzb3VyY2VGaWxlcywgZXhpc3RpbmdUZXN0cyB9ID0gdGhpcy5jYXRlZ29yaXplRmlsZXMocHJvamVjdEZpbGVzKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhgRm91bmQgJHtzb3VyY2VGaWxlcy5sZW5ndGh9IHNvdXJjZSBmaWxlcyBhbmQgJHtleGlzdGluZ1Rlc3RzLmxlbmd0aH0gZXhpc3RpbmcgdGVzdHNgKTtcbiAgICBcbiAgICAvLyBBbmFseXplIGVhY2ggc291cmNlIGZpbGUgZm9yIHRlc3QgZ2VuZXJhdGlvblxuICAgIHNvdXJjZUZpbGVzLmZvckVhY2goZmlsZSA9PiB0aGlzLmFuYWx5emUoZmlsZSkpO1xuICAgIFxuICAgIHRoaXMuc2NhZmZvbGRKZXN0U2V0dXAoKTtcblxuICAgIGlmICh0aGlzLnNjYW5uZWQubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZygn4pyFIEFsbCB0ZXN0cyBhbHJlYWR5IGV4aXN0LiBOb3RoaW5nIHRvIGdlbmVyYXRlLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhg4pyFIEdlbmVyYXRlZCAke3RoaXMuc2Nhbm5lZC5sZW5ndGh9IG5ldyB0ZXN0IGZpbGVzOmApO1xuICAgICAgdGhpcy5zY2FubmVkLmZvckVhY2goKHsgdHlwZSwgZmlsZSB9KSA9PiB7XG4gICAgICAgIGNvbnN0IGxhYmVsID0gdHlwZSA9PT0gJ3VuaXQnID8gJ/Cfk6YgVW5pdCcgOiAn8J+MkCBBUEknO1xuICAgICAgICBjb25zb2xlLmxvZyhgICAke2xhYmVsfSDihpIgJHtmaWxlfWApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuc2Nhbm5lZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZ2VuZXJhdGlvbiByZXN1bHRzXG4gICAqL1xuICBnZXRSZXN1bHRzKCkge1xuICAgIHJldHVybiB0aGlzLnNjYW5uZWQ7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IFRlc3RHZW5lcmF0b3IsIERFRkFVTFRfQ09ORklHLCBQQVRURVJOUyB9OyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxNQUFNQSxFQUFFLEdBQUdDLE9BQU8sQ0FBQyxJQUFJLENBQUM7QUFDeEIsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBTSxDQUFDOztBQUU1QjtBQUNBLE1BQU1FLGNBQWMsR0FBRztFQUNyQkMsT0FBTyxFQUFFLEtBQUs7RUFDZEMsUUFBUSxFQUFFLG1CQUFtQjtFQUM3QkMsV0FBVyxFQUFFLENBQUMsT0FBTyxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUM7RUFDckVDLFVBQVUsRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU07QUFDM0MsQ0FBQzs7QUFF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