{"version":3,"names":["path","require","moduleReloadLock","Set","reload","relPath","console","log","fullPath","resolve","__dirname","has","add","cache","mod","delete","err","message","module","exports"],"sources":["moduleReloader.js"],"sourcesContent":["/**\n * Module Reloading Utility\n * \n * This module provides functionality for reloading modules from Node.js cache\n * for isolated testing scenarios. It focuses solely on module cache management.\n */\n\nconst path = require('path');\n\n// Thread-safe module reloading lock to prevent race conditions\nconst moduleReloadLock = new Set();\n\n/**\n * Reload a module from cache for isolated testing\n * \n * This function clears a module from Node.js require cache and reloads it,\n * enabling tests to verify module loading behavior and ensure fresh module\n * state between tests.\n * \n * @param {string} relPath - Relative path to module that should be reloaded\n * @returns {Object} The freshly loaded module object\n * @throws {Error} If module cannot be found or loaded\n */\nfunction reload(relPath) {\n  console.log(`reload is running with ${relPath}`);\n\n  const fullPath = path.resolve(__dirname, relPath);\n\n  if (moduleReloadLock.has(fullPath)) {\n    console.log(`reload has run resulting in skip`);\n    return require(fullPath);\n  }\n\n  try {\n    moduleReloadLock.add(fullPath);\n    delete require.cache[require.resolve(fullPath)];\n    const mod = require(fullPath);\n    moduleReloadLock.delete(fullPath);\n    console.log(`reload is returning module`);\n    return mod;\n  } catch (err) {\n    moduleReloadLock.delete(fullPath);\n    console.log(`reload error ${err.message}`);\n    throw err;\n  }\n}\n\nmodule.exports = {\n  reload\n};"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAM,CAAC;;AAE5B;AACA,MAAMC,gBAAgB,GAAG,IAAIC,GAAG,CAAC,CAAC;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,MAAMA,CAACC,OAAO,EAAE;EACvBC,OAAO,CAACC,GAAG,CAAC,0BAA0BF,OAAO,EAAE,CAAC;EAEhD,MAAMG,QAAQ,GAAGR,IAAI,CAACS,OAAO,CAACC,SAAS,EAAEL,OAAO,CAAC;EAEjD,IAAIH,gBAAgB,CAACS,GAAG,CAACH,QAAQ,CAAC,EAAE;IAClCF,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAC;IAC/C,OAAON,OAAO,CAACO,QAAQ,CAAC;EAC1B;EAEA,IAAI;IACFN,gBAAgB,CAACU,GAAG,CAACJ,QAAQ,CAAC;IAC9B,OAAOP,OAAO,CAACY,KAAK,CAACZ,OAAO,CAACQ,OAAO,CAACD,QAAQ,CAAC,CAAC;IAC/C,MAAMM,GAAG,GAAGb,OAAO,CAACO,QAAQ,CAAC;IAC7BN,gBAAgB,CAACa,MAAM,CAACP,QAAQ,CAAC;IACjCF,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;IACzC,OAAOO,GAAG;EACZ,CAAC,CAAC,OAAOE,GAAG,EAAE;IACZd,gBAAgB,CAACa,MAAM,CAACP,QAAQ,CAAC;IACjCF,OAAO,CAACC,GAAG,CAAC,gBAAgBS,GAAG,CAACC,OAAO,EAAE,CAAC;IAC1C,MAAMD,GAAG;EACX;AACF;AAEAE,MAAM,CAACC,OAAO,GAAG;EACff;AACF,CAAC","ignoreList":[]}