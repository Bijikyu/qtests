6bc599ca51c78c7dd2991b7f59c25973
/**
 * Response Mocking Utility - TypeScript Implementation
 *
 * This module provides functionality for creating mock HTTP response objects
 * for API testing scenarios without requiring actual HTTP infrastructure.
 */
/**
 * Create a mock JSON response object
 *
 * This function creates a mock response object that mimics Express.js response
 * interface for testing API endpoints without requiring a full HTTP server.
 *
 * @param data - JSON data to include in the response
 * @param statusCode - HTTP status code (default: 200)
 * @returns Mock response object with Express-like interface
 */
function createJsonRes(data = {}, statusCode = 200) {
    console.log(`createJsonRes is running with data and status ${statusCode}`);
    try {
        let responseData = data;
        let currentStatus = statusCode;
        const headers = {
            'Content-Type': 'application/json'
        };
        let sent = false;
        const mockResponse = {
            status: (code) => {
                currentStatus = code;
                mockResponse.statusCode = code;
                return mockResponse;
            },
            json: (jsonData) => {
                responseData = jsonData;
                mockResponse._data = JSON.stringify(jsonData);
                headers['Content-Type'] = 'application/json';
                return mockResponse;
            },
            send: (sendData) => {
                responseData = sendData;
                mockResponse._data = typeof sendData === 'string' ? sendData : JSON.stringify(sendData);
                return mockResponse;
            },
            end: (endData) => {
                if (endData !== undefined) {
                    responseData = endData;
                    mockResponse._data = typeof endData === 'string' ? endData : JSON.stringify(endData);
                }
                sent = true;
                mockResponse._sent = true;
            },
            setHeader: (name, value) => {
                headers[name] = value;
                return mockResponse;
            },
            statusCode: currentStatus,
            headers: headers,
            _data: JSON.stringify(responseData),
            _sent: sent
        };
        console.log(`createJsonRes is returning mock response`);
        return mockResponse;
    }
    catch (err) {
        console.log(`createJsonRes error ${err.message}`);
        throw err;
    }
}
/**
 * Create a generic mock response object
 *
 * This function creates a basic mock response object with common HTTP response
 * methods for testing scenarios that don't specifically require JSON responses.
 *
 * @param statusCode - HTTP status code (default: 200)
 * @returns Mock response object with basic HTTP interface
 */
function createRes(statusCode = 200) {
    console.log(`createRes is running with status ${statusCode}`);
    try {
        let currentStatus = statusCode;
        const headers = {};
        let responseData = '';
        let sent = false;
        const mockResponse = {
            status: (code) => {
                currentStatus = code;
                mockResponse.statusCode = code;
                return mockResponse;
            },
            json: (data) => {
                responseData = data;
                mockResponse._data = JSON.stringify(data);
                headers['Content-Type'] = 'application/json';
                return mockResponse;
            },
            send: (data) => {
                responseData = data;
                mockResponse._data = typeof data === 'string' ? data : JSON.stringify(data);
                return mockResponse;
            },
            end: (data) => {
                if (data !== undefined) {
                    responseData = data;
                    mockResponse._data = typeof data === 'string' ? data : JSON.stringify(data);
                }
                sent = true;
                mockResponse._sent = true;
            },
            setHeader: (name, value) => {
                headers[name] = value;
                return mockResponse;
            },
            statusCode: currentStatus,
            headers: headers,
            _data: responseData,
            _sent: sent
        };
        console.log(`createRes is returning mock response`);
        return mockResponse;
    }
    catch (err) {
        console.log(`createRes error ${err.message}`);
        throw err;
    }
}
// Export response mocking utilities using ES module syntax
export { createJsonRes, createRes };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS91dGlscy9oZWxwZXJzL3Jlc3BvbnNlTW9ja2VyLnRzIiwibWFwcGluZ3MiOiJBQUFBOzs7OztHQUtHO0FBZUg7Ozs7Ozs7OztHQVNHO0FBQ0gsU0FBUyxhQUFhLENBQUMsT0FBWSxFQUFFLEVBQUUsYUFBcUIsR0FBRztJQUM3RCxPQUFPLENBQUMsR0FBRyxDQUFDLGlEQUFpRCxVQUFVLEVBQUUsQ0FBQyxDQUFDO0lBRTNFLElBQUksQ0FBQztRQUNILElBQUksWUFBWSxHQUFHLElBQUksQ0FBQztRQUN4QixJQUFJLGFBQWEsR0FBRyxVQUFVLENBQUM7UUFDL0IsTUFBTSxPQUFPLEdBQTJCO1lBQ3RDLGNBQWMsRUFBRSxrQkFBa0I7U0FDbkMsQ0FBQztRQUNGLElBQUksSUFBSSxHQUFHLEtBQUssQ0FBQztRQUVqQixNQUFNLFlBQVksR0FBaUI7WUFDakMsTUFBTSxFQUFFLENBQUMsSUFBWSxFQUFFLEVBQUU7Z0JBQ3ZCLGFBQWEsR0FBRyxJQUFJLENBQUM7Z0JBQ3JCLFlBQVksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO2dCQUMvQixPQUFPLFlBQVksQ0FBQztZQUN0QixDQUFDO1lBRUQsSUFBSSxFQUFFLENBQUMsUUFBYSxFQUFFLEVBQUU7Z0JBQ3RCLFlBQVksR0FBRyxRQUFRLENBQUM7Z0JBQ3hCLFlBQVksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztnQkFDOUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxHQUFHLGtCQUFrQixDQUFDO2dCQUM3QyxPQUFPLFlBQVksQ0FBQztZQUN0QixDQUFDO1lBRUQsSUFBSSxFQUFFLENBQUMsUUFBYSxFQUFFLEVBQUU7Z0JBQ3RCLFlBQVksR0FBRyxRQUFRLENBQUM7Z0JBQ3hCLFlBQVksQ0FBQyxLQUFLLEdBQUcsT0FBTyxRQUFRLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFD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LENBQUM7Z0JBQzlFLENBQUM7Z0JBQ0QsSUFBSSxHQUFHLElBQUksQ0FBQztnQkFDWixZQUFZLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztZQUM1QixDQUFDO1lBRUQsU0FBUyxFQUFFLENBQUMsSUFBWSxFQUFFLEtBQWEsRUFBRSxFQUFFO2dCQUN6QyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxDQUFDO2dCQUN0QixPQUFPLFlBQVksQ0FBQztZQUN0QixDQUFDO1lBRUQsVUFBVSxFQUFFLGFBQWE7WUFDekIsT0FBTyxFQUFFLE9BQU87WUFDaEIsS0FBSyxFQUFFLFlBQVk7WUFDbkIsS0FBSyxFQUFFLElBQUk7U0FDWixDQUFDO1FBRUYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO1FBQ3BELE9BQU8sWUFBWSxDQUFDO0lBRXRCLENBQUM7SUFBQyxPQUFPLEdBQVEsRUFBRSxDQUFDO1FBQ2xCLE9BQU8sQ0FBQyxHQUFHLENBQUMsbUJBQW1CLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQzlDLE1BQU0sR0FBRyxDQUFDO0lBQ1osQ0FBQztBQUNILENBQUM7QUFFRCwyREFBMkQ7QUFDM0QsT0FBTyxFQUNMLGFBQWEsRUFDYixTQUFTLEVBQ1YsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL3V0aWxzL2hlbHBlcnMvcmVzcG9uc2VNb2NrZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBSZXNwb25zZSBNb2NraW5nIFV0aWxpdHkgLSBUeXBlU2NyaXB0IEltcGxlbWVudGF0aW9uXG4gKiBcbiAqIFRoaXMgbW9kdWxlIHByb3ZpZGVzIGZ1bmN0aW9uYWxpdHkgZm9yIGNyZWF0aW5nIG1vY2sgSFRUUCByZXNwb25zZSBvYmplY3RzXG4gKiBmb3IgQVBJIHRlc3Rpbmcgc2NlbmFyaW9zIHdpdGhvdXQgcmVxdWlyaW5nIGFjdHVhbCBIVFRQIGluZnJhc3RydWN0dXJlLlxuICovXG5cbi8vIFR5cGUgZGVmaW5pdGlvbnMgZm9yIEhUVFAgcmVzcG9uc2Ugb2JqZWN0c1xuaW50ZXJmYWNlIE1vY2tSZXNwb25zZSB7XG4gIHN0YXR1czogKGNvZGU6IG51bWJlcikgPT4gTW9ja1Jlc3BvbnNlO1xuICBqc29uOiAoZGF0YTogYW55KSA9PiBNb2NrUmVzcG9uc2U7XG4gIHNlbmQ6IChkYXRhOiBhbnkpID0+IE1vY2tSZXNwb25zZTtcbiAgZW5kOiAoZGF0YT86IGFueSkgPT4gdm9pZDtcbiAgc2V0SGVhZGVyOiAobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKSA9PiBNb2NrUmVzcG9uc2U7XG4gIHN0YXR1c0NvZGU/OiBudW1iZXI7XG4gIGhlYWRlcnM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICBfZGF0YT86IGFueTtcbiAgX3NlbnQ/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIG1vY2sgSlNPTiByZXNwb25zZSBvYmplY3RcbiAqIFxuICogVGhpcyBmdW5jdGlvbiBjcmVhdGVzIGEgbW9jayByZXNwb25zZSBvYmplY3QgdGhhdCBtaW1pY3MgRXhwcmVzcy5qcyByZXNwb25zZVxuICogaW50ZXJmYWNlIGZvciB0ZXN0aW5nIEFQSSBlbmRwb2ludHMgd2l0aG91dCByZXF1aXJpbmcgYSBmdWxsIEhUVFAgc2VydmVyLlxuICogXG4gKiBAcGFyYW0gZGF0YSAtIEpTT04gZGF0YSB0byBpbmNsdWRlIGluIHRoZSByZXNwb25zZVxuICogQHBhcmFtIHN0YXR1c0NvZGUgLSBIVFRQIHN0YXR1cyBjb2RlIChkZWZhdWx0OiAyMDApXG4gKiBAcmV0dXJucyBNb2NrIHJlc3BvbnNlIG9iamVjdCB3aXRoIEV4cHJlc3MtbGlrZSBpbnRlcmZhY2VcbiAqL1xuZnVuY3Rpb24gY3JlYXRlSnNvblJlcyhkYXRhOiBhbnkgPSB7fSwgc3RhdHVzQ29kZTogbnVtYmVyID0gMjAwKTogTW9ja1Jlc3BvbnNlIHtcbiAgY29uc29sZS5sb2coYGNyZWF0ZUpzb25SZXMgaXMgcnVubmluZyB3aXRoIGRhdGEgYW5kIHN0YXR1cyAke3N0YXR1c0NvZGV9YCk7XG4gIFxuICB0cnkge1xuICAgIGxldCByZXNwb25zZURhdGEgPSBkYXRhO1xuICAgIGxldCBjdXJyZW50U3RhdHVzID0gc3RhdHVzQ29kZTtcbiAgICBjb25zdCBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgIH07XG4gICAgbGV0IHNlbnQgPSBmYWxzZTtcbiAgICBcbiAgICBjb25zdCBtb2NrUmVzcG9uc2U6IE1vY2tSZXNwb25zZSA9IHtcbiAgICAgIHN0YXR1czogKGNvZGU6IG51bWJlcikgPT4ge1xuICAgICAgICBjdXJyZW50U3RhdHVzID0gY29kZTtcbiAgICAgICAgbW9ja1Jlc3BvbnNlLnN0YXR1c0NvZGUgPSBjb2RlO1xuICAgICAgICByZXR1cm4gbW9ja1Jlc3BvbnNlO1xuICAgICAgfSxcbiAgICAgIFxuICAgICAganNvbjogKGpzb25EYXRhOiBhbnkpID0+IHtcbiAgICAgICAgcmVzcG9uc2VEYXRhID0ganNvbkRhdGE7XG4gICAgICAgIG1vY2tSZXNwb25zZS5fZGF0YSA9IEpTT04uc3RyaW5naWZ5KGpzb25EYXRhKTtcbiAgICAgICAgaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnYXBwbGljYXRpb24vanNvbic7XG4gICAgICAgIHJldHVybiBtb2NrUmVzcG9uc2U7XG4gICAgICB9LFxuICAgICAgXG4gICAgICBzZW5kOiAoc2VuZERhdGE6IGFueSkgPT4ge1xuICAgICAgICByZXNwb25zZURhdGEgPSBzZW5kRGF0YTtcbiAgICAgICAgbW9ja1Jlc3BvbnNlLl9kYXRhID0gdHlwZW9mIHNlbmREYXRhID09PSAnc3RyaW5nJyA/IHNlbmREYXRhIDogSlNPTi5zdHJpbmdpZnkoc2VuZERhdGEpO1xuICAgICAgICByZXR1cm4gbW9ja1Jlc3BvbnNlO1xuICAgICAgfSxcbiAgICAgIFxuICAgICAgZW5kOiAoZW5kRGF0YT86IGFueSkgPT4ge1xuICAgICAgICBpZiAoZW5kRGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcmVzcG9uc2VEYXRhID0gZW5kRGF0YTtcbiAgICAgICAgICBtb2NrUmVzcG9uc2UuX2RhdGEgPSB0eXBlb2YgZW5kRGF0YSA9PT0gJ3N0cmluZycgPyBlbmREYXRhIDogSlNPTi5zdHJpbmdpZnkoZW5kRGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VudCA9IHRydWU7XG4gICAgICAgIG1vY2tSZXNwb25zZS5fc2VudCA9IHRydWU7XG4gICAgICB9LFxuICAgICAgXG4gICAgICBzZXRIZWFkZXI6IChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaGVhZGVyc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gbW9ja1Jlc3BvbnNlO1xuICAgICAgfSxcbiAgICAgIFxuICAgICAgc3RhdHVzQ29kZTogY3VycmVudFN0YXR1cyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICBfZGF0YTogSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhKSxcbiAgICAgIF9zZW50OiBzZW50XG4gICAgfTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhgY3JlYXRlSnNvblJlcyBpcyByZXR1cm5pbmcgbW9jayByZXNwb25zZWApO1xuICAgIHJldHVybiBtb2NrUmVzcG9uc2U7XG4gICAgXG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgY29uc29sZS5sb2coYGNyZWF0ZUpzb25SZXMgZXJyb3IgJHtlcnIubWVzc2FnZX1gKTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBnZW5lcmljIG1vY2sgcmVzcG9uc2Ugb2JqZWN0XG4gKiBcbiAqIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhIGJhc2ljIG1vY2sgcmVzcG9uc2Ugb2JqZWN0IHdpdGggY29tbW9uIEhUVFAgcmVzcG9uc2VcbiAqIG1ldGhvZHMgZm9yIHRlc3Rpbmcgc2NlbmFyaW9zIHRoYXQgZG9uJ3Qgc3BlY2lmaWNhbGx5IHJlcXVpcmUgSlNPTiByZXNwb25zZXMuXG4gKiBcbiAqIEBwYXJhbSBzdGF0dXNDb2RlIC0gSFRUUCBzdGF0dXMgY29kZSAoZGVmYXVsdDogMjAwKVxuICogQHJldHVybnMgTW9jayByZXNwb25zZSBvYmplY3Qgd2l0aCBiYXNpYyBIVFRQIGludGVyZmFjZVxuICovXG5mdW5jdGlvbiBjcmVhdGVSZXMoc3RhdHVzQ29kZTogbnVtYmVyID0gMjAwKTogTW9ja1Jlc3BvbnNlIHtcbiAgY29uc29sZS5sb2coYGNyZWF0ZVJlcyBpcyBydW5uaW5nIHdpdGggc3RhdHVzICR7c3RhdHVzQ29kZX1gKTtcbiAgXG4gIHRyeSB7XG4gICAgbGV0IGN1cnJlbnRTdGF0dXMgPSBzdGF0dXNDb2RlO1xuICAgIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICBsZXQgcmVzcG9uc2VEYXRhOiBhbnkgPSAnJztcbiAgICBsZXQgc2VudCA9IGZhbHNlO1xuICAgIFxuICAgIGNvbnN0IG1vY2tSZXNwb25zZTogTW9ja1Jlc3BvbnNlID0ge1xuICAgICAgc3RhdHVzOiAoY29kZTogbnVtYmVyKSA9PiB7XG4gICAgICAgIGN1cnJlbnRTdGF0dXMgPSBjb2RlO1xuICAgICAgICBtb2NrUmVzcG9uc2Uuc3RhdHVzQ29kZSA9IGNvZGU7XG4gICAgICAgIHJldHVybiBtb2NrUmVzcG9uc2U7XG4gICAgICB9LFxuICAgICAgXG4gICAgICBqc29uOiAoZGF0YTogYW55KSA9PiB7XG4gICAgICAgIHJlc3BvbnNlRGF0YSA9IGRhdGE7XG4gICAgICAgIG1vY2tSZXNwb25zZS5fZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICBoZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi9qc29uJztcbiAgICAgICAgcmV0dXJuIG1vY2tSZXNwb25zZTtcbiAgICAgIH0sXG4gICAgICBcbiAgICAgIHNlbmQ6IChkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgcmVzcG9uc2VEYXRhID0gZGF0YTtcbiAgICAgICAgbW9ja1Jlc3BvbnNlLl9kYXRhID0gdHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnID8gZGF0YSA6IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICByZXR1cm4gbW9ja1Jlc3BvbnNlO1xuICAgICAgfSxcbiAgICAgIFxuICAgICAgZW5kOiAoZGF0YT86IGFueSkgPT4ge1xuICAgICAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcmVzcG9uc2VEYXRhID0gZGF0YTtcbiAgICAgICAgICBtb2NrUmVzcG9uc2UuX2RhdGEgPSB0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycgPyBkYXRhIDogSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgc2VudCA9IHRydWU7XG4gICAgICAgIG1vY2tSZXNwb25zZS5fc2VudCA9IHRydWU7XG4gICAgICB9LFxuICAgICAgXG4gICAgICBzZXRIZWFkZXI6IChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaGVhZGVyc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gbW9ja1Jlc3BvbnNlO1xuICAgICAgfSxcbiAgICAgIFxuICAgICAgc3RhdHVzQ29kZTogY3VycmVudFN0YXR1cyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICBfZGF0YTogcmVzcG9uc2VEYXRhLFxuICAgICAgX3NlbnQ6IHNlbnRcbiAgICB9O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKGBjcmVhdGVSZXMgaXMgcmV0dXJuaW5nIG1vY2sgcmVzcG9uc2VgKTtcbiAgICByZXR1cm4gbW9ja1Jlc3BvbnNlO1xuICAgIFxuICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgIGNvbnNvbGUubG9nKGBjcmVhdGVSZXMgZXJyb3IgJHtlcnIubWVzc2FnZX1gKTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cbn1cblxuLy8gRXhwb3J0IHJlc3BvbnNlIG1vY2tpbmcgdXRpbGl0aWVzIHVzaW5nIEVTIG1vZHVsZSBzeW50YXhcbmV4cG9ydCB7XG4gIGNyZWF0ZUpzb25SZXMsXG4gIGNyZWF0ZVJlc1xufTsiXSwidmVyc2lvbiI6M30=