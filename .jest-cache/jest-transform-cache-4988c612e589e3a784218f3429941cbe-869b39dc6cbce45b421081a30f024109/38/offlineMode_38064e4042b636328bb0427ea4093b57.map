{"version":3,"names":["isOfflineFlag","cachedAxios","cachedQerrors","setOfflineMode","offline","changed","clearOfflineCache","isOfflineMode","getAxios","require","e","getQerrors","qerrors","getEnvironmentState","codexFlag","process","env","CODEX","toLowerCase","offlineFlagExplicit","OFFLINE_MODE","testEnvironment","NODE_ENV","isOffline","environmentDetected","createEnvironmentAdapters","axios","module","exports"],"sources":["offlineMode.js"],"sourcesContent":["/**\n * Offline Mode Utility - Working Implementation\n */\n\n// Simple offline state management\nlet isOfflineFlag = false;\nlet cachedAxios = null;\nlet cachedQerrors = null;\n\n/**\n * Set offline mode\n */\nfunction setOfflineMode(offline) {\n  const changed = isOfflineFlag !== offline;\n  isOfflineFlag = offline;\n  \n  // Clear cache when mode changes\n  if (changed) {\n    clearOfflineCache();\n  }\n}\n\n/**\n * Check if offline mode is enabled\n */\nfunction isOfflineMode() {\n  return isOfflineFlag;\n}\n\n/**\n * Get axios (stub or real)\n */\nfunction getAxios() {\n  if (!cachedAxios) {\n    if (isOfflineFlag) {\n      // Use stub axios\n      cachedAxios = require('../stubs/axios');\n    } else {\n      // Try real axios, fallback to stub\n      try {\n        cachedAxios = require('axios');\n      } catch (e) {\n        cachedAxios = require('../stubs/axios');\n      }\n    }\n  }\n  return cachedAxios;\n}\n\n/**\n * Get qerrors (stub or real)\n */\nfunction getQerrors() {\n  if (!cachedQerrors) {\n    if (isOfflineFlag) {\n      // Use stub qerrors\n      cachedQerrors = { qerrors: () => {} };\n    } else {\n      // Try real qerrors, fallback to stub\n      try {\n        cachedQerrors = require('qerrors');\n      } catch (e) {\n        cachedQerrors = { qerrors: () => {} };\n      }\n    }\n  }\n  return cachedQerrors;\n}\n\n/**\n * Get environment state\n */\nfunction getEnvironmentState() {\n  const codexFlag = process.env.CODEX?.toLowerCase() === 'true';\n  const offlineFlagExplicit = process.env.OFFLINE_MODE?.toLowerCase() === 'true';\n  const testEnvironment = process.env.NODE_ENV === 'test';\n  \n  return {\n    codexFlag,\n    offlineFlagExplicit,\n    testEnvironment,\n    isOffline: isOfflineFlag,\n    environmentDetected: codexFlag || offlineFlagExplicit\n  };\n}\n\n/**\n * Create environment adapters\n */\nfunction createEnvironmentAdapters() {\n  return {\n    isOffline: isOfflineFlag,\n    axios: getAxios(),\n    qerrors: getQerrors()\n  };\n}\n\n/**\n * Clear offline cache\n */\nfunction clearOfflineCache() {\n  cachedAxios = null;\n  cachedQerrors = null;\n}\n\nmodule.exports = {\n  setOfflineMode,\n  isOfflineMode,\n  getAxios,\n  getQerrors,\n  getEnvironmentState,\n  createEnvironmentAdapters,\n  clearOfflineCache\n};"],"mappings":"AAAA;AACA;AACA;;AAEA;AACA,IAAIA,aAAa,GAAG,KAAK;AACzB,IAAIC,WAAW,GAAG,IAAI;AACtB,IAAIC,aAAa,GAAG,IAAI;;AAExB;AACA;AACA;AACA,SAASC,cAAcA,CAACC,OAAO,EAAE;EAC/B,MAAMC,OAAO,GAAGL,aAAa,KAAKI,OAAO;EACzCJ,aAAa,GAAGI,OAAO;;EAEvB;EACA,IAAIC,OAAO,EAAE;IACXC,iBAAiB,CAAC,CAAC;EACrB;AACF;;AAEA;AACA;AACA;AACA,SAASC,aAAaA,CAAA,EAAG;EACvB,OAAOP,aAAa;AACtB;;AAEA;AACA;AACA;AACA,SAASQ,QAAQA,CAAA,EAAG;EAClB,IAAI,CAACP,WAAW,EAAE;IAChB,IAAID,aAAa,EAAE;MACjB;MACAC,WAAW,GAAGQ,OAAO,CAAC,gBAAgB,CAAC;IACzC,CAAC,MAAM;MACL;MACA,IAAI;QACFR,WAAW,GAAGQ,OAAO,CAAC,OAAO,CAAC;MAChC,CAAC,CAAC,OAAOC,CAAC,EAAE;QACVT,WAAW,GAAGQ,OAAO,CAAC,gBAAgB,CAAC;MACzC;IACF;EACF;EACA,OAAOR,WAAW;AACpB;;AAEA;AACA;AACA;AACA,SAASU,UAAUA,CAAA,EAAG;EACpB,IAAI,CAACT,aAAa,EAAE;IAClB,IAAIF,aAAa,EAAE;MACjB;MACAE,aAAa,GAAG;QAAEU,OAAO,EAAEA,CAAA,KAAM,CAAC;MAAE,CAAC;IACvC,CAAC,MAAM;MACL;MACA,IAAI;QACFV,aAAa,GAAGO,OAAO,CAAC,SAAS,CAAC;MACpC,CAAC,CAAC,OAAOC,CAAC,EAAE;QACVR,aAAa,GAAG;UAAEU,OAAO,EAAEA,CAAA,KAAM,CAAC;QAAE,CAAC;MACvC;IACF;EACF;EACA,OAAOV,aAAa;AACtB;;AAEA;AACA;AACA;AACA,SAASW,mBAAmBA,CAAA,EAAG;EAC7B,MAAMC,SAAS,GAAGC,OAAO,CAACC,GAAG,CAACC,KAAK,EAAEC,WAAW,CAAC,CAAC,KAAK,MAAM;EAC7D,MAAMC,mBAAmB,GAAGJ,OAAO,CAACC,GAAG,CAACI,YAAY,EAAEF,WAAW,CAAC,CAAC,KAAK,MAAM;EAC9E,MAAMG,eAAe,GAAGN,OAAO,CAACC,GAAG,CAACM,QAAQ,KAAK,MAAM;EAEvD,OAAO;IACLR,SAAS;IACTK,mBAAmB;IACnBE,eAAe;IACfE,SAAS,EAAEvB,aAAa;IACxBwB,mBAAmB,EAAEV,SAAS,IAAIK;EACpC,CAAC;AACH;;AAEA;AACA;AACA;AACA,SAASM,yBAAyBA,CAAA,EAAG;EACnC,OAAO;IACLF,SAAS,EAAEvB,aAAa;IACxB0B,KAAK,EAAElB,QAAQ,CAAC,CAAC;IACjBI,OAAO,EAAED,UAAU,CAAC;EACtB,CAAC;AACH;;AAEA;AACA;AACA;AACA,SAASL,iBAAiBA,CAAA,EAAG;EAC3BL,WAAW,GAAG,IAAI;EAClBC,aAAa,GAAG,IAAI;AACtB;AAEAyB,MAAM,CAACC,OAAO,GAAG;EACfzB,cAAc;EACdI,aAAa;EACbC,QAAQ;EACRG,UAAU;EACVE,mBAAmB;EACnBY,yBAAyB;EACzBnB;AACF,CAAC","ignoreList":[]}