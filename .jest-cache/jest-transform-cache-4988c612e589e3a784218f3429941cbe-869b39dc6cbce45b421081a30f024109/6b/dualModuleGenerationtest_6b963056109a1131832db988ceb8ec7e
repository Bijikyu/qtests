74058b8fc994cf249bfce823f7cc600b
/**
 * Test qtests' ability to generate tests for both CommonJS and ES modules
 * Verifies the enhanced export detection and module-appropriate test generation
 */

const fs = require('fs');
const path = require('path');
const {
  TestGenerator
} = require('../lib/testGenerator');
describe('qtests Dual Module System Test Generation', () => {
  let tempDir;
  let generator;
  beforeEach(() => {
    // Create UNIQUE temporary directory for parallel safety
    const uniqueId = `${process.hrtime.bigint()}-${Math.random().toString(36).substr(2, 9)}`;
    tempDir = path.join(__dirname, `temp_module_tests_${uniqueId}`);
    if (!fs.existsSync(tempDir)) {
      fs.mkdirSync(tempDir, {
        recursive: true
      });
    }
    generator = new TestGenerator({
      SRC_DIR: tempDir,
      TEST_DIR: path.join(tempDir, 'tests')
    });
  });
  afterEach(() => {
    // Cleanup temporary files
    if (fs.existsSync(tempDir)) {
      fs.rmSync(tempDir, {
        recursive: true,
        force: true
      });
    }
  });
  describe('CommonJS Export Detection', () => {
    it('should detect module.exports single function', () => {
      const commonJSCode = `
function calculateSum(a, b) {
  return a + b;
}

module.exports = calculateSum;
`;
      const exports = generator.extractExports(commonJSCode);
      expect(exports).toContain('calculateSum');
      expect(exports.length).toBe(1);
    });
    it('should detect module.exports object with multiple exports', () => {
      const commonJSCode = `
function add(a, b) { return a + b; }
function subtract(a, b) { return a - b; }

class Calculator {
  constructor() {}
}

module.exports = {
  add,
  subtract,
  Calculator
};
`;
      const exports = generator.extractExports(commonJSCode);
      expect(exports).toContain('add');
      expect(exports).toContain('subtract');
      expect(exports).toContain('Calculator');
      expect(exports.length).toBe(3);
    });
    it('should detect exports.property assignments', () => {
      const commonJSCode = `
function helper1() {}
function helper2() {}

exports.helper1 = helper1;
exports.helper2 = helper2;
`;
      const exports = generator.extractExports(commonJSCode);
      expect(exports).toContain('helper1');
      expect(exports).toContain('helper2');
      expect(exports.length).toBe(2);
    });
    it('should detect module.exports.property assignments', () => {
      const commonJSCode = `
function utilityA() {}
function utilityB() {}

module.exports.utilityA = utilityA;
module.exports.utilityB = utilityB;
`;
      const exports = generator.extractExports(commonJSCode);
      expect(exports).toContain('utilityA');
      expect(exports).toContain('utilityB');
      expect(exports.length).toBe(2);
    });
  });
  describe('ES Module Export Detection', () => {
    it('should detect export const declarations', () => {
      const esModuleCode = `
export const API_URL = 'https://api.example.com';
export const MAX_RETRIES = 3;
`;
      const exports = generator.extractExports(esModuleCode);
      expect(exports).toContain('API_URL');
      expect(exports).toContain('MAX_RETRIES');
      expect(exports.length).toBe(2);
    });
    it('should detect export function declarations', () => {
      const esModuleCode = `
export function processData(data) {
  return data.map(item => item.value);
}

export function validateInput(input) {
  return typeof input === 'string';
}
`;
      const exports = generator.extractExports(esModuleCode);
      expect(exports).toContain('processData');
      expect(exports).toContain('validateInput');
      expect(exports.length).toBe(2);
    });
    it('should detect export class declarations', () => {
      const esModuleCode = `
export class DataProcessor {
  constructor() {}
}

export class ValidationEngine {
  validate() {}
}
`;
      const exports = generator.extractExports(esModuleCode);
      expect(exports).toContain('DataProcessor');
      expect(exports).toContain('ValidationEngine');
      expect(exports.length).toBe(2);
    });
  });
  describe('Mixed Module Pattern Detection', () => {
    it('should handle files with both ES and CommonJS patterns', () => {
      const mixedCode = `
// ES module style
export function esFunction() {
  return 'es';
}

// CommonJS style
function cjsFunction() {
  return 'cjs';
}

module.exports.cjsFunction = cjsFunction;
`;
      const exports = generator.extractExports(mixedCode);
      expect(exports).toContain('esFunction');
      expect(exports).toContain('cjsFunction');
      expect(exports.length).toBe(2);
    });
  });
  describe('Import Detection (CommonJS vs ES Modules)', () => {
    it('should detect CommonJS require statements', () => {
      const commonJSCode = `
const fs = require('fs');
const path = require('path');
const axios = require('axios');
`;
      const imports = generator.getUsedModules(commonJSCode);
      expect(imports).toContain('fs');
      expect(imports).toContain('path');
      expect(imports).toContain('axios');
    });
    it('should detect ES module import statements', () => {
      const esModuleCode = `
import fs from 'fs';
import { resolve } from 'path';
import axios from 'axios';
`;
      const imports = generator.getUsedModules(esModuleCode);
      expect(imports).toContain('fs');
      expect(imports).toContain('path');
      expect(imports).toContain('axios');
    });
    it('should filter out relative imports', () => {
      const codeWithRelative = `
const fs = require('fs');
const local = require('./localFile');
const parent = require('../parentFile');
import axios from 'axios';
import { util } from './utils';
`;
      const imports = generator.getUsedModules(codeWithRelative);
      expect(imports).toContain('fs');
      expect(imports).toContain('axios');
      expect(imports).not.toContain('./localFile');
      expect(imports).not.toContain('../parentFile');
      expect(imports).not.toContain('./utils');
    });
  });
  describe('Test Generation for Different Module Systems', () => {
    it('should generate CommonJS-style tests for CommonJS projects', () => {
      // Mock CommonJS project (no "type": "module" in package.json)
      generator.isESModule = false;
      const commonJSFile = path.join(tempDir, 'mathUtils.js');
      const commonJSCode = `
function add(a, b) {
  return a + b;
}

module.exports = { add };
`;
      fs.writeFileSync(commonJSFile, commonJSCode);
      const exports = generator.extractExports(commonJSCode);
      const testContent = generator.createUnitTest(commonJSFile, exports, false, []);

      // Should use require syntax
      expect(testContent).toContain('const mod = require(');
      expect(testContent).not.toContain('import');
      expect(testContent).toContain("describe('mathUtils.js'");
      expect(testContent).toContain("test('add works'");
    });
    it('should generate ES module-style tests for ES module projects', () => {
      // Mock ES module project
      generator.isESModule = true;
      const esModuleFile = path.join(tempDir, 'dataProcessor.js');
      const esModuleCode = `
export function process(data) {
  return data.filter(Boolean);
}
`;
      fs.writeFileSync(esModuleFile, esModuleCode);
      const exports = generator.extractExports(esModuleCode);
      const testContent = generator.createUnitTest(esModuleFile, exports, false, []);

      // Should use import syntax
      expect(testContent).toContain('import * as mod from');
      expect(testContent).not.toContain('require(');
      expect(testContent).toContain("describe('dataProcessor.js'");
      expect(testContent).toContain("test('process works'");
    });
  });
  describe('Real File Analysis and Test Generation', () => {
    it('should analyze and generate tests for CommonJS files', () => {
      const commonJSFile = path.join(tempDir, 'realCommonJS.js');
      const commonJSCode = `
const fs = require('fs');

function readConfig(filename) {
  return JSON.parse(fs.readFileSync(filename, 'utf8'));
}

class ConfigManager {
  constructor() {
    this.config = {};
  }
  
  load(file) {
    this.config = readConfig(file);
  }
}

module.exports = {
  readConfig,
  ConfigManager
};
`;
      fs.writeFileSync(commonJSFile, commonJSCode);

      // Analyze the file
      generator.analyze(commonJSFile);

      // Check if test was generated
      const expectedTestPath = generator.getRelativeTestPath(commonJSFile, 'unit');
      expect(generator.scanned.length).toBeGreaterThan(0);
      expect(generator.scanned[0].type).toBe('unit');
    });
    it('should analyze and generate tests for ES module files', () => {
      const esModuleFile = path.join(tempDir, 'realESModule.js');
      const esModuleCode = `
export function validateEmail(email) {
  return email.includes('@');
}

export class EmailValidator {
  constructor() {}
  
  isValid(email) {
    return validateEmail(email);
  }
}
`;
      fs.writeFileSync(esModuleFile, esModuleCode);

      // Analyze the file
      generator.analyze(esModuleFile);

      // Check if test was generated
      expect(generator.scanned.length).toBeGreaterThan(0);
      expect(generator.scanned[0].type).toBe('unit');
    });
  });
  describe('Edge Cases and Error Handling', () => {
    it('should handle files with no exports gracefully', () => {
      const noExportsCode = `
// Just some utility functions that aren't exported
function internal() {}
const PRIVATE_CONST = 'private';
`;
      const exports = generator.extractExports(noExportsCode);
      expect(exports).toEqual([]);
    });
    it('should handle malformed export patterns', () => {
      const malformedCode = `
module.exports = 
function incomplete() {}
exports. = 'invalid';
export 
`;
      const exports = generator.extractExports(malformedCode);
      // Should not crash and return valid exports only
      expect(Array.isArray(exports)).toBe(true);
    });
    it('should handle files with comments containing export-like patterns', () => {
      const commentCode = `
// This is not an export: module.exports = fake
/* 
 * export function commentedOut() {}
 */
function realFunction() {}
module.exports = realFunction;
`;
      const exports = generator.extractExports(commentCode);
      expect(exports).toContain('realFunction');
      expect(exports).not.toContain('fake');
      expect(exports).not.toContain('commentedOut');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwYXRoIiwiVGVzdEdlbmVyYXRvciIsImRlc2NyaWJlIiwidGVtcERpciIsImdlbmVyYXRvciIsImJlZm9yZUVhY2giLCJ1bmlxdWVJZCIsInByb2Nlc3MiLCJocnRpbWUiLCJiaWdpbnQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJqb2luIiwiX19kaXJuYW1lIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsIlNSQ19ESVIiLCJURVNUX0RJUiIsImFmdGVyRWFjaCIsInJtU3luYyIsImZvcmNlIiwiaXQiLCJjb21tb25KU0NvZGUiLCJleHBvcnRzIiwiZXh0cmFjdEV4cG9ydHMiLCJleHBlY3QiLCJ0b0NvbnRhaW4iLCJsZW5ndGgiLCJ0b0JlIiwiZXNNb2R1bGVDb2RlIiwibWl4ZWRDb2RlIiwiaW1wb3J0cyIsImdldFVzZWRNb2R1bGVzIiwiY29kZVdpdGhSZWxhdGl2ZSIsIm5vdCIsImlzRVNNb2R1bGUiLCJjb21tb25KU0ZpbGUiLCJ3cml0ZUZpbGVTeW5jIiwidGVzdENvbnRlbnQiLCJjcmVhdGVVbml0VGVzdCIsImVzTW9kdWxlRmlsZSIsImFuYWx5emUiLCJleHBlY3RlZFRlc3RQYXRoIiwiZ2V0UmVsYXRpdmVUZXN0UGF0aCIsInNjYW5uZWQiLCJ0b0JlR3JlYXRlclRoYW4iLCJ0eXBlIiwibm9FeHBvcnRzQ29kZSIsInRvRXF1YWwiLCJtYWxmb3JtZWRDb2RlIiwiQXJyYXkiLCJpc0FycmF5IiwiY29tbWVudENvZGUiXSwic291cmNlcyI6WyJkdWFsTW9kdWxlR2VuZXJhdGlvbi50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVGVzdCBxdGVzdHMnIGFiaWxpdHkgdG8gZ2VuZXJhdGUgdGVzdHMgZm9yIGJvdGggQ29tbW9uSlMgYW5kIEVTIG1vZHVsZXNcbiAqIFZlcmlmaWVzIHRoZSBlbmhhbmNlZCBleHBvcnQgZGV0ZWN0aW9uIGFuZCBtb2R1bGUtYXBwcm9wcmlhdGUgdGVzdCBnZW5lcmF0aW9uXG4gKi9cblxuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IHsgVGVzdEdlbmVyYXRvciB9ID0gcmVxdWlyZSgnLi4vbGliL3Rlc3RHZW5lcmF0b3InKTtcblxuZGVzY3JpYmUoJ3F0ZXN0cyBEdWFsIE1vZHVsZSBTeXN0ZW0gVGVzdCBHZW5lcmF0aW9uJywgKCkgPT4ge1xuICBsZXQgdGVtcERpcjtcbiAgbGV0IGdlbmVyYXRvcjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBDcmVhdGUgVU5JUVVFIHRlbXBvcmFyeSBkaXJlY3RvcnkgZm9yIHBhcmFsbGVsIHNhZmV0eVxuICAgIGNvbnN0IHVuaXF1ZUlkID0gYCR7cHJvY2Vzcy5ocnRpbWUuYmlnaW50KCl9LSR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWA7XG4gICAgdGVtcERpciA9IHBhdGguam9pbihfX2Rpcm5hbWUsIGB0ZW1wX21vZHVsZV90ZXN0c18ke3VuaXF1ZUlkfWApO1xuICAgIGlmICghZnMuZXhpc3RzU3luYyh0ZW1wRGlyKSkge1xuICAgICAgZnMubWtkaXJTeW5jKHRlbXBEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgIH1cbiAgICBcbiAgICBnZW5lcmF0b3IgPSBuZXcgVGVzdEdlbmVyYXRvcih7XG4gICAgICBTUkNfRElSOiB0ZW1wRGlyLFxuICAgICAgVEVTVF9ESVI6IHBhdGguam9pbih0ZW1wRGlyLCAndGVzdHMnKVxuICAgIH0pO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIC8vIENsZWFudXAgdGVtcG9yYXJ5IGZpbGVzXG4gICAgaWYgKGZzLmV4aXN0c1N5bmModGVtcERpcikpIHtcbiAgICAgIGZzLnJtU3luYyh0ZW1wRGlyLCB7IHJlY3Vyc2l2ZTogdHJ1ZSwgZm9yY2U6IHRydWUgfSk7XG4gICAgfVxuICB9KTtcblxuICBkZXNjcmliZSgnQ29tbW9uSlMgRXhwb3J0IERldGVjdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBtb2R1bGUuZXhwb3J0cyBzaW5nbGUgZnVuY3Rpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb21tb25KU0NvZGUgPSBgXG5mdW5jdGlvbiBjYWxjdWxhdGVTdW0oYSwgYikge1xuICByZXR1cm4gYSArIGI7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY2FsY3VsYXRlU3VtO1xuYDtcbiAgICAgIGNvbnN0IGV4cG9ydHMgPSBnZW5lcmF0b3IuZXh0cmFjdEV4cG9ydHMoY29tbW9uSlNDb2RlKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ2NhbGN1bGF0ZVN1bScpO1xuICAgICAgZXhwZWN0KGV4cG9ydHMubGVuZ3RoKS50b0JlKDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgbW9kdWxlLmV4cG9ydHMgb2JqZWN0IHdpdGggbXVsdGlwbGUgZXhwb3J0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1vbkpTQ29kZSA9IGBcbmZ1bmN0aW9uIGFkZChhLCBiKSB7IHJldHVybiBhICsgYjsgfVxuZnVuY3Rpb24gc3VidHJhY3QoYSwgYikgeyByZXR1cm4gYSAtIGI7IH1cblxuY2xhc3MgQ2FsY3VsYXRvciB7XG4gIGNvbnN0cnVjdG9yKCkge31cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGFkZCxcbiAgc3VidHJhY3QsXG4gIENhbGN1bGF0b3Jcbn07XG5gO1xuICAgICAgY29uc3QgZXhwb3J0cyA9IGdlbmVyYXRvci5leHRyYWN0RXhwb3J0cyhjb21tb25KU0NvZGUpO1xuICAgICAgZXhwZWN0KGV4cG9ydHMpLnRvQ29udGFpbignYWRkJyk7XG4gICAgICBleHBlY3QoZXhwb3J0cykudG9Db250YWluKCdzdWJ0cmFjdCcpO1xuICAgICAgZXhwZWN0KGV4cG9ydHMpLnRvQ29udGFpbignQ2FsY3VsYXRvcicpO1xuICAgICAgZXhwZWN0KGV4cG9ydHMubGVuZ3RoKS50b0JlKDMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgZXhwb3J0cy5wcm9wZXJ0eSBhc3NpZ25tZW50cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1vbkpTQ29kZSA9IGBcbmZ1bmN0aW9uIGhlbHBlcjEoKSB7fVxuZnVuY3Rpb24gaGVscGVyMigpIHt9XG5cbmV4cG9ydHMuaGVscGVyMSA9IGhlbHBlcjE7XG5leHBvcnRzLmhlbHBlcjIgPSBoZWxwZXIyO1xuYDtcbiAgICAgIGNvbnN0IGV4cG9ydHMgPSBnZW5lcmF0b3IuZXh0cmFjdEV4cG9ydHMoY29tbW9uSlNDb2RlKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ2hlbHBlcjEnKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ2hlbHBlcjInKTtcbiAgICAgIGV4cGVjdChleHBvcnRzLmxlbmd0aCkudG9CZSgyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IG1vZHVsZS5leHBvcnRzLnByb3BlcnR5IGFzc2lnbm1lbnRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29tbW9uSlNDb2RlID0gYFxuZnVuY3Rpb24gdXRpbGl0eUEoKSB7fVxuZnVuY3Rpb24gdXRpbGl0eUIoKSB7fVxuXG5tb2R1bGUuZXhwb3J0cy51dGlsaXR5QSA9IHV0aWxpdHlBO1xubW9kdWxlLmV4cG9ydHMudXRpbGl0eUIgPSB1dGlsaXR5QjtcbmA7XG4gICAgICBjb25zdCBleHBvcnRzID0gZ2VuZXJhdG9yLmV4dHJhY3RFeHBvcnRzKGNvbW1vbkpTQ29kZSk7XG4gICAgICBleHBlY3QoZXhwb3J0cykudG9Db250YWluKCd1dGlsaXR5QScpO1xuICAgICAgZXhwZWN0KGV4cG9ydHMpLnRvQ29udGFpbigndXRpbGl0eUInKTtcbiAgICAgIGV4cGVjdChleHBvcnRzLmxlbmd0aCkudG9CZSgyKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0VTIE1vZHVsZSBFeHBvcnQgRGV0ZWN0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZGV0ZWN0IGV4cG9ydCBjb25zdCBkZWNsYXJhdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBlc01vZHVsZUNvZGUgPSBgXG5leHBvcnQgY29uc3QgQVBJX1VSTCA9ICdodHRwczovL2FwaS5leGFtcGxlLmNvbSc7XG5leHBvcnQgY29uc3QgTUFYX1JFVFJJRVMgPSAzO1xuYDtcbiAgICAgIGNvbnN0IGV4cG9ydHMgPSBnZW5lcmF0b3IuZXh0cmFjdEV4cG9ydHMoZXNNb2R1bGVDb2RlKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ0FQSV9VUkwnKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ01BWF9SRVRSSUVTJyk7XG4gICAgICBleHBlY3QoZXhwb3J0cy5sZW5ndGgpLnRvQmUoMik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVjdCBleHBvcnQgZnVuY3Rpb24gZGVjbGFyYXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXNNb2R1bGVDb2RlID0gYFxuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NEYXRhKGRhdGEpIHtcbiAgcmV0dXJuIGRhdGEubWFwKGl0ZW0gPT4gaXRlbS52YWx1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUlucHV0KGlucHV0KSB7XG4gIHJldHVybiB0eXBlb2YgaW5wdXQgPT09ICdzdHJpbmcnO1xufVxuYDtcbiAgICAgIGNvbnN0IGV4cG9ydHMgPSBnZW5lcmF0b3IuZXh0cmFjdEV4cG9ydHMoZXNNb2R1bGVDb2RlKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ3Byb2Nlc3NEYXRhJyk7XG4gICAgICBleHBlY3QoZXhwb3J0cykudG9Db250YWluKCd2YWxpZGF0ZUlucHV0Jyk7XG4gICAgICBleHBlY3QoZXhwb3J0cy5sZW5ndGgpLnRvQmUoMik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVjdCBleHBvcnQgY2xhc3MgZGVjbGFyYXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXNNb2R1bGVDb2RlID0gYFxuZXhwb3J0IGNsYXNzIERhdGFQcm9jZXNzb3Ige1xuICBjb25zdHJ1Y3RvcigpIHt9XG59XG5cbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uRW5naW5lIHtcbiAgdmFsaWRhdGUoKSB7fVxufVxuYDtcbiAgICAgIGNvbnN0IGV4cG9ydHMgPSBnZW5lcmF0b3IuZXh0cmFjdEV4cG9ydHMoZXNNb2R1bGVDb2RlKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ0RhdGFQcm9jZXNzb3InKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ1ZhbGlkYXRpb25FbmdpbmUnKTtcbiAgICAgIGV4cGVjdChleHBvcnRzLmxlbmd0aCkudG9CZSgyKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ01peGVkIE1vZHVsZSBQYXR0ZXJuIERldGVjdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlcyB3aXRoIGJvdGggRVMgYW5kIENvbW1vbkpTIHBhdHRlcm5zJywgKCkgPT4ge1xuICAgICAgY29uc3QgbWl4ZWRDb2RlID0gYFxuLy8gRVMgbW9kdWxlIHN0eWxlXG5leHBvcnQgZnVuY3Rpb24gZXNGdW5jdGlvbigpIHtcbiAgcmV0dXJuICdlcyc7XG59XG5cbi8vIENvbW1vbkpTIHN0eWxlXG5mdW5jdGlvbiBjanNGdW5jdGlvbigpIHtcbiAgcmV0dXJuICdjanMnO1xufVxuXG5tb2R1bGUuZXhwb3J0cy5janNGdW5jdGlvbiA9IGNqc0Z1bmN0aW9uO1xuYDtcbiAgICAgIGNvbnN0IGV4cG9ydHMgPSBnZW5lcmF0b3IuZXh0cmFjdEV4cG9ydHMobWl4ZWRDb2RlKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ2VzRnVuY3Rpb24nKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0NvbnRhaW4oJ2Nqc0Z1bmN0aW9uJyk7XG4gICAgICBleHBlY3QoZXhwb3J0cy5sZW5ndGgpLnRvQmUoMik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdJbXBvcnQgRGV0ZWN0aW9uIChDb21tb25KUyB2cyBFUyBNb2R1bGVzKScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBDb21tb25KUyByZXF1aXJlIHN0YXRlbWVudHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb21tb25KU0NvZGUgPSBgXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpO1xuYDtcbiAgICAgIGNvbnN0IGltcG9ydHMgPSBnZW5lcmF0b3IuZ2V0VXNlZE1vZHVsZXMoY29tbW9uSlNDb2RlKTtcbiAgICAgIGV4cGVjdChpbXBvcnRzKS50b0NvbnRhaW4oJ2ZzJyk7XG4gICAgICBleHBlY3QoaW1wb3J0cykudG9Db250YWluKCdwYXRoJyk7XG4gICAgICBleHBlY3QoaW1wb3J0cykudG9Db250YWluKCdheGlvcycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgRVMgbW9kdWxlIGltcG9ydCBzdGF0ZW1lbnRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXNNb2R1bGVDb2RlID0gYFxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCB7IHJlc29sdmUgfSBmcm9tICdwYXRoJztcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5gO1xuICAgICAgY29uc3QgaW1wb3J0cyA9IGdlbmVyYXRvci5nZXRVc2VkTW9kdWxlcyhlc01vZHVsZUNvZGUpO1xuICAgICAgZXhwZWN0KGltcG9ydHMpLnRvQ29udGFpbignZnMnKTtcbiAgICAgIGV4cGVjdChpbXBvcnRzKS50b0NvbnRhaW4oJ3BhdGgnKTtcbiAgICAgIGV4cGVjdChpbXBvcnRzKS50b0NvbnRhaW4oJ2F4aW9zJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbHRlciBvdXQgcmVsYXRpdmUgaW1wb3J0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvZGVXaXRoUmVsYXRpdmUgPSBgXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCBsb2NhbCA9IHJlcXVpcmUoJy4vbG9jYWxGaWxlJyk7XG5jb25zdCBwYXJlbnQgPSByZXF1aXJlKCcuLi9wYXJlbnRGaWxlJyk7XG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuaW1wb3J0IHsgdXRpbCB9IGZyb20gJy4vdXRpbHMnO1xuYDtcbiAgICAgIGNvbnN0IGltcG9ydHMgPSBnZW5lcmF0b3IuZ2V0VXNlZE1vZHVsZXMoY29kZVdpdGhSZWxhdGl2ZSk7XG4gICAgICBleHBlY3QoaW1wb3J0cykudG9Db250YWluKCdmcycpO1xuICAgICAgZXhwZWN0KGltcG9ydHMpLnRvQ29udGFpbignYXhpb3MnKTtcbiAgICAgIGV4cGVjdChpbXBvcnRzKS5ub3QudG9Db250YWluKCcuL2xvY2FsRmlsZScpO1xuICAgICAgZXhwZWN0KGltcG9ydHMpLm5vdC50b0NvbnRhaW4oJy4uL3BhcmVudEZpbGUnKTtcbiAgICAgIGV4cGVjdChpbXBvcnRzKS5ub3QudG9Db250YWluKCcuL3V0aWxzJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdUZXN0IEdlbmVyYXRpb24gZm9yIERpZmZlcmVudCBNb2R1bGUgU3lzdGVtcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIENvbW1vbkpTLXN0eWxlIHRlc3RzIGZvciBDb21tb25KUyBwcm9qZWN0cycsICgpID0+IHtcbiAgICAgIC8vIE1vY2sgQ29tbW9uSlMgcHJvamVjdCAobm8gXCJ0eXBlXCI6IFwibW9kdWxlXCIgaW4gcGFja2FnZS5qc29uKVxuICAgICAgZ2VuZXJhdG9yLmlzRVNNb2R1bGUgPSBmYWxzZTtcbiAgICAgIFxuICAgICAgY29uc3QgY29tbW9uSlNGaWxlID0gcGF0aC5qb2luKHRlbXBEaXIsICdtYXRoVXRpbHMuanMnKTtcbiAgICAgIGNvbnN0IGNvbW1vbkpTQ29kZSA9IGBcbmZ1bmN0aW9uIGFkZChhLCBiKSB7XG4gIHJldHVybiBhICsgYjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGFkZCB9O1xuYDtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoY29tbW9uSlNGaWxlLCBjb21tb25KU0NvZGUpO1xuICAgICAgXG4gICAgICBjb25zdCBleHBvcnRzID0gZ2VuZXJhdG9yLmV4dHJhY3RFeHBvcnRzKGNvbW1vbkpTQ29kZSk7XG4gICAgICBjb25zdCB0ZXN0Q29udGVudCA9IGdlbmVyYXRvci5jcmVhdGVVbml0VGVzdChjb21tb25KU0ZpbGUsIGV4cG9ydHMsIGZhbHNlLCBbXSk7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCB1c2UgcmVxdWlyZSBzeW50YXhcbiAgICAgIGV4cGVjdCh0ZXN0Q29udGVudCkudG9Db250YWluKCdjb25zdCBtb2QgPSByZXF1aXJlKCcpO1xuICAgICAgZXhwZWN0KHRlc3RDb250ZW50KS5ub3QudG9Db250YWluKCdpbXBvcnQnKTtcbiAgICAgIGV4cGVjdCh0ZXN0Q29udGVudCkudG9Db250YWluKFwiZGVzY3JpYmUoJ21hdGhVdGlscy5qcydcIik7XG4gICAgICBleHBlY3QodGVzdENvbnRlbnQpLnRvQ29udGFpbihcInRlc3QoJ2FkZCB3b3JrcydcIik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIEVTIG1vZHVsZS1zdHlsZSB0ZXN0cyBmb3IgRVMgbW9kdWxlIHByb2plY3RzJywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBFUyBtb2R1bGUgcHJvamVjdFxuICAgICAgZ2VuZXJhdG9yLmlzRVNNb2R1bGUgPSB0cnVlO1xuICAgICAgXG4gICAgICBjb25zdCBlc01vZHVsZUZpbGUgPSBwYXRoLmpvaW4odGVtcERpciwgJ2RhdGFQcm9jZXNzb3IuanMnKTtcbiAgICAgIGNvbnN0IGVzTW9kdWxlQ29kZSA9IGBcbmV4cG9ydCBmdW5jdGlvbiBwcm9jZXNzKGRhdGEpIHtcbiAgcmV0dXJuIGRhdGEuZmlsdGVyKEJvb2xlYW4pO1xufVxuYDtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoZXNNb2R1bGVGaWxlLCBlc01vZHVsZUNvZGUpO1xuICAgICAgXG4gICAgICBjb25zdCBleHBvcnRzID0gZ2VuZXJhdG9yLmV4dHJhY3RFeHBvcnRzKGVzTW9kdWxlQ29kZSk7XG4gICAgICBjb25zdCB0ZXN0Q29udGVudCA9IGdlbmVyYXRvci5jcmVhdGVVbml0VGVzdChlc01vZHVsZUZpbGUsIGV4cG9ydHMsIGZhbHNlLCBbXSk7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCB1c2UgaW1wb3J0IHN5bnRheFxuICAgICAgZXhwZWN0KHRlc3RDb250ZW50KS50b0NvbnRhaW4oJ2ltcG9ydCAqIGFzIG1vZCBmcm9tJyk7XG4gICAgICBleHBlY3QodGVzdENvbnRlbnQpLm5vdC50b0NvbnRhaW4oJ3JlcXVpcmUoJyk7XG4gICAgICBleHBlY3QodGVzdENvbnRlbnQpLnRvQ29udGFpbihcImRlc2NyaWJlKCdkYXRhUHJvY2Vzc29yLmpzJ1wiKTtcbiAgICAgIGV4cGVjdCh0ZXN0Q29udGVudCkudG9Db250YWluKFwidGVzdCgncHJvY2VzcyB3b3JrcydcIik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZWFsIEZpbGUgQW5hbHlzaXMgYW5kIFRlc3QgR2VuZXJhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFuYWx5emUgYW5kIGdlbmVyYXRlIHRlc3RzIGZvciBDb21tb25KUyBmaWxlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbW1vbkpTRmlsZSA9IHBhdGguam9pbih0ZW1wRGlyLCAncmVhbENvbW1vbkpTLmpzJyk7XG4gICAgICBjb25zdCBjb21tb25KU0NvZGUgPSBgXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbmZ1bmN0aW9uIHJlYWRDb25maWcoZmlsZW5hbWUpIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKGZpbGVuYW1lLCAndXRmOCcpKTtcbn1cblxuY2xhc3MgQ29uZmlnTWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY29uZmlnID0ge307XG4gIH1cbiAgXG4gIGxvYWQoZmlsZSkge1xuICAgIHRoaXMuY29uZmlnID0gcmVhZENvbmZpZyhmaWxlKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgcmVhZENvbmZpZyxcbiAgQ29uZmlnTWFuYWdlclxufTtcbmA7XG4gICAgICBmcy53cml0ZUZpbGVTeW5jKGNvbW1vbkpTRmlsZSwgY29tbW9uSlNDb2RlKTtcbiAgICAgIFxuICAgICAgLy8gQW5hbHl6ZSB0aGUgZmlsZVxuICAgICAgZ2VuZXJhdG9yLmFuYWx5emUoY29tbW9uSlNGaWxlKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgdGVzdCB3YXMgZ2VuZXJhdGVkXG4gICAgICBjb25zdCBleHBlY3RlZFRlc3RQYXRoID0gZ2VuZXJhdG9yLmdldFJlbGF0aXZlVGVzdFBhdGgoY29tbW9uSlNGaWxlLCAndW5pdCcpO1xuICAgICAgZXhwZWN0KGdlbmVyYXRvci5zY2FubmVkLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgZXhwZWN0KGdlbmVyYXRvci5zY2FubmVkWzBdLnR5cGUpLnRvQmUoJ3VuaXQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYW5hbHl6ZSBhbmQgZ2VuZXJhdGUgdGVzdHMgZm9yIEVTIG1vZHVsZSBmaWxlcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGVzTW9kdWxlRmlsZSA9IHBhdGguam9pbih0ZW1wRGlyLCAncmVhbEVTTW9kdWxlLmpzJyk7XG4gICAgICBjb25zdCBlc01vZHVsZUNvZGUgPSBgXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVFbWFpbChlbWFpbCkge1xuICByZXR1cm4gZW1haWwuaW5jbHVkZXMoJ0AnKTtcbn1cblxuZXhwb3J0IGNsYXNzIEVtYWlsVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoKSB7fVxuICBcbiAgaXNWYWxpZChlbWFpbCkge1xuICAgIHJldHVybiB2YWxpZGF0ZUVtYWlsKGVtYWlsKTtcbiAgfVxufVxuYDtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoZXNNb2R1bGVGaWxlLCBlc01vZHVsZUNvZGUpO1xuICAgICAgXG4gICAgICAvLyBBbmFseXplIHRoZSBmaWxlXG4gICAgICBnZW5lcmF0b3IuYW5hbHl6ZShlc01vZHVsZUZpbGUpO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBpZiB0ZXN0IHdhcyBnZW5lcmF0ZWRcbiAgICAgIGV4cGVjdChnZW5lcmF0b3Iuc2Nhbm5lZC5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChnZW5lcmF0b3Iuc2Nhbm5lZFswXS50eXBlKS50b0JlKCd1bml0Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFZGdlIENhc2VzIGFuZCBFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBmaWxlcyB3aXRoIG5vIGV4cG9ydHMgZ3JhY2VmdWxseScsICgpID0+IHtcbiAgICAgIGNvbnN0IG5vRXhwb3J0c0NvZGUgPSBgXG4vLyBKdXN0IHNvbWUgdXRpbGl0eSBmdW5jdGlvbnMgdGhhdCBhcmVuJ3QgZXhwb3J0ZWRcbmZ1bmN0aW9uIGludGVybmFsKCkge31cbmNvbnN0IFBSSVZBVEVfQ09OU1QgPSAncHJpdmF0ZSc7XG5gO1xuICAgICAgY29uc3QgZXhwb3J0cyA9IGdlbmVyYXRvci5leHRyYWN0RXhwb3J0cyhub0V4cG9ydHNDb2RlKTtcbiAgICAgIGV4cGVjdChleHBvcnRzKS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1hbGZvcm1lZCBleHBvcnQgcGF0dGVybnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtYWxmb3JtZWRDb2RlID0gYFxubW9kdWxlLmV4cG9ydHMgPSBcbmZ1bmN0aW9uIGluY29tcGxldGUoKSB7fVxuZXhwb3J0cy4gPSAnaW52YWxpZCc7XG5leHBvcnQgXG5gO1xuICAgICAgY29uc3QgZXhwb3J0cyA9IGdlbmVyYXRvci5leHRyYWN0RXhwb3J0cyhtYWxmb3JtZWRDb2RlKTtcbiAgICAgIC8vIFNob3VsZCBub3QgY3Jhc2ggYW5kIHJldHVybiB2YWxpZCBleHBvcnRzIG9ubHlcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGV4cG9ydHMpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZmlsZXMgd2l0aCBjb21tZW50cyBjb250YWluaW5nIGV4cG9ydC1saWtlIHBhdHRlcm5zJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29tbWVudENvZGUgPSBgXG4vLyBUaGlzIGlzIG5vdCBhbiBleHBvcnQ6IG1vZHVsZS5leHBvcnRzID0gZmFrZVxuLyogXG4gKiBleHBvcnQgZnVuY3Rpb24gY29tbWVudGVkT3V0KCkge31cbiAqL1xuZnVuY3Rpb24gcmVhbEZ1bmN0aW9uKCkge31cbm1vZHVsZS5leHBvcnRzID0gcmVhbEZ1bmN0aW9uO1xuYDtcbiAgICAgIGNvbnN0IGV4cG9ydHMgPSBnZW5lcmF0b3IuZXh0cmFjdEV4cG9ydHMoY29tbWVudENvZGUpO1xuICAgICAgZXhwZWN0KGV4cG9ydHMpLnRvQ29udGFpbigncmVhbEZ1bmN0aW9uJyk7XG4gICAgICBleHBlY3QoZXhwb3J0cykubm90LnRvQ29udGFpbignZmFrZScpO1xuICAgICAgZXhwZWN0KGV4cG9ydHMpLm5vdC50b0NvbnRhaW4oJ2NvbW1lbnRlZE91dCcpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsTUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDO0FBQ3hCLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUM1QixNQUFNO0VBQUVFO0FBQWMsQ0FBQyxHQUFHRixPQUFPLENBQUMsc0JBQXNCLENBQUM7QUFFekRHLFFBQVEsQ0FB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