f1bcfa622e8781f508029cafdd0cc7bb
// qtests dogfooding demonstration - using qtests to test qtests utilities
// This shows qtests can replace Jest for most testing scenarios

const {
  runTestSuite,
  createAssertions
} = require('../utils/runTestSuite');
const {
  mockConsole
} = require('../utils/mockConsole');
const {
  setTestEnv,
  saveEnv,
  restoreEnv
} = require('../utils/testEnv');
const stubMethod = require('../utils/stubMethod');

// Convert to Jest format for proper test discovery
describe('qtests Dogfooding Tests', () => {
  const assert = createAssertions();

  // Test qtests mockConsole utility
  const mockConsoleTests = [['mockConsole captures calls', () => {
    const spy = mockConsole('log');
    console.log('captured message');
    assert.truthy(spy.mock.calls.length > 0, 'Should capture console calls');
    assert.truthy(spy.mock.calls.some(call => call.some(arg => String(arg).includes('captured message'))), 'Should capture message content');
    spy.mockRestore();
  }], ['mockConsole restores console', () => {
    const originalLog = console.log;
    const spy = mockConsole('log');
    spy.mockRestore();
    assert.equal(console.log, originalLog, 'Should restore original console.log');
  }]];

  // Test qtests testEnv utility  
  const testEnvTests = [['testEnv saves and restores environment', () => {
    process.env.TEST_VAR = 'original';
    const saved = saveEnv();
    process.env.TEST_VAR = 'modified';
    assert.equal(process.env.TEST_VAR, 'modified', 'Should set test environment');
    restoreEnv(saved);
    assert.equal(process.env.TEST_VAR, 'original', 'Should restore original environment');
  }], ['testEnv sets standard environment', () => {
    const saved = saveEnv();
    setTestEnv();
    assert.truthy(process.env.GOOGLE_API_KEY, 'Should set GOOGLE_API_KEY');
    assert.truthy(process.env.OPENAI_TOKEN, 'Should set OPENAI_TOKEN');
    restoreEnv(saved);
  }]];

  // Test qtests stubMethod utility
  const stubMethodTests = [['stubMethod creates working stubs', () => {
    const obj = {
      add: (a, b) => a + b
    };
    const restore = stubMethod(obj, 'add', () => 100);
    assert.equal(obj.add(2, 3), 100, 'Stubbed method should return stub value');
    restore();
    assert.equal(obj.add(2, 3), 5, 'Restored method should work normally');
  }], ['stubMethod error handling', () => {
    assert.throws(() => stubMethod(null, 'method', () => {}), 'Should throw for null object');
    assert.throws(() => stubMethod({}, 'missing', () => {}), 'Should throw for missing method');
  }]];
  it('should run mockConsole tests', () => {
    const results = runTestSuite('mockConsole Tests', mockConsoleTests);
    expect(results.failed).toBe(0);
  });
  it('should run testEnv tests', () => {
    const results = runTestSuite('testEnv Tests', testEnvTests);
    expect(results.failed).toBe(0);
  });
  it('should run stubMethod tests', () => {
    const results = runTestSuite('stubMethod Tests', stubMethodTests);
    expect(results.failed).toBe(0);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJydW5UZXN0U3VpdGUiLCJjcmVhdGVBc3NlcnRpb25zIiwicmVxdWlyZSIsIm1vY2tDb25zb2xlIiwic2V0VGVzdEVudiIsInNhdmVFbnYiLCJyZXN0b3JlRW52Iiwic3R1Yk1ldGhvZCIsImRlc2NyaWJlIiwiYXNzZXJ0IiwibW9ja0NvbnNvbGVUZXN0cyIsInNweSIsImNvbnNvbGUiLCJsb2ciLCJ0cnV0aHkiLCJtb2NrIiwiY2FsbHMiLCJsZW5ndGgiLCJzb21lIiwiY2FsbCIsImFyZyIsIlN0cmluZyIsImluY2x1ZGVzIiwibW9ja1Jlc3RvcmUiLCJvcmlnaW5hbExvZyIsImVxdWFsIiwidGVzdEVudlRlc3RzIiwicHJvY2VzcyIsImVudiIsIlRFU1RfVkFSIiwic2F2ZWQiLCJHT09HTEVfQVBJX0tFWSIsIk9QRU5BSV9UT0tFTiIsInN0dWJNZXRob2RUZXN0cyIsIm9iaiIsImFkZCIsImEiLCJiIiwicmVzdG9yZSIsInRocm93cyIsIml0IiwicmVzdWx0cyIsImV4cGVjdCIsImZhaWxlZCIsInRvQmUiXSwic291cmNlcyI6WyJxdGVzdHMtZG9nZm9vZC50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHF0ZXN0cyBkb2dmb29kaW5nIGRlbW9uc3RyYXRpb24gLSB1c2luZyBxdGVzdHMgdG8gdGVzdCBxdGVzdHMgdXRpbGl0aWVzXG4vLyBUaGlzIHNob3dzIHF0ZXN0cyBjYW4gcmVwbGFjZSBKZXN0IGZvciBtb3N0IHRlc3Rpbmcgc2NlbmFyaW9zXG5cbmNvbnN0IHsgcnVuVGVzdFN1aXRlLCBjcmVhdGVBc3NlcnRpb25zIH0gPSByZXF1aXJlKCcuLi91dGlscy9ydW5UZXN0U3VpdGUnKTtcbmNvbnN0IHsgbW9ja0NvbnNvbGUgfSA9IHJlcXVpcmUoJy4uL3V0aWxzL21vY2tDb25zb2xlJyk7XG5jb25zdCB7IHNldFRlc3RFbnYsIHNhdmVFbnYsIHJlc3RvcmVFbnYgfSA9IHJlcXVpcmUoJy4uL3V0aWxzL3Rlc3RFbnYnKTtcbmNvbnN0IHN0dWJNZXRob2QgPSByZXF1aXJlKCcuLi91dGlscy9zdHViTWV0aG9kJyk7XG5cbi8vIENvbnZlcnQgdG8gSmVzdCBmb3JtYXQgZm9yIHByb3BlciB0ZXN0IGRpc2NvdmVyeVxuZGVzY3JpYmUoJ3F0ZXN0cyBEb2dmb29kaW5nIFRlc3RzJywgKCkgPT4ge1xuXG5jb25zdCBhc3NlcnQgPSBjcmVhdGVBc3NlcnRpb25zKCk7XG5cbi8vIFRlc3QgcXRlc3RzIG1vY2tDb25zb2xlIHV0aWxpdHlcbmNvbnN0IG1vY2tDb25zb2xlVGVzdHMgPSBbXG4gIFsnbW9ja0NvbnNvbGUgY2FwdHVyZXMgY2FsbHMnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3B5ID0gbW9ja0NvbnNvbGUoJ2xvZycpO1xuICAgIGNvbnNvbGUubG9nKCdjYXB0dXJlZCBtZXNzYWdlJyk7XG4gICAgYXNzZXJ0LnRydXRoeShzcHkubW9jay5jYWxscy5sZW5ndGggPiAwLCAnU2hvdWxkIGNhcHR1cmUgY29uc29sZSBjYWxscycpO1xuICAgIGFzc2VydC50cnV0aHkoc3B5Lm1vY2suY2FsbHMuc29tZShjYWxsID0+IFxuICAgICAgY2FsbC5zb21lKGFyZyA9PiBTdHJpbmcoYXJnKS5pbmNsdWRlcygnY2FwdHVyZWQgbWVzc2FnZScpKVxuICAgICksICdTaG91bGQgY2FwdHVyZSBtZXNzYWdlIGNvbnRlbnQnKTtcbiAgICBzcHkubW9ja1Jlc3RvcmUoKTtcbiAgfV0sXG5cbiAgWydtb2NrQ29uc29sZSByZXN0b3JlcyBjb25zb2xlJywgKCkgPT4ge1xuICAgIGNvbnN0IG9yaWdpbmFsTG9nID0gY29uc29sZS5sb2c7XG4gICAgY29uc3Qgc3B5ID0gbW9ja0NvbnNvbGUoJ2xvZycpO1xuICAgIHNweS5tb2NrUmVzdG9yZSgpO1xuICAgIGFzc2VydC5lcXVhbChjb25zb2xlLmxvZywgb3JpZ2luYWxMb2csICdTaG91bGQgcmVzdG9yZSBvcmlnaW5hbCBjb25zb2xlLmxvZycpO1xuICB9XVxuXTtcblxuLy8gVGVzdCBxdGVzdHMgdGVzdEVudiB1dGlsaXR5ICBcbmNvbnN0IHRlc3RFbnZUZXN0cyA9IFtcbiAgWyd0ZXN0RW52IHNhdmVzIGFuZCByZXN0b3JlcyBlbnZpcm9ubWVudCcsICgpID0+IHtcbiAgICBwcm9jZXNzLmVudi5URVNUX1ZBUiA9ICdvcmlnaW5hbCc7XG4gICAgY29uc3Qgc2F2ZWQgPSBzYXZlRW52KCk7XG4gICAgcHJvY2Vzcy5lbnYuVEVTVF9WQVIgPSAnbW9kaWZpZWQnO1xuICAgIGFzc2VydC5lcXVhbChwcm9jZXNzLmVudi5URVNUX1ZBUiwgJ21vZGlmaWVkJywgJ1Nob3VsZCBzZXQgdGVzdCBlbnZpcm9ubWVudCcpO1xuICAgIHJlc3RvcmVFbnYoc2F2ZWQpO1xuICAgIGFzc2VydC5lcXVhbChwcm9jZXNzLmVudi5URVNUX1ZBUiwgJ29yaWdpbmFsJywgJ1Nob3VsZCByZXN0b3JlIG9yaWdpbmFsIGVudmlyb25tZW50Jyk7XG4gIH1dLFxuXG4gIFsndGVzdEVudiBzZXRzIHN0YW5kYXJkIGVudmlyb25tZW50JywgKCkgPT4ge1xuICAgIGNvbnN0IHNhdmVkID0gc2F2ZUVudigpO1xuICAgIHNldFRlc3RFbnYoKTtcbiAgICBhc3NlcnQudHJ1dGh5KHByb2Nlc3MuZW52LkdPT0dMRV9BUElfS0VZLCAnU2hvdWxkIHNldCBHT09HTEVfQVBJX0tFWScpO1xuICAgIGFzc2VydC50cnV0aHkocHJvY2Vzcy5lbnYuT1BFTkFJX1RPS0VOLCAnU2hvdWxkIHNldCBPUEVOQUlfVE9LRU4nKTtcbiAgICByZXN0b3JlRW52KHNhdmVkKTtcbiAgfV1cbl07XG5cbi8vIFRlc3QgcXRlc3RzIHN0dWJNZXRob2QgdXRpbGl0eVxuY29uc3Qgc3R1Yk1ldGhvZFRlc3RzID0gW1xuICBbJ3N0dWJNZXRob2QgY3JlYXRlcyB3b3JraW5nIHN0dWJzJywgKCkgPT4ge1xuICAgIGNvbnN0IG9iaiA9IHsgYWRkOiAoYSwgYikgPT4gYSArIGIgfTtcbiAgICBjb25zdCByZXN0b3JlID0gc3R1Yk1ldGhvZChvYmosICdhZGQnLCAoKSA9PiAxMDApO1xuICAgIGFzc2VydC5lcXVhbChvYmouYWRkKDIsIDMpLCAxMDAsICdTdHViYmVkIG1ldGhvZCBzaG91bGQgcmV0dXJuIHN0dWIgdmFsdWUnKTtcbiAgICByZXN0b3JlKCk7XG4gICAgYXNzZXJ0LmVxdWFsKG9iai5hZGQoMiwgMyksIDUsICdSZXN0b3JlZCBtZXRob2Qgc2hvdWxkIHdvcmsgbm9ybWFsbHknKTtcbiAgfV0sXG5cbiAgWydzdHViTWV0aG9kIGVycm9yIGhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGFzc2VydC50aHJvd3MoKCkgPT4gc3R1Yk1ldGhvZChudWxsLCAnbWV0aG9kJywgKCkgPT4ge30pLCAnU2hvdWxkIHRocm93IGZvciBudWxsIG9iamVjdCcpO1xuICAgIGFzc2VydC50aHJvd3MoKCkgPT4gc3R1Yk1ldGhvZCh7fSwgJ21pc3NpbmcnLCAoKSA9PiB7fSksICdTaG91bGQgdGhyb3cgZm9yIG1pc3NpbmcgbWV0aG9kJyk7XG4gIH1dXG5dO1xuXG4gIGl0KCdzaG91bGQgcnVuIG1vY2tDb25zb2xlIHRlc3RzJywgKCkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdHMgPSBydW5UZXN0U3VpdGUoJ21vY2tDb25zb2xlIFRlc3RzJywgbW9ja0NvbnNvbGVUZXN0cyk7XG4gICAgZXhwZWN0KHJlc3VsdHMuZmFpbGVkKS50b0JlKDApO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHJ1biB0ZXN0RW52IHRlc3RzJywgKCkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdHMgPSBydW5UZXN0U3VpdGUoJ3Rlc3RFbnYgVGVzdHMnLCB0ZXN0RW52VGVzdHMpO1xuICAgIGV4cGVjdChyZXN1bHRzLmZhaWxlZCkudG9CZSgwKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBydW4gc3R1Yk1ldGhvZCB0ZXN0cycsICgpID0+IHtcbiAgICBjb25zdCByZXN1bHRzID0gcnVuVGVzdFN1aXRlKCdzdHViTWV0aG9kIFRlc3RzJywgc3R1Yk1ldGhvZFRlc3RzKTtcbiAgICBleHBlY3QocmVzdWx0cy5mYWlsZWQpLnRvQmUoMCk7XG4g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