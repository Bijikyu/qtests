49e031ccb03bb5dda59744f9e374a085
"use strict";
/**
 * Script to find all JavaScript files in the project
 *
 * Searches for .js files and provides detailed information about them.
 * Excludes node_modules and other common ignore directories.
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = __importDefault(require("fs"));
const path_1 = __importDefault(require("path"));
class JSFileFinder {
    constructor() {
        this.excludeDirs = [
            'node_modules',
            '.git',
            'dist',
            'build',
            'coverage',
            '.next',
            '.nuxt'
        ];
        this.results = [];
    }
    /**
     * Walk directory recursively to find JS files
     */
    walkDirectory(dir) {
        try {
            const entries = fs_1.default.readdirSync(dir, { withFileTypes: true });
            for (const entry of entries) {
                const fullPath = path_1.default.join(dir, entry.name);
                if (entry.isDirectory()) {
                    // Skip excluded directories
                    if (!this.excludeDirs.includes(entry.name)) {
                        this.walkDirectory(fullPath);
                    }
                }
                else if (entry.isFile() && entry.name.endsWith('.js')) {
                    this.analyzeJSFile(fullPath);
                }
            }
        }
        catch (error) {
            console.error(`Error reading directory ${dir}:`, error);
        }
    }
    /**
     * Analyze a JavaScript file for module patterns
     */
    analyzeJSFile(filePath) {
        try {
            const content = fs_1.default.readFileSync(filePath, 'utf8');
            const stats = fs_1.default.statSync(filePath);
            const fileInfo = {
                path: filePath,
                size: stats.size,
                hasRequire: /require\s*\(/.test(content),
                hasModuleExports: /module\.exports/.test(content),
                hasImport: /^import\s+/m.test(content),
                hasExport: /^export\s+/m.test(content),
                isCommonJS: false
            };
            // Determine if it's CommonJS based on patterns
            fileInfo.isCommonJS = fileInfo.hasRequire || fileInfo.hasModuleExports;
            this.results.push(fileInfo);
        }
        catch (error) {
            console.error(`Error analyzing file ${filePath}:`, error);
        }
    }
    /**
     * Generate summary report
     */
    generateReport() {
        const totalFiles = this.results.length;
        const commonJSFiles = this.results.filter(f => f.isCommonJS);
        const esModuleFiles = this.results.filter(f => f.hasImport || f.hasExport);
        const mixedFiles = this.results.filter(f => f.isCommonJS && (f.hasImport || f.hasExport));
        const totalSize = this.results.reduce((sum, f) => sum + f.size, 0);
        console.log('\nüìä JavaScript Files Summary');
        console.log('='.repeat(40));
        console.log(`Total JS files found: ${totalFiles}`);
        console.log(`Total size: ${(totalSize / 1024).toFixed(2)} KB`);
        console.log(`CommonJS files: ${commonJSFiles.length}`);
        console.log(`ES Module files: ${esModuleFiles.length}`);
        console.log(`Mixed module files: ${mixedFiles.length}`);
        if (commonJSFiles.length > 0) {
            console.log('\nüîç CommonJS Files (using require/module.exports):');
            commonJSFiles.forEach(file => {
                const relativePath = path_1.default.relative(process.cwd(), file.path);
                console.log(`  üìÑ ${relativePath} (${(file.size / 1024).toFixed(1)} KB)`);
            });
        }
        if (esModuleFiles.length > 0) {
            console.log('\n‚ú® ES Module Files (using import/export):');
            esModuleFiles.filter(f => !f.isCommonJS).forEach(file => {
                const relativePath = path_1.default.relative(process.cwd(), file.path);
                console.log(`  üìÑ ${relativePath} (${(file.size / 1024).toFixed(1)} KB)`);
            });
        }
        if (mixedFiles.length > 0) {
            console.log('\n‚ö†Ô∏è  Mixed Module Files (need conversion):');
            mixedFiles.forEach(file => {
                const relativePath = path_1.default.relative(process.cwd(), file.path);
                console.log(`  üìÑ ${relativePath} (${(file.size / 1024).toFixed(1)} KB)`);
            });
        }
        console.log('\nüìã Detailed File List:');
        console.log('-'.repeat(40));
        this.results.forEach(file => {
            const relativePath = path_1.default.relative(process.cwd(), file.path);
            const moduleType = file.isCommonJS ? 'CommonJS' :
                (file.hasImport || file.hasExport) ? 'ES Module' : 'Unknown';
            console.log(`${relativePath} | ${moduleType} | ${(file.size / 1024).toFixed(1)} KB`);
        });
    }
    /**
     * Run the file finder
     */
    run() {
        console.log('üîç Searching for JavaScript files...');
        const startDir = process.argv[2] || '.';
        this.walkDirectory(startDir);
        if (this.results.length === 0) {
            console.log('No JavaScript files found.');
            return;
        }
        this.generateReport();
    }
}
// Run the script
const finder = new JSFileFinder();
finder.run();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQztRQUVwRCxNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsQ0FBQztRQUN4QyxJQUFJLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRTdCLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDOUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1lBQzFDLE9BQU87UUFDVCxDQUFDO1FBRUQsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0lBQ3hCLENBQUM7Q0FDRjtBQUVELGlCQUFpQjtBQUNqQixNQUFNLE1BQU0sR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO0FBQ2xDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL2ZpbmQtanMtZmlsZXMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXG4vKipcbiAqIFNjcmlwdCB0byBmaW5kIGFsbCBKYXZhU2NyaXB0IGZpbGVzIGluIHRoZSBwcm9qZWN0XG4gKiBcbiAqIFNlYXJjaGVzIGZvciAuanMgZmlsZXMgYW5kIHByb3ZpZGVzIGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IHRoZW0uXG4gKiBFeGNsdWRlcyBub2RlX21vZHVsZXMgYW5kIG90aGVyIGNvbW1vbiBpZ25vcmUgZGlyZWN0b3JpZXMuXG4gKi9cblxuaW1wb3J0IGZzIGZyb20gJ2ZzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5pbnRlcmZhY2UgRmlsZUluZm8ge1xuICBwYXRoOiBzdHJpbmc7XG4gIHNpemU6IG51bWJlcjtcbiAgaXNDb21tb25KUzogYm9vbGVhbjtcbiAgaGFzUmVxdWlyZTogYm9vbGVhbjtcbiAgaGFzTW9kdWxlRXhwb3J0czogYm9vbGVhbjtcbiAgaGFzSW1wb3J0OiBib29sZWFuO1xuICBoYXNFeHBvcnQ6IGJvb2xlYW47XG59XG5cbmNsYXNzIEpTRmlsZUZpbmRlciB7XG4gIHByaXZhdGUgZXhjbHVkZURpcnMgPSBbXG4gICAgJ25vZGVfbW9kdWxlcycsXG4gICAgJy5naXQnLFxuICAgICdkaXN0JyxcbiAgICAnYnVpbGQnLFxuICAgICdjb3ZlcmFnZScsXG4gICAgJy5uZXh0JyxcbiAgICAnLm51eHQnXG4gIF07XG5cbiAgcHJpdmF0ZSByZXN1bHRzOiBGaWxlSW5mb1tdID0gW107XG5cbiAgLyoqXG4gICAqIFdhbGsgZGlyZWN0b3J5IHJlY3Vyc2l2ZWx5IHRvIGZpbmQgSlMgZmlsZXNcbiAgICovXG4gIHdhbGtEaXJlY3RvcnkoZGlyOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZW50cmllcyA9IGZzLnJlYWRkaXJTeW5jKGRpciwgeyB3aXRoRmlsZVR5cGVzOiB0cnVlIH0pO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLmpvaW4oZGlyLCBlbnRyeS5uYW1lKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChlbnRyeS5pc0RpcmVjdG9yeSgpKSB7XG4gICAgICAgICAgLy8gU2tpcCBleGNsdWRlZCBkaXJlY3Rvcmllc1xuICAgICAgICAgIGlmICghdGhpcy5leGNsdWRlRGlycy5pbmNsdWRlcyhlbnRyeS5uYW1lKSkge1xuICAgICAgICAgICAgdGhpcy53YWxrRGlyZWN0b3J5KGZ1bGxQYXRoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZW50cnkuaXNGaWxlKCkgJiYgZW50cnkubmFtZS5lbmRzV2l0aCgnLmpzJykpIHtcbiAgICAgICAgICB0aGlzLmFuYWx5emVKU0ZpbGUoZnVsbFBhdGgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHJlYWRpbmcgZGlyZWN0b3J5ICR7ZGlyfTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFuYWx5emUgYSBKYXZhU2NyaXB0IGZpbGUgZm9yIG1vZHVsZSBwYXR0ZXJuc1xuICAgKi9cbiAgYW5hbHl6ZUpTRmlsZShmaWxlUGF0aDogc3RyaW5nKTogdm9pZCB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZVBhdGgsICd1dGY4Jyk7XG4gICAgICBjb25zdCBzdGF0cyA9IGZzLnN0YXRTeW5jKGZpbGVQYXRoKTtcbiAgICAgIFxuICAgICAgY29uc3QgZmlsZUluZm86IEZpbGVJbmZvID0ge1xuICAgICAgICBwYXRoOiBmaWxlUGF0aCxcbiAgICAgICAgc2l6ZTogc3RhdHMuc2l6ZSxcbiAgICAgICAgaGFzUmVxdWlyZTogL3JlcXVpcmVcXHMqXFwoLy50ZXN0KGNvbnRlbnQpLFxuICAgICAgICBoYXNNb2R1bGVFeHBvcnRzOiAvbW9kdWxlXFwuZXhwb3J0cy8udGVzdChjb250ZW50KSxcbiAgICAgICAgaGFzSW1wb3J0OiAvXmltcG9ydFxccysvbS50ZXN0KGNvbnRlbnQpLFxuICAgICAgICBoYXNFeHBvcnQ6IC9eZXhwb3J0XFxzKy9tLnRlc3QoY29udGVudCksXG4gICAgICAgIGlzQ29tbW9uSlM6IGZhbHNlXG4gICAgICB9O1xuXG4gICAgICAvLyBEZXRlcm1pbmUgaWYgaXQncyBDb21tb25KUyBiYXNlZCBvbiBwYXR0ZXJuc1xuICAgICAgZmlsZUluZm8uaXNDb21tb25KUyA9IGZpbGVJbmZvLmhhc1JlcXVpcmUgfHwgZmlsZUluZm8uaGFzTW9kdWxlRXhwb3J0cztcblxuICAgICAgdGhpcy5yZXN1bHRzLnB1c2goZmlsZUluZm8pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBhbmFseXppbmcgZmlsZSAke2ZpbGVQYXRofTpgLCBlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIHN1bW1hcnkgcmVwb3J0XG4gICAqL1xuICBnZW5lcmF0ZVJlcG9ydCgpOiB2b2lkIHtcbiAgICBjb25zdCB0b3RhbEZpbGVzID0gdGhpcy5yZXN1bHRzLmxlbmd0aDtcbiAgICBjb25zdCBjb21tb25KU0ZpbGVzID0gdGhpcy5yZXN1bHRzLmZpbHRlcihmID0+IGYuaXNDb21tb25KUyk7XG4gICAgY29uc3QgZXNNb2R1bGVGaWxlcyA9IHRoaXMucmVzdWx0cy5maWx0ZXIoZiA9PiBmLmhhc0ltcG9ydCB8fCBmLmhhc0V4cG9ydCk7XG4gICAgY29uc3QgbWl4ZWRGaWxlcyA9IHRoaXMucmVzdWx0cy5maWx0ZXIoZiA9PiBmLmlzQ29tbW9uSlMgJiYgKGYuaGFzSW1wb3J0IHx8IGYuaGFzRXhwb3J0KSk7XG4gICAgY29uc3QgdG90YWxTaXplID0gdGhpcy5yZXN1bHRzLnJlZHVjZSgoc3VtLCBmKSA9PiBzdW0gKyBmLnNpemUsIDApO1xuXG4gICAgY29uc29sZS5sb2coJ1xcbvCfk4ogSmF2YVNjcmlwdCBGaWxlcyBTdW1tYXJ5Jyk7XG4gICAgY29uc29sZS5sb2coJz0nIC5yZXBlYXQoNDApKTtcbiAgICBjb25zb2xlLmxvZyhgVG90YWwgSlMgZmlsZXMgZm91bmQ6ICR7dG90YWxGaWxlc31gKTtcbiAgICBjb25zb2xlLmxvZyhgVG90YWwgc2l6ZTogJHsodG90YWxTaXplIC8gMTAyNCkudG9GaXhlZCgyKX0gS0JgKTtcbiAgICBjb25zb2xlLmxvZyhgQ29tbW9uSlMgZmlsZXM6ICR7Y29tbW9uSlNGaWxlcy5sZW5ndGh9YCk7XG4gICAgY29uc29sZS5sb2coYEVTIE1vZHVsZSBmaWxlczogJHtlc01vZHVsZUZpbGVzLmxlbmd0aH1gKTtcbiAgICBjb25zb2xlLmxvZyhgTWl4ZWQgbW9kdWxlIGZpbGVzOiAke21peGVkRmlsZXMubGVuZ3RofWApO1xuXG4gICAgaWYgKGNvbW1vbkpTRmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5sb2coJ1xcbvCflI0gQ29tbW9uSlMgRmlsZXMgKHVzaW5nIHJlcXVpcmUvbW9kdWxlLmV4cG9ydHMpOicpO1xuICAgICAgY29tbW9uSlNGaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xuICAgICAgICBjb25zdCByZWxhdGl2ZVBhdGggPSBwYXRoLnJlbGF0aXZlKHByb2Nlc3MuY3dkKCksIGZpbGUucGF0aCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGAgIPCfk4QgJHtyZWxhdGl2ZVBhdGh9ICgkeyhmaWxlLnNpemUgLyAxMDI0KS50b0ZpeGVkKDEpfSBLQilgKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChlc01vZHVsZUZpbGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdcXG7inKggRVMgTW9kdWxlIEZpbGVzICh1c2luZyBpbXBvcnQvZXhwb3J0KTonKTtcbiAgICAgIGVzTW9kdWxlRmlsZXMuZmlsdGVyKGYgPT4gIWYuaXNDb21tb25KUykuZm9yRWFjaChmaWxlID0+IHtcbiAgICAgICAgY29uc3QgcmVsYXRpdmVQYXRoID0gcGF0aC5yZWxhdGl2ZShwcm9jZXNzLmN3ZCgpLCBmaWxlLnBhdGgpO1xuICAgICAgICBjb25zb2xlLmxvZyhgICDwn5OEICR7cmVsYXRpdmVQYXRofSAoJHsoZmlsZS5zaXplIC8gMTAyNCkudG9GaXhlZCgxKX0gS0IpYCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAobWl4ZWRGaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnXFxu4pqg77iPICBNaXhlZCBNb2R1bGUgRmlsZXMgKG5lZWQgY29udmVyc2lvbik6Jyk7XG4gICAgICBtaXhlZEZpbGVzLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICAgIGNvbnN0IHJlbGF0aXZlUGF0aCA9IHBhdGgucmVsYXRpdmUocHJvY2Vzcy5jd2QoKSwgZmlsZS5wYXRoKTtcbiAgICAgICAgY29uc29sZS5sb2coYCAg8J+ThCAke3JlbGF0aXZlUGF0aH0gKCR7KGZpbGUuc2l6ZSAvIDEwMjQpLnRvRml4ZWQoMSl9IEtCKWApO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ1xcbvCfk4sgRGV0YWlsZWQgRmlsZSBMaXN0OicpO1xuICAgIGNvbnNvbGUubG9nKCctJy5yZXBlYXQoNDApKTtcbiAgICB0aGlzLnJlc3VsdHMuZm9yRWFjaChmaWxlID0+IHtcbiAgICAgIGNvbnN0IHJlbGF0aXZlUGF0aCA9IHBhdGgucmVsYXRpdmUocHJvY2Vzcy5jd2QoKSwgZmlsZS5wYXRoKTtcbiAgICAgIGNvbnN0IG1vZHVsZVR5cGUgPSBmaWxlLmlzQ29tbW9uSlMgPyAnQ29tbW9uSlMnIDogXG4gICAgICAgICAgICAgICAgICAgICAgICAoZmlsZS5oYXNJbXBvcnQgfHwgZmlsZS5oYXNFeHBvcnQpID8gJ0VTIE1vZHVsZScgOiAnVW5rbm93bic7XG4gICAgICBjb25zb2xlLmxvZyhgJHtyZWxhdGl2ZVBhdGh9IHwgJHttb2R1bGVUeXBlfSB8ICR7KGZpbGUuc2l6ZSAvIDEwMjQpLnRvRml4ZWQoMSl9IEtCYCk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUnVuIHRoZSBmaWxlIGZpbmRlclxuICAgKi9cbiAgcnVuKCk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKCfwn5SNIFNlYXJjaGluZyBmb3IgSmF2YVNjcmlwdCBmaWxlcy4uLicpO1xuICAgIFxuICAgIGNvbnN0IHN0YXJ0RGlyID0gcHJvY2Vzcy5hcmd2WzJdIHx8ICcuJztcbiAgICB0aGlzLndhbGtEaXJlY3Rvcnkoc3RhcnREaXIpO1xuICAgIFxuICAgIGlmICh0aGlzLnJlc3VsdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gSmF2YVNjcmlwdCBmaWxlcyBmb3VuZC4nKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmdlbmVyYXRlUmVwb3J0KCk7XG4gIH1cbn1cblxuLy8gUnVuIHRoZSBzY3JpcHRcbmNvbnN0IGZpbmRlciA9IG5ldyBKU0ZpbGVGaW5kZXIoKTtcbmZpbmRlci5ydW4oKTsiXSwidmVyc2lvbiI6M30=