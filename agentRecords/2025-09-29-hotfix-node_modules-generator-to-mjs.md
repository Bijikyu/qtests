# Record: Hotfix generator (node_modules) to produce .mjs

- Date: 2025-09-29
- Author: AI agent

## Summary
- Patched local installed `node_modules/qtests` (v1.1.4) CLI to stop generating `qtests-runner.js` and update scripts to `qtests-runner.mjs`.
- Ensures running `qtests-generate` from PATH behaves correctly in this workspace until a new package version is installed.

## Changes
- `node_modules/qtests/lib/testGenerator.js`:
  - `generateTestRunner()`: now writes `qtests-runner.mjs` using modern templates (`templates/qtests-runner.mjs.template`) and removes legacy `.js` file.
  - `updatePackageJsonTestScript()`: sets `scripts.test` to `node qtests-runner.mjs` and updates console message accordingly.
- `node_modules/qtests/bin/qtests-generate`:
  - Updated CLI messages to reflect `.mjs` runner generation.

## Rationale
- The workspace PATH resolved to an older installed package (`node_modules/qtests@1.1.4`) whose generator created `.js` runners. This conflicted with the new Runner Policies.
- The repo itself already implements modern behavior (`bin/qtests-generate.mjs`, `lib/testGenerator.ts`). This hotfix aligns the local executable until the package is updated in `node_modules`.

## Validation
- Ran `qtests-generate` with no flags. Output now shows:
  - `✅ Updated package.json test script to use qtests-runner.mjs`
  - `✅ Generated qtests-runner.mjs`

## Follow-up
- Publish a new `qtests` version and reinstall in clients to avoid local hotfixing `node_modules`.
