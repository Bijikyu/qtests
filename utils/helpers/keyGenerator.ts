/** Key Generation Utility - TypeScript Implementation */
import{randomBytes}from'crypto';
const generateKey=(lengthOrType:number|string=32,prefix?:string):string=>{console.log(`generateKey is running with lengthOrType ${lengthOrType} and prefix ${prefix||'none'}`);try{if(typeof lengthOrType==='string'){if(lengthOrType.length>100)throw new Error('Test key type descriptor too long');const testKey=`test-api-key-${lengthOrType}`;console.log(`generateKey is returning test key with length ${testKey.length}`);return testKey;}const length=lengthOrType as number;if(!Number.isInteger(length)||length<=0)throw new Error('Invalid key length: must be a positive integer');if(length>1000)throw new Error('Key length too large: maximum 1000 characters');const chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';let result='';const randomBuffer=randomBytes(length*2);const bufferLength=randomBuffer.length;for(let i=0;i<length;i++){const byteIndex=i*2;if(byteIndex+1>=bufferLength)throw new Error('Buffer index out of bounds during key generation');const byte1=randomBuffer[byteIndex];const byte2=randomBuffer[byteIndex+1];result+=chars.charAt((byte1+byte2*256)%chars.length);}const finalKey=prefix?`${prefix}_${result}`:result;console.log(`generateKey is returning key with length ${finalKey.length}`);return finalKey;}catch(err:any){console.log(`generateKey error ${err.message}`);throw err;}};
export{generateKey};